import{a as Ki,b as fl,d as _l}from"./chunk-664KCE5Z.js";import{a as cl,b as pl}from"./chunk-YM7KQBEK.js";import{a as dl}from"./chunk-CS6YXD3A.js";import{a as Wr}from"./chunk-TBQBLT67.js";import{a as ei}from"./chunk-FLUSJCAZ.js";import{e as ul}from"./chunk-HUPVRRB6.js";import{a as hl}from"./chunk-JMTGRK3T.js";import{a as Qi}from"./chunk-LXWDITUE.js";import"./chunk-7J5Y77OX.js";import{b as Je,d as et,e as Xr,f as ml}from"./chunk-WVE4Y3TR.js";import{$b as Ut,$d as an,$e as Xt,A as Ga,Ac as Uo,Ae as ln,B as Ro,Ba as le,Bb as Ze,Be as qr,Ca as s,Da as q,Db as Ee,Df as Jo,E as V,Ea as L,Ed as Ne,Ee as sn,Ef as Nt,F as Ua,Fa as Ht,Fb as de,Fd as Qe,Fe as Xo,Ff as Xi,G as za,Ga as Vo,Gb as be,Gd as Fe,Ge as cn,Hd as Be,He as pn,Hf as mi,I as Mt,Ia as F,Ib as rt,Id as ht,Ie as ge,J as k,Ja as Li,Jb as Ka,Jd as $e,K as A,Ka as Z,Kb as te,Kd as He,Ke as jt,Kf as el,L as Wa,La as _i,Lb as De,Ld as en,Le as Ce,M as Io,Nb as Ho,O as at,Oa as S,Ob as Gt,Od as Ui,Pa as T,Pb as Se,Pe as B,Pf as Le,Q as Rt,Qa as it,Qe as pi,Ra as gi,Re as Wi,Rf as tl,Sb as Pe,Se as vt,Sf as il,Tb as Vi,Td as Lt,Te as ji,Tf as al,Ub as Ni,Ud as li,Ue as qi,V as ja,Va as It,Vb as Fi,Ve as qt,Vf as un,Wd as si,We as mn,Wf as nl,X as p,Xb as Yo,Xd as zi,Xe as Zo,Y as w,Z as qa,Za as No,Zd as ci,Ze as Dt,Zf as hn,_a as Xa,_d as tn,_f as rl,a as tt,aa as g,ac as Ja,ae as nn,af as Qo,b as bt,ba as Lo,bb as Fo,bc as wt,bf as Zt,bg as ol,c as Ur,ca as C,cb as ee,cg as Zi,da as St,dc as zt,df as Qt,dg as ll,e as $,ea as me,eb as Oi,ec as Bi,eg as fn,fg as sl,ga as x,gc as ut,ge as Ye,h as Ao,ha as ne,he as ft,hf as Ko,ia as re,ib as Bo,ic as $i,ie as _t,ig as Jt,j as Ii,ja as oe,jb as $o,jc as Hi,ka as l,kc as Go,ke as ot,la as o,le as Ge,lg as X,ma as b,mb as nt,na as G,nd as zo,ne as Ue,oa as U,ob as zr,oc as Yi,oe as gt,of as Ke,og as yt,p as $a,pa as va,pb as Za,q as Ha,qa as N,qb as Te,qe as Tt,qf as Vt,ra as E,rb as oi,re as ze,rg as Y,sa as h,sb as Re,sf as lt,sg as Ct,tb as Ie,tc as Gi,te as We,tf as Kt,tg as Zr,ub as Qa,uc as Wt,ue as Ot,ug as Qr,v as Ya,va as Oo,vf as dn,wa as _e,we as jo,xa as he,xc as jr,xe as qo,y as Mo,ya as fe,ye as rn,zc as ya,zd as Wo,ze as on}from"./chunk-SAZ6MTOG.js";var _n=class t{constructor(i){this.dialogRef=i}confirmDiscard(){this.dialogRef.close(!0)}static{this.\u0275fac=function(e){return new(e||t)(w(Ne))}}static{this.\u0275cmp=V({type:t,selectors:[["app-display-file-page-dirty-dialog"]],standalone:!0,features:[F],decls:8,vars:0,consts:[["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){e&1&&(l(0,"mat-dialog-content")(1,"p"),s(2,"You have unsaved changes on the current page. Do you want to discard them?"),o()(),l(3,"mat-dialog-actions",0)(4,"ya-button",1),s(5,"CANCEL"),o(),l(6,"ya-button",2),E("click",function(){return a.confirmDiscard()}),s(7,"DISCARD"),o()())},dependencies:[Y,Be,He,$e,ge],encapsulation:2})}};var gl=t=>Ro(Ca).canDeactivate(t),Ca=class t{constructor(i,e,a){this.dialog=i;this.authService=e;this.dialogOpen$=new $(!1);this.bucket=a.getDisplayBucket()}canDeactivate(i){return this.dialogOpen$.value?new Ur(e=>{this.dialogRef.afterClosed().subscribe({next:a=>{e.next(a===!0),e.complete()},error:()=>{e.next(!1),e.complete()}})}):i.hasPendingChanges()&&this.mayManageDisplays()?new Ur(e=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(_n,{width:"400px"}),this.dialogRef.afterClosed().subscribe({next:a=>{this.dialogOpen$.next(!1),e.next(a===!0),e.complete()},error:()=>{this.dialogOpen$.next(!1),e.next(!1),e.complete()}})}):Ao(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}static{this.\u0275fac=function(e){return new(e||t)(Ga(Fe),Ga(Ct),Ga(Ce))}}static{this.\u0275prov=Mo({token:t,factory:t.\u0275fac})}};function Ql(t,i){if(t&1&&b(0,"img",6),t&2){let e=h();C("src",e.url,ja)}}var gn=class t{constructor(i,e){this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.url=this.storageClient.getObjectURL(this.bucket,i),Promise.resolve()}hasPendingChanges(){return!1}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["app-image-viewer"]],standalone:!0,features:[F],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src"]],template:function(e,a){e&1&&(Wa(),l(0,"svg",0)(1,"pattern",1),b(2,"rect",2)(3,"rect",3),o(),b(4,"rect",4),o(),Io(),l(5,"div",5),g(6,Ql,1,1,"img",6),o()),e&2&&(p(6),x(a.url?6:-1))},dependencies:[Y],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0})}};function Kl(t,i){if(t&1){let e=N();l(0,"ya-page-button",1),s(1,"View"),o(),l(2,"mat-menu",2,0)(4,"button",3),E("click",function(){k(e);let n=h();return A(n.resetZoom())}),l(5,"mat-icon"),s(6,"aspect_ratio"),o(),s(7," Actual size "),o(),l(8,"button",3),E("click",function(){k(e);let n=h();return A(n.fitZoom())}),l(9,"mat-icon"),s(10,"fit_screen"),o(),s(11," Zoom to fit "),o(),l(12,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomIn())}),l(13,"mat-icon"),s(14,"add_circle_outline"),o(),s(15," Zoom in "),o(),l(16,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomOut())}),l(17,"mat-icon"),s(18,"remove_circle_outline"),o(),s(19," Zoom out "),o()()}if(t&2){let e=le(3);C("matMenuTriggerFor",e)}}var vn=class t{constructor(){this.initialized$=new $(!1)}init(i){this.viewer=i,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-opi-display-viewer-controls"]],standalone:!0,features:[F],decls:2,vars:3,consts:[["viewMenu","matMenu"],["dropdown","true",3,"matMenuTriggerFor"],["overlapTrigger","false","xPosition","after","yPosition","below",1,"ya-menu"],["mat-menu-item","",3,"click"]],template:function(e,a){e&1&&(g(0,Kl,20,1),S(1,"async")),e&2&&x(T(1,1,a.initialized$)?0:-1)},dependencies:[Y,ee,wt,$i,ut,Hi,lt],encapsulation:2})}};var yn=class{constructor(i){this.messageService=i}writeInfo(i){this.messageService.showInfo(i)}writeError(i){this.messageService.showError(i)}writeWarning(i){this.messageService.showInfo(i)}};var Cn=class{constructor(i){this.prefix=i}resolve(i){let e;if(i.name==="Liberation Sans"?(e="LiberationSans-Regular.woff2",i.bold&&i.italic?e="LiberationSans-BoldItalic.woff2":i.bold?e="LiberationSans-Bold.woff2":i.italic&&(e="LiberationSans-Italic.woff2")):i.name==="Liberation Mono"?(e="LiberationMono-Regular.woff2",i.bold&&i.italic?e="LiberationMono-BoldItalic.woff2":i.bold?e="LiberationMono-Bold.woff2":i.italic&&(e="LiberationMono-Italic.woff2")):i.name==="Liberation Serif"&&(e="LiberationSerif-Regular.woff2",i.bold&&i.italic?e="LiberationSerif-BoldItalic.woff2":i.bold?e="LiberationSerif-Bold.woff2":i.italic&&(e="LiberationSerif-Italic.woff2")),e)return new FontFace(i.name,`url(${this.prefix}media/${e})`,{weight:i.bold?"bold":"normal",style:i.italic?"italic":"normal"})}};var xn=class{constructor(i){this.watermarkObserver=i;this.dirty=!1;this.valueRange=[null,null];this.archiveSamples=[];this.bufferSize=500;this.bufferWatermark=400;this.pointer=0;this.alreadyWarned=!1;this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(i){this.archiveSamples=i,this.dirty=!0}setValueRange(i){this.valueRange=i}addRealtimeValue(i){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=i,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){let i=this.realtimeBuffer.filter(n=>n!==void 0),e=null;i.length>0&&(e=i[0][0].getTime());let a=this.archiveSamples.filter(n=>e===null||n[0].getTime()<e).concat(i).sort((n,r)=>n[0].getTime()-r[0].getTime());return{valueRange:this.valueRange,samples:a}}};var Ji=class{constructor(i,e,a){this.yamcs=i;this.configService=a;this.extendRequestedRange=!0;this.resolution=6e3;this.loading$=new $(!1);this.data$=new $({valueRange:[null,null],samples:[]});this.parameters$=new $([]);this.latestRealtimeValues=new Map;this.syncSubscription=e.sync(()=>{if(this.plotBuffer.dirty&&!this.loading$.getValue()){let n=this.plotBuffer.snapshot();this.data$.next({samples:n.samples,valueRange:n.valueRange}),this.plotBuffer.dirty=!1}}),this.plotBuffer=new xn(()=>{this.reloadVisibleRange()})}addParameter(...i){if(this.parameters$.next([...this.parameters$.value,...i]),this.realtimeSubscription){let e=i.map(a=>({name:a.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(i){let e=this.parameters$.value.filter(a=>a.qualifiedName!==i);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(i,e){this.visibleStart=i,this.visibleStop=e}updateWindow(i,e,a){this.loading$.next(!0);let n=this.extendRequestedRange?e.getTime()-i.getTime():0,r=new Date(i.getTime()-n),c=new Date(e.getTime()+n),d=[];for(let u of this.parameters$.value)d.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,u.qualifiedName,{start:r.toISOString(),stop:c.toISOString(),count:this.resolution,fields:["time","n","avg","min","max"],gapTime:3e5,source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"}));let m=Promise.all(d);return this.lastLoadPromise=m,m.then(u=>{if(this.lastLoadPromise===m){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=i,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;let v=[];for(let y=0;y<u.length;y++)v[y]=this.processSamples(u[y]);let f=this.mergeSeries(...v);this.plotBuffer.setArchiveData(f),this.plotBuffer.setValueRange(a),this.lastLoadPromise=null}})}connectRealtime(){let i=this.parameters$.value.map(e=>({name:e.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=tt(tt({},this.idMapping),e.mapping)),e.values&&e.values.length&&this.processRealtimeDelivery(e.values)})}addToRealtimeSubscription(i){this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})}processRealtimeDelivery(i){for(let r of i){let c=null,d=B.convertValueToNumber(r.engValue);d!==null&&(r.acquisitionStatus==="EXPIRED"?c=null:r.acquisitionStatus==="ACQUIRED"&&(c=[d,d,d]));let m=this.idMapping[r.numericId];this.latestRealtimeValues.set(m.name,c)}let e=new Date;e.setTime(Date.parse(i[0].generationTime));let a=this.parameters$.value.map(r=>this.latestRealtimeValues.get(r.qualifiedName)||null),n=[e,...a];this.plotBuffer.addRealtimeValue(n)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription?.cancel(),this.syncSubscription?.unsubscribe()}processSamples(i){let e=[];for(let a of i){let n=new Date;if(n.setTime(Date.parse(a.time)),a.n>0){let r=a.avg,c=a.min,d=a.max;this.minValue===void 0?(this.minValue=c,this.maxValue=d):(this.minValue>c&&(this.minValue=c),this.maxValue<d&&(this.maxValue=d)),e.push([n,[c,r,d]])}else e.push([n,null])}return e}mergeSeries(...i){if(i.length===1)return i[0];let e=i[0];for(let a=1;a<i.length;a++){let n=[],r=0,c=0,d=[],m=null,u=e,v=i[a];for(;r<u.length||c<v.length;){let f=r<u.length?u[r]:null,y=c<v.length?v[c]:null;f&&y?f[0].getTime()===y[0].getTime()?(d=f.slice(1),m=y[1],n.push([f[0],...d,m]),r++,c++):f[0].getTime()<y[0].getTime()?(d=f.slice(1),n.push([f[0],...d,m]),r++):(m=y[1],n.push([y[0],...d,m]),c++):f?(d=f.slice(1),n.push([f[0],...d,m]),r++):y&&(m=y[1],n.push([y[0],...d,m]),c++)}e=n}return e}};var bn=class{constructor(i,e,a,n,r){this.yamcs=a;this.processedSamples=[];this.subscriptions=[];this.dataSource=new Ji(a,n,r),this.dataSource.extendRequestedRange=!1,this.dataSource.resolution=400,this.dataSource.addParameter({qualifiedName:i}),this.yamcs.range$.subscribe(d=>{let m=this.yamcs.getMissionTime(),u=B.subtractDuration(m,d);this.dataSource.updateWindow(u,m,[null,null])}),this.dataSource.data$.subscribe(d=>{this.processSamples(d),e.requestRepaint()});let c=n.sync(()=>{let d=this.yamcs.getMissionTime(),m=B.subtractDuration(d,this.yamcs.range$.value),u=m.getTime();for(let v=0;v<this.processedSamples.length;v++)if(this.processedSamples[v].x>=u&&v>0){this.processedSamples.splice(0,v);break}this.dataSource.updateWindowOnly(m,d),this.addEdgeSamples(this.processedSamples),e.requestRepaint()});this.subscriptions.push(c),this.backfillSubscription=a.yamcsClient.createBackfillingSubscription({instance:a.instance},d=>{d.finished&&this.dataSource.reloadVisibleRange()})}processSamples(i){let e=[];for(let a of i.samples){let n=a[0].getTime();if(a[1]){let r=a[1][1];e.push({x:n,y:r})}else e.push({x:n,y:null})}this.addEdgeSamples(e),this.processedSamples=e}addEdgeSamples(i){let{visibleStart:e,visibleStop:a}=this.dataSource;if(e&&a){let n={x:e.getTime(),y:null},r={x:a.getTime(),y:null};i.length?(i[0].x>n.x&&i.splice(0,0,n),i[i.length-1].x<r.x&&i.push(r)):(i.push(n),i.push(r))}}getSamples(){return this.processedSamples}disconnect(){this.backfillSubscription?.cancel(),this.subscriptions.forEach(i=>i.unsubscribe()),this.dataSource?.disconnect()}};var Sn=class extends fl{constructor(e,a){super(a);this.storageClient=e}resolve(e,a){if(e.startsWith("ys://")){let n=e.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(n)return this.storageClient.getObjectURL(n[1],n[2])}return super.resolve(e,a)}};var wn=class{constructor(i,e){this.yamcs=i;this.messageService=e}issueCommand(i,e){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,i,{args:e}).catch(a=>this.messageService.showError(a))}runProcedure(i,e){let a={};e&&Object.keys(e).forEach(n=>a[n]=String(e[n])),this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,i,{arguments:a}).catch(n=>this.messageService.showError(n))}};var Jl=["frameInner"],es=["displayContainer"],Tn="MDB:OPS Name",Dn="ops://",ts="args.",Pn=class t{constructor(i,e,a,n,r,c,d,m){this.yamcs=i;this.router=e;this.route=a;this.synchronizer=n;this.messageService=r;this.baseHref=c;this.configService=d;this.formatter=m;this.idMapping={};this.idInfo={};this.pvsByName=new Map;this.subscriptionDirty=!1;this.storageClient=i.createStorageClient(),this.bucket=d.getDisplayBucket()}setViewerContainerEl(i){this.viewerContainerEl=i}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();let i=[];for(let e of this.pvsByName.keys())e.startsWith(Dn)?i.push({namespace:Tn,name:e.substr(6)}):i.push({name:e});i.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=e.mapping),e.info&&(this.idInfo=e.info);for(let a of e.invalid||[]){let n=a.name;a.namespace===Tn&&(n=Dn+n);let r=this.display.getPV(n);r&&(r.disconnected=!0)}if(e.values?.length){let a=new Map;for(let n of e.values){n.id=this.idMapping[n.numericId];let r=n.id.name;n.id.namespace===Tn&&(r=Dn+r);let c=this.idInfo[n.numericId];a.set(r,this.toSample(n,c))}this.display.setValues(a)}}))}}toSample(i,e){let a=B.toDate(i.generationTime),n=this.toAlarmSeverity(i),r={time:a,severity:n,value:void 0};return i.engValue&&(r.value=B.convertValue(i.engValue),i.engValue.type==="ENUMERATED"&&(r.valueIndex=Number(i.engValue.sint64Value))),e.units&&(r.units=e.units),r}toAlarmSeverity(i){if(i.acquisitionStatus==="EXPIRED"||i.acquisitionStatus=="NOT_RECEIVED"||i.acquisitionStatus==="INVALID")return Ki.INVALID;if(!i.monitoringResult)return Ki.NONE;switch(i.monitoringResult){case"DISABLED":case"IN_LIMITS":return Ki.NONE;case"WATCH":case"WARNING":case"DISTRESS":return Ki.MINOR;case"CRITICAL":case"SEVERE":return Ki.MAJOR}}init(i){let e=this.displayContainer.nativeElement;this.display=new _l(e),this.display.utc=this.formatter.isUTC(),this.display.imagesPrefix=this.baseHref+"media/",this.display.setPathResolver(new Sn(this.storageClient,this.display)),this.display.setConsoleHandler(new yn(this.messageService)),this.display.setFontResolver(new Cn(this.baseHref));let a="";i.lastIndexOf("/")!==-1&&(a=i.substring(0,i.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new wn(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",m=>{let u,v=`?c=${this.yamcs.context}&range=${this.yamcs.getTimeRange()}`;if(m.path.startsWith("/")?u=`/telemetry/displays/files${m.path}${v}`:u=`/telemetry/displays/files/${a}${m.path}${v}`,m.args)for(let f in m.args)u+="&"+ts+encodeURIComponent(f)+"="+encodeURIComponent(m.args[f]);this.router.navigateByUrl(u)}),this.display.addEventListener("closedisplay",m=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",m=>{m.pvName.startsWith("/")?this.router.navigateByUrl(`/telemetry/parameters${m.pvName}/-/summary?c=${this.yamcs.context}`):m.pvName.startsWith(Dn)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:Tn,name:m.pvName.substring(6)}).then(u=>{this.router.navigateByUrl(`/telemetry/parameters${u.qualifiedName}/-/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${m.pvName}`)}),this.display.addEventListener("runcommand",m=>{this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,m.command,{args:m.args}).catch(u=>this.messageService.showError(u))}),this.display.addEventListener("runprocedure",m=>{this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,m.procedure,{arguments:m.args}).catch(u=>this.messageService.showError(u))}),this.display.addProvider(this),this.display.absPrefix=this.storageClient.getObjectURL(this.bucket,"");let n=this.storageClient.getObjectURL(this.bucket,i),r={},c=this.route.snapshot.queryParams;for(let m in c)m.startsWith("args.")&&(r[m.substring(5)]=c[m]);let d=this.display.setSource(n,r);return d.then(()=>{let m;!this.display.transparent&&this.display.instance?m=this.display.instance.backgroundColor.hex():m="unset",this.frameInner.nativeElement.style.backgroundColor=m,this.syncSubscription=this.synchronizer.sync(()=>this.updateSubscription())}),d}canProvide(i){return!0}startProviding(i){for(let e of i)this.pvsByName.set(e.name,e);this.subscriptionDirty=!0}stopProviding(i){for(let e of i)this.pvsByName.delete(e.name);this.subscriptionDirty=!0}createHistoricalDataProvider(i,e){let{yamcs:a,synchronizer:n}=this;if(this.configService.getConfig().tmArchive)return new bn(i,e,a,n,this.configService)}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){let i=this.display.instance;if(i&&this.viewerContainerEl){let e=this.viewerContainerEl.clientWidth,a=this.viewerContainerEl.clientHeight,{width:n,height:r}=i.unscaledBounds,c=e/n,d=a/r;this.display.scale=Math.min(c,d)}}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.parameterSubscription?.cancel(),this.display.destroy()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Re),w(Te),w(yt),w(Ke),w(No),w(Ce),w(Wi))}}static{this.\u0275cmp=V({type:t,selectors:[["app-opi-display-viewer"]],viewQuery:function(e,a){if(e&1&&(_e(Jl,5),_e(es,7)),e&2){let n;he(n=fe())&&(a.frameInner=n.first),he(n=fe())&&(a.displayContainer=n.first)}},standalone:!0,features:[F],decls:4,vars:0,consts:[["frameInner",""],["displayContainer",""],[1,"frame-inner"],[1,"display-container"]],template:function(e,a){e&1&&(l(0,"div",2,0),b(2,"div",3,1),o())},dependencies:[Y],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:table}.frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center;line-height:0}.display-container[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0})}};function ns(t,i){if(t&1&&(l(0,"mat-option",5),S(1,"memberPath"),s(2),S(3,"memberPath"),o()),t&2){let e=i.$implicit;C("value",T(1,2,e)),p(2),L(" ",T(3,4,e)," ")}}function rs(t,i){if(t&1&&(l(0,"span",6),s(1),o()),t&2){let e=h();p(),q(e.hint)}}var ti=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new te(null,[Ee.required]);this.label=a.label||"Search parameter",this.okLabel=a.okLabel||"SELECT",this.limit=a.limit||10,this.hint=a.hint}ngOnInit(){let i=this.data.exclude||[];this.filteredOptions=this.parameter.valueChanges.pipe(Ha(300),Ya(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:this.limit,searchMembers:!0})),Ii(e=>e.parameters||[]),Ii(e=>e.filter(a=>{for(let n of i){let r=B.getMemberPath(a);if(n===r)return!1}return!0})))}select(){this.dialogRef.close(this.parameter.value)}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(X),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-select-parameter-dialog"]],standalone:!0,features:[F],decls:17,vars:9,consts:[["auto",""],["mat-dialog-title",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[1,"hint"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"h2",1),s(1),o(),l(2,"mat-dialog-content",2)(3,"label"),s(4),b(5,"input",3),l(6,"mat-autocomplete",4,0),re(8,ns,4,6,"mat-option",5,ne),S(10,"async"),o(),g(11,rs,2,1,"span",6),o()(),l(12,"mat-dialog-actions",7)(13,"ya-button",8),s(14,"CANCEL"),o(),l(15,"ya-button",9),E("click",function(){return k(n),A(a.select())}),s(16),o()()}if(e&2){let n=le(7);p(),q(a.label),p(3),L(" ",a.label," "),p(),C("formControl",a.parameter)("matAutocomplete",n),p(3),oe(T(10,7,a.filteredOptions)),p(3),x(a.hint?11:-1),p(4),C("disabled",!a.parameter.valid),p(),L(" ",a.okLabel," ")}},dependencies:[Y,ee,Ze,de,Gt,tn,Ja,an,Be,ht,He,$e,ge,hn],encapsulation:2,changeDetection:0})}};var ea=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.headerOptions=[{id:"QUALIFIED_NAME",label:"Qualified names"},{id:"SHORT_NAME",label:"Short names"},{id:"NONE",label:"None"}];this.downloadURL$=new $(null);this.form=new rt({start:new te(null),stop:new te(null),delimiter:new te(null,Ee.required),interval:new Ka(null),header:new te(null,Ee.required)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:B.toISOString(n),stop:B.toISOString(r),delimiter:"TAB",header:"QUALIFIED_NAME",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={delimiter:this.form.value.delimiter,header:this.form.value.header};this.data.parameterIds&&(i.parameters=this.data.parameterIds),this.data.list&&(i.list=this.data.list),this.form.value.start&&(i.start=B.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=B.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval),this.data.filename&&(i.filename=this.data.filename);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(X),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-export-archive-data-dialog"]],standalone:!0,features:[F],decls:38,vars:8,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"small-tabs",3,"mat-stretch-tabs"],["label","Content"],[2,"margin-top","1em"],[1,"label"],["cdkFocusRegionstart","","formControlName","start"],[1,"half-break"],["formControlName","stop"],[1,"hint"],["formControlName","interval","type","text",1,"ya-input"],["label","Format"],["formControlName","delimiter",3,"options"],["formControlName","header",3,"options"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Export archive data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-tab-group",3)(5,"mat-tab",4)(6,"div",5)(7,"div",6),s(8," Start "),b(9,"ya-date-time-input",7),o(),b(10,"hr",8),l(11,"div",6),s(12," Stop "),b(13,"ya-date-time-input",9),o(),b(14,"hr",8),l(15,"div",6),s(16," Interval (ms) "),l(17,"span",10),s(18,"(optional)"),o(),b(19,"br")(20,"input",11),o()()(),l(21,"mat-tab",12)(22,"div",5)(23,"div",6),s(24," CSV column delimiter "),b(25,"br")(26,"ya-select",13),o(),b(27,"hr",8),l(28,"div",6),s(29," Header "),b(30,"br")(31,"ya-select",14),o()()()()()(),l(32,"mat-dialog-actions",15)(33,"ya-button",16),s(34,"CANCEL"),o(),l(35,"ya-download-button",17),S(36,"async"),E("click",function(){return a.closeDialog()}),s(37," DOWNLOAD "),o()()),e&2&&(p(3),C("formGroup",a.form),p(),C("mat-stretch-tabs",!1),p(22),C("options",a.delimiterOptions),p(5),C("options",a.headerOptions),p(4),C("link",T(36,6,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[Y,ee,De,Ze,de,be,Se,Pe,Be,ht,He,$e,jo,qo,ge,vt,mn,Dt],encapsulation:2})}};function ls(t,i){if(t&1){let e=N();l(0,"ya-page-button",11),S(1,"async"),E("click",function(){k(e);let n=h(3);return A(n.save())}),s(2," SAVE "),o()}if(t&2){let e=h(3);C("disabled",!T(1,1,e.viewer.hasUnsavedChanges$))}}function ss(t,i){if(t&1){let e=N();l(0,"ya-page-button",12),E("click",function(){k(e);let n=h(3);return A(n.viewer.pause())}),s(1," PAUSE "),o()}}function cs(t,i){if(t&1){let e=N();l(0,"ya-page-button",13),E("click",function(){k(e);let n=h(3);return A(n.viewer.unpause())}),s(1," UNPAUSE "),o()}}function ps(t,i){if(t&1){let e=N();l(0,"ya-page-button",14),E("click",function(){k(e);let n=h(3);return A(n.viewer.delete())}),s(1," DELETE "),o()}if(t&2){let e=h(3);C("disabled",e.viewer.selection.isEmpty())}}function ms(t,i){if(t&1){let e=N();l(0,"ya-page-button",15),E("click",function(){k(e);let n=h(3);return A(n.viewer.enableScrollView())}),s(1," SCROLL VIEW "),o()}}function ds(t,i){if(t&1){let e=N();l(0,"ya-page-button",16),E("click",function(){k(e);let n=h(3);return A(n.viewer.enableStandardView())}),s(1," STANDARD VIEW "),o()}}function us(t,i){if(t&1){let e=N();g(0,ls,3,3,"ya-page-button",1)(1,ss,2,0,"ya-page-button",2),S(2,"async"),g(3,cs,2,0,"ya-page-button",3),S(4,"async"),l(5,"ya-page-button",4),E("click",function(){k(e);let n=h(2);return A(n.addParameter())}),s(6,"ADD"),o(),g(7,ps,2,1,"ya-page-button",5)(8,ms,2,0,"ya-page-button",6)(9,ds,2,0,"ya-page-button",7),l(10,"mat-menu",8,0)(12,"button",9),E("click",function(){k(e);let n=h(2);return A(n.exportArchiveData())}),s(13," Export archive data... "),o()(),l(14,"ya-page-button",10),E("click",function(n){return k(e),A(n.stopPropagation())}),o()}if(t&2){let e=i,a=le(11),n=h(2);x(n.mayManageDisplays()?0:-1),p(),x(T(2,8,n.viewer.paused$)?-1:1),p(2),x(T(4,10,n.viewer.paused$)?3:-1),p(4),x(e.scroll?-1:7),p(),x(e.scroll?-1:8),p(),x(e.scroll?9:-1),p(3),C("disabled",!e.parameters.length),p(2),C("matMenuTriggerFor",a)}}function hs(t,i){if(t&1&&(g(0,us,15,12),S(1,"async")),t&2){let e,a=h();x((e=T(1,1,a.viewer.model$))?0:-1,e)}}var En=class t{constructor(i,e,a,n){this.dialog=i;this.snackbar=e;this.authService=a;this.initialized$=new $(!1);this.bucket=n.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}addParameter(){this.dialog.open(ti,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.viewer.addParameter(e)})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}exportArchiveData(){let i=this.viewer.selection.selected;i.length||(i=this.viewer.getModel().parameters),this.dialog.open(ea,{width:"400px",data:{parameterIds:i}})}static{this.\u0275fac=function(e){return new(e||t)(w(Fe),w(en),w(Ct),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-table-viewer-controls"]],standalone:!0,features:[F],decls:2,vars:3,consts:[["moreMenu","matMenu"],["icon","save",3,"disabled"],["matTooltip","Pause value updates","icon","pause"],["matTooltip","Unpause value updates","icon","play_arrow"],["icon","playlist_add",3,"click"],["icon","delete",3,"disabled"],["icon","view_headline","iconRotate90","true"],["icon","view_headline"],["overlapTrigger","false"],["mat-menu-item","",3,"click","disabled"],["icon","more_vert",3,"click","matMenuTriggerFor"],["icon","save",3,"click","disabled"],["matTooltip","Pause value updates","icon","pause",3,"click"],["matTooltip","Unpause value updates","icon","play_arrow",3,"click"],["icon","delete",3,"click","disabled"],["icon","view_headline","iconRotate90","true",3,"click"],["icon","view_headline",3,"click"]],template:function(e,a){e&1&&(g(0,hs,2,3),S(1,"async")),e&2&&x(T(1,1,a.initialized$)?0:-1)},dependencies:[Y,ee,$i,ut,Hi,Yi,lt],encapsulation:2})}};var kn=class{constructor(i=10){this.pointer=0;this.latestValues=new Map;this.buf=Array(i).fill(void 0)}push(i,e){let a={};for(let n of i){let r=e[n.numericId];a[r.name]=n}this.buf[this.pointer]=a,this.pointer=(this.pointer+1)%this.buf.length;for(let n of i){let r=e[n.numericId];this.latestValues.set(r.name,n)}}getLatestValue(i){return this.latestValues.get(i)}setSize(i){this.buf=Array(i).fill(void 0),this.pointer=0}snapshot(){return this.pointer===0?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}};var fs=t=>({c:t});function _s(t,i){if(t&1){let e=N();l(0,"th",19)(1,"input",20),E("change",function(n){k(e);let r=h(2);return A(n?r.masterToggle():null)}),o()()}if(t&2){let e=h(2);p(),C("checked",e.selection.hasValue()&&e.isAllSelected())}}function gs(t,i){if(t&1){let e=N();l(0,"td",21)(1,"input",22),E("click",function(n){return k(e),A(n.stopPropagation())})("change",function(n){let r=k(e).$implicit,c=h(2);return A(n?c.selection.toggle(r.name):null)}),o()()}if(t&2){let e=i.$implicit,a=h(2);p(),C("checked",a.selection.isSelected(e.name))}}function vs(t,i){t&1&&(l(0,"th",23),s(1,"Name"),o())}function ys(t,i){if(t&1&&(l(0,"td",24)(1,"a",25),s(2),o()()),t&2){let e=i.$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e.name)("queryParams",Z(3,fs,a.yamcs.context)),p(),L(" ",e.name," ")}}function Cs(t,i){t&1&&(l(0,"th",23),s(1,"Severity"),o())}function xs(t,i){if(t&1&&b(0,"app-alarm-level",26),t&2){let e=h().$implicit;C("level",e.pval==null?null:e.pval.monitoringResult)}}function bs(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Ss(t,i){if(t&1&&(l(0,"td",21),g(1,xs,1,1,"app-alarm-level",26)(2,bs,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.pval!=null&&e.pval.monitoringResult?1:2)}}function ws(t,i){t&1&&(l(0,"th",23),s(1,"Raw"),o())}function Ts(t,i){if(t&1&&(l(0,"td",27),s(1),S(2,"value"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.pval==null?null:e.pval.rawValue)||"-"," ")}}function Ds(t,i){t&1&&(l(0,"th",23),s(1,"Eng"),o())}function Ps(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Es(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function ks(t,i){if(t&1&&(l(0,"ya-expirable",28),s(1),S(2,"value"),g(3,Ps,2,0,"span")(4,Es,2,0,"span"),o()),t&2){let e=h().$implicit;C("pval",e.pval),p(),L(" ",T(2,4,e.pval==null?null:e.pval.engValue)||"-"," "),p(2),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?4:-1)}}function As(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Ms(t,i){if(t&1&&(l(0,"td",27),g(1,ks,5,6,"ya-expirable",28)(2,As,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.pval?1:2)}}function Rs(t,i){t&1&&(l(0,"th",23),s(1,"Reception time"),o())}function Is(t,i){if(t&1&&(l(0,"td",21),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.pval==null?null:e.pval.acquisitionTime)||"-"," ")}}function Ls(t,i){t&1&&(l(0,"th",23),s(1,"Generation time"),o())}function Os(t,i){if(t&1&&(l(0,"td",21),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),q(T(2,1,e.pval==null?null:e.pval.generationTime)||"-")}}function Vs(t,i){t&1&&(l(0,"th",23),s(1,"Acquisition status"),o())}function Ns(t,i){if(t&1&&(l(0,"td",21),s(1),o()),t&2){let e=i.$implicit;p(),q((e.pval==null?null:e.pval.acquisitionStatus)||"-")}}function Fs(t,i){t&1&&b(0,"th",29)}function Bs(t,i){if(t&1){let e=N();l(0,"td",21)(1,"ya-icon-action",30),E("click",function(n){let r=k(e).index;return h(2).moveDown.emit(r),A(n.stopPropagation())}),o(),l(2,"ya-icon-action",31),E("click",function(n){let r=k(e).index;return h(2).moveUp.emit(r),A(n.stopPropagation())}),o()()}}function $s(t,i){t&1&&b(0,"tr",32)}function Hs(t,i){if(t&1){let e=N();l(0,"tr",33),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n.name))}),o()}if(t&2){let e=i.$implicit,a=h(2);me("selected",a.selection.isSelected(e.name))}}function Ys(t,i){if(t&1&&(l(0,"table",1),G(1,2),g(2,_s,2,1,"th",3)(3,gs,2,1,"td",4),U(),G(4,5),g(5,vs,2,0,"th",6)(6,ys,3,5,"td",7),U(),G(7,8),g(8,Cs,2,0,"th",6)(9,Ss,3,1,"td",4),U(),G(10,9),g(11,ws,2,0,"th",6)(12,Ts,3,3,"td",10),U(),G(13,11),g(14,Ds,2,0,"th",6)(15,Ms,3,1,"td",10),U(),G(16,12),g(17,Rs,2,0,"th",6)(18,Is,3,3,"td",4),U(),G(19,13),g(20,Ls,2,0,"th",6)(21,Os,3,3,"td",4),U(),G(22,14),g(23,Vs,2,0,"th",6)(24,Ns,2,1,"td",4),U(),G(25,15),g(26,Fs,1,0,"th",16)(27,Bs,3,0,"td",4),U(),g(28,$s,1,0,"tr",17)(29,Hs,1,2,"tr",18),o()),t&2){let e=h();me("paused",e.paused),C("dataSource",e.dataSource),p(28),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}var An=class t{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!1,parameters:[]};this.moveUp=new at;this.moveDown=new at;this.dataSource=new Ot([]);this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"];this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){let i=this.model.parameters.map(e=>({name:e}));for(let e of i)e.pval=this.buffer.getLatestValue(e.name);this.dataSource.data=i,this.changeDetector.detectChanges()}ngOnChanges(){this.showActions?this.displayedColumns=["select",...this.defaultColumns,"actions"]:this.displayedColumns=this.defaultColumns}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i.name))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}ngOnDestroy(){this.syncSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(It),w(yt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},standalone:!0,features:[Mt,F],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"text-align","left"],["type","checkbox",3,"change","checked"],["mat-cell",""],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){e&1&&g(0,Ys,30,5,"table",0),e&2&&x(a.dataSource.data.length?0:-1)},dependencies:[ei,Y,Ie,ci,Lt,li,si,zi,Ye,Ge,Ue,ze,We,Zt,pi,Le,Nt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0})}};var Gs=t=>({c:t});function Us(t,i){t&1&&(l(0,"th",10),s(1,"Generation time"),o())}function zs(t,i){if(t&1&&(l(0,"td",11),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),q(T(2,1,e.generationTime)||"-")}}function Ws(t,i){if(t&1){let e=N();l(0,"ya-more")(1,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveLeft.emit(n))}),s(2,"Move left"),o(),l(3,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveRight.emit(n))}),s(4,"Move right"),o(),b(5,"mat-divider"),l(6,"button",13),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.removeColumn.emit(n))}),s(7,"Remove column"),o()()}}function js(t,i){if(t&1&&(l(0,"th",10)(1,"a",12),s(2),o(),g(3,Ws,8,0,"ya-more"),o()),t&2){let e=h().$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e)("queryParams",Z(4,Gs,a.yamcs.context)),p(),L(" ",e," "),p(),x(a.showActions?3:-1)}}function qs(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Xs(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function Zs(t,i){if(t&1&&(l(0,"ya-expirable",14),s(1),S(2,"value"),g(3,qs,2,0,"span")(4,Xs,2,0,"span"),o()),t&2){let e=h();C("pval",e),p(),L(" ",T(2,4,e.engValue)||"-"," "),p(2),x(e.rangeCondition==="LOW"?3:-1),p(),x(e.rangeCondition==="HIGH"?4:-1)}}function Qs(t,i){t&1&&g(0,Zs,5,6,"ya-expirable",14),t&2&&x(i?0:-1)}function Ks(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Js(t,i){if(t&1&&(l(0,"td",11),g(1,Qs,1,1)(2,Ks,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit;p(),x((e=a.pvals[n])?1:2,e)}}function ec(t,i){if(t&1&&(G(0,5),g(1,js,4,6,"th",3)(2,Js,3,1,"td",4),U()),t&2){let e=i.$implicit;C("cdkColumnDef",e)}}function tc(t,i){t&1&&b(0,"th",15)}function ic(t,i){t&1&&b(0,"td",11)}function ac(t,i){t&1&&b(0,"tr",16)}function nc(t,i){t&1&&b(0,"tr",17)}function rc(t,i){if(t&1&&(l(0,"table",1),G(1,2),g(2,Us,2,0,"th",3)(3,zs,3,3,"td",4),U(),re(4,ec,3,1,"ng-container",5,ne),G(6,6),g(7,tc,1,0,"th",7)(8,ic,1,0,"td",4),U(),g(9,ac,1,0,"tr",8)(10,nc,1,0,"tr",9),o()),t&2){let e=h();me("paused",e.paused),C("dataSource",e.dataSource),p(4),oe(e.model.parameters),p(5),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}function oc(t,i){if(t&1&&(l(0,"p"),s(1,"\xA0"),o(),s(2," Buffer size: "),l(3,"select",18)(4,"option",19),s(5,"10"),o(),l(6,"option",20),s(7,"25"),o(),l(8,"option",21),s(9,"50"),o(),l(10,"option",22),s(11,"75"),o(),l(12,"option",23),s(13,"100"),o()()),t&2){let e=h();p(3),C("formControl",e.bufferSizeControl)}}var Mn=class t{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!0,parameters:[]};this.removeColumn=new at;this.moveLeft=new at;this.moveRight=new at;this.bufferSize=new at;this.dataSource=new Ot([]);this.bufferSizeControl=new te("10");this.displayedColumns=["generationTime","actions"];this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{let n=this.bufferSizeControl.value;n!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(n,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){let i=[],e=this.buffer.snapshot();for(let a of e){let n=this.findAnyMatchingParameterValue(a);n&&i.push({generationTime:n.generationTime,pvals:a})}this.dataSource.data=i,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(i){for(let e in i)if(i.hasOwnProperty(e)&&this.model.parameters.indexOf(e)!==-1)return i[e]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.bufferSizeControlSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(It),w(yt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},standalone:!0,features:[Mt,F],decls:2,vars:2,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(e,a){e&1&&g(0,rc,11,5,"table",0)(1,oc,14,1),e&2&&(x(a.dataSource.data.length?0:-1),p(),x(a.showActions?1:-1))},dependencies:[Y,Ni,Fi,Vi,de,Gt,Ie,ci,Lt,li,si,zi,Wt,ut,Ye,Ge,Ue,ze,We,Zt,Vt,Le,Nt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0})}};function lc(t,i){if(t&1){let e=N();l(0,"app-scrolling-parameter-table",4),S(1,"async"),S(2,"async"),E("moveLeft",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveRight",function(n){k(e);let r=h(3);return A(r.moveDown(n))})("removeColumn",function(n){k(e);let r=h(3);return A(r.removeParameter(n))})("bufferSize",function(n){k(e);let r=h(3);return A(r.setBufferSize(n))}),o()}if(t&2){let e=h(2),a=h();C("model",e)("buffer",a.buffer)("paused",T(1,4,a.paused$))("showActions",T(2,6,a.showActions$))}}function sc(t,i){if(t&1){let e=N();l(0,"app-multiple-parameter-table",5),S(1,"async"),S(2,"async"),E("moveUp",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveDown",function(n){k(e);let r=h(3);return A(r.moveDown(n))}),o()}if(t&2){let e=h(2),a=h();C("model",e)("buffer",a.buffer)("paused",T(1,5,a.paused$))("showActions",T(2,7,a.showActions$))("selection",a.selection)}}function cc(t,i){if(t&1&&g(0,lc,3,8,"app-scrolling-parameter-table",2)(1,sc,3,9,"app-multiple-parameter-table",3),t&2){let e=h();x(e.scroll?0:1)}}function pc(t,i){if(t&1){let e=N();l(0,"ya-empty-message")(1,"div",6)(2,"p"),s(3," This file is empty. "),b(4,"br"),s(5," Start by "),l(6,"a",7),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),s(7," adding a parameter "),o(),s(8," . "),o()()()}}function mc(t,i){if(t&1){let e=N();l(0,"ya-empty-message")(1,"div",6)(2,"p"),s(3," This file is empty. "),b(4,"br"),s(5," Start by "),l(6,"a",7),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),s(7," adding a parameter "),o(),s(8," . "),o()()()}}function dc(t,i){t&1&&(l(0,"div",1),g(1,cc,2,1)(2,pc,9,0,"ya-empty-message")(3,mc,9,0,"ng-template",null,0,gi),o()),t&2&&(p(),x(i.parameters.length?1:2))}var In=class t{constructor(i,e,a){this.yamcs=i;this.dialog=e;this.selection=new Bi(!0,[]);this.model$=new $(null);this.buffer=new kn;this.paused$=new $(!1);this.hasUnsavedChanges$=new $(!1);this.showActions$=new $(!1);this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{let n=JSON.parse(a);this.model$.next(n),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){let i=this.model$.value.parameters.map(e=>({name:e}));i.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=e.mapping);let a=e.values||[];this.buffer.push(a,this.idMapping)}))}addParameter(i){let e=this.model$.value;e.parameters.push(i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(i){this.model$.next({scroll:i.scroll,bufferSize:i.bufferSize||10,parameters:i.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){let i=this.model$.value;i.parameters=i.parameters.filter(e=>!this.selection.isSelected(e)),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();let i=this.model$.value;i.scroll=!0,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();let i=this.model$.value;i.scroll=!1,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}removeParameter(i){let e=this.model$.value;e.parameters=e.parameters.filter(a=>a!==i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveUp(i){let e=this.model$.value,a=e.parameters[i];i===0?(e.parameters[i]=e.parameters[e.parameters.length-1],e.parameters[e.parameters.length-1]=a):(e.parameters[i]=e.parameters[i-1],e.parameters[i-1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveDown(i){let e=this.model$.value,a=e.parameters[i];i===e.parameters.length-1?(e.parameters[i]=e.parameters[0],e.parameters[0]=a):(e.parameters[i]=e.parameters[i+1],e.parameters[i+1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}setBufferSize(i){this.buffer.setSize(i);let e=this.model$.value;e.bufferSize=i,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}save(){let i=new Blob([JSON.stringify(tt({$schema:"https://yamcs.org/schema/parameter-table.schema.json"},this.model$.value),void 0,2)],{type:"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,i).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(ti,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.addParameter(e)})}ngOnDestroy(){this.dataSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Fe),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-table-viewer"]],standalone:!0,features:[F],decls:2,vars:3,consts:[["empty",""],[1,"panel-content"],[3,"model","buffer","paused","showActions"],[3,"model","buffer","paused","showActions","selection"],[3,"moveLeft","moveRight","removeColumn","bufferSize","model","buffer","paused","showActions"],[3,"moveUp","moveDown","model","buffer","paused","showActions","selection"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(e,a){if(e&1&&(g(0,dc,5,1,"div",1),S(1,"async")),e&2){let n;x((n=T(1,1,a.model$))?0:-1,n)}},dependencies:[An,Mn,Y,ee,Xt],styles:[".panel-content[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0})}};function uc(t,i){if(t&1){let e=N();l(0,"ya-page-button",1),S(1,"async"),E("click",function(){k(e);let n=h(2);return A(n.save())}),s(2," SAVE "),o()}if(t&2){let e=h(2);C("disabled",!T(1,1,e.viewer.hasUnsavedChanges$))}}function hc(t,i){if(t&1&&g(0,uc,3,3,"ya-page-button",0),t&2){let e=h();x(e.mayManageDisplays()?0:-1)}}var Ln=class t{constructor(i,e,a){this.snackbar=i;this.authService=e;this.initialized$=new $(!1);this.bucket=a.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}static{this.\u0275fac=function(e){return new(e||t)(w(en),w(Ct),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:2,vars:3,consts:[["icon","save",3,"disabled"],["icon","save",3,"click","disabled"]],template:function(e,a){e&1&&(g(0,hc,1,1),S(1,"async")),e&2&&x(T(1,1,a.initialized$)?0:-1)},dependencies:[Y,ee,lt],encapsulation:2})}};var fc=["scriptContainer"],On=class t{constructor(i,e,a,n){this.messageService=a;this.authService=n;this.hasUnsavedChanges$=new $(!1);this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>e.text().then(a=>this.initializeEditor(a))).catch(e=>this.messageService.showError(e)),Promise.resolve()}initializeEditor(i){let e=[Wo,Uo.of([zo]),ul(),ya.lineWrapping];this.mayManageDisplays()?e.push(ya.updateListener.of(r=>{r.docChanged&&this.hasUnsavedChanges$.next(!0)})):e.push(jr.readOnly.of(!0));let a=ya.theme({"&":{width:"100%",height:"100%",fontSize:"12px"},".cm-scroller":{overflow:"auto",fontFamily:"'Roboto Mono', monospace"}},{dark:!1});e.push(a);let n=jr.create({doc:i,extensions:e});this.editorView=new ya({state:n,parent:this.scriptContainer.nativeElement})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}hasPendingChanges(){return this.hasUnsavedChanges$.value}async save(){let i=this.editorView.state.doc.toString(),e=new Blob([i],{type:"text/javascript"});return this.storageClient.uploadObject(this.bucket,this.objectName,e).then(()=>{this.hasUnsavedChanges$.next(!1)})}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Ce),w(Ke),w(Ct))}}static{this.\u0275cmp=V({type:t,selectors:[["app-script-viewer"]],viewQuery:function(e,a){if(e&1&&_e(fc,5),e&2){let n;he(n=fe())&&(a.scriptContainer=n.first)}},standalone:!0,features:[F],decls:2,vars:0,consts:[["scriptContainer",""],[1,"script-container"]],template:function(e,a){e&1&&b(0,"div",1,0)},dependencies:[Y],styles:[".script-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex}"],changeDetection:0})}};function _c(t,i){if(t&1&&(l(0,"pre"),s(1),o()),t&2){let e=h();p(),q(e.text)}}var Vn=class t{constructor(i,e,a){this.changeDetector=e;this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{this.text=a,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(It),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["app-text-viewer"]],standalone:!0,features:[F],decls:1,vars:1,template:function(e,a){e&1&&g(0,_c,2,1,"pre"),e&2&&x(a.text?0:-1)},dependencies:[Y],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0})}};var Sa=class t{constructor(i){this.viewContainerRef=i}static{this.\u0275fac=function(e){return new(e||t)(w(qa))}}static{this.\u0275dir=Ua({type:t,selectors:[["","app-viewer-controls-host",""]],standalone:!0})}};var wa=class t{constructor(i){this.viewContainerRef=i}static{this.\u0275fac=function(e){return new(e||t)(w(qa))}}static{this.\u0275dir=Ua({type:t,selectors:[["","app-viewer-host",""]],standalone:!0})}};var gc=["viewerContainer"],vc=t=>({c:t});function yc(t,i){}function Cc(t,i){}var Nn=class t{constructor(i,e,a,n,r){this.yamcs=i;this.route=e;this.title=n;this.subscriptions=[];let c=this.getObjectNameFromUrl();this.loadFile(c);let d=a.events.pipe($a(u=>u instanceof Za)).subscribe(()=>{let u=this.getObjectNameFromUrl();u!==this.objectName&&this.loadFile(u,!0)});this.subscriptions.push(d);let m=e.snapshot.queryParamMap.get("range");m&&i.range$.next(m),d=i.range$.subscribe(u=>{a.navigate([],{replaceUrl:!0,relativeTo:e,queryParams:{range:u},queryParamsHandling:"merge"})}),this.subscriptions.push(d)}getObjectNameFromUrl(){let i=this.route.snapshot.url,e="";for(let a of i)e&&(e+="/"),e+=a.path;return e}loadFile(i,e=!1){this.objectName=i;let a=this.objectName.lastIndexOf("/");if(a===-1)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{let n=this.objectName.substring(0,a);this.folderLink="/telemetry/displays/browse/"+n,this.filename=this.objectName.substring(a+1)}this.title.setTitle(this.filename),e&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){let i=this.createViewer(Pn);i.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(vn).init(i),this.viewer=i}else if(this.filename.toLowerCase().endsWith(".par")){let i=this.createViewer(In);this.createViewerControls(En).init(i),i.setEnableActions(),this.viewer=i}else if(this.isImage())this.viewer=this.createViewer(gn);else if(this.filename.toLocaleLowerCase().endsWith(".js")){let i=this.createViewer(On);this.createViewerControls(Ln).init(i),this.viewer=i}else this.viewer=this.createViewer(Vn);this.viewer.init(this.objectName)}createViewer(i){let e=this.viewerHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}createViewerControls(i){let e=this.controlsHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}isImage(){let i=this.filename.toLowerCase();return i.endsWith(".png")||i.endsWith(".gif")||i.endsWith(".jpg")||i.endsWith("jpeg")||i.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.subscriptions.forEach(i=>i.unsubscribe())}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Te),w(Re),w(nt),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(_e(Sa,5),_e(gc,5),_e(wa,5)),e&2){let n;he(n=fe())&&(a.controlsHost=n.first),he(n=fe())&&(a.viewerContainer=n.first),he(n=fe())&&(a.viewerHost=n.first)}},standalone:!0,features:[F],decls:8,vars:5,consts:[["viewerContainer",""],["icon","arrow_back",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["app-viewer-host",""]],template:function(e,a){e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",1),s(3),g(4,yc,0,0,"ng-template",2),o(),l(5,"div",3,0),g(7,Cc,0,0,"ng-template",4),o()()),e&2&&(p(2),C("routerLink",a.folderLink)("queryParams",Z(3,vc,a.yamcs.context)),p(),L(" ",a.filename," \xA0\xA0\xA0 "))},dependencies:[et,Je,Y,Ie,Kt,Sa,wa],encapsulation:2,changeDetection:0})}};var xc=["filename"];function bc(t,i){if(t&1&&(l(0,"form",2)(1,"label"),s(2," Type "),l(3,"select",7)(4,"option",8),s(5,"Parameter Table"),o()()()()),t&2){let e=h();C("formGroup",e.typeForm)}}function Sc(t,i){t&1&&(l(0,"span",10),s(1," File name must end with "),l(2,"code"),s(3,".par"),o()())}function wc(t,i){if(t&1&&(l(0,"form",2)(1,"label"),s(2," Name "),b(3,"input",9,0),g(5,Sc,4,0,"span",10),o(),b(6,"br"),l(7,"label"),s(8," Path "),b(9,"input",11),o()()),t&2){let e,a,n=h();C("formGroup",n.filenameForm),p(),me("invalid",(e=n.filenameForm.get("name"))==null?null:e.invalid),p(4),x((a=n.filenameForm.get("name"))!=null&&a.invalid?5:-1)}}function Tc(t,i){if(t&1){let e=N();l(0,"ya-button",12),E("click",function(){k(e);let n=h();return A(n.selectType())}),s(1,"NEXT \xBB"),o()}if(t&2){let e=h();C("disabled",!e.typeForm.valid)}}function Dc(t,i){if(t&1){let e=N();l(0,"ya-button",13),E("click",function(){k(e);let n=h();return A(n.save())}),s(1," SAVE "),o()}if(t&2){let e=h();C("disabled",!e.filenameForm.valid)}}var Fn=class t{constructor(i,e,a,n,r,c){this.dialogRef=i;this.data=n;this.changeDetector=r;this.configService=c;this.page=1;this.storageClient=a.createStorageClient(),this.typeForm=e.group({type:["par",Ee.required]}),this.filenameForm=e.group({path:[n.path,Ee.required],name:["",[Ee.required,Ee.pattern(/.*\.par/i)]]})}selectType(){let i=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${i}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let i=this.filenameForm.get("path").value.trim(),e=this.filenameForm.get("name").value.trim();i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1));let a=i?i+"/"+e:e,n=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",scroll:!1,parameters:[]},void 0,2)],{type:"application/json"}),r=this.configService.getDisplayBucket(),c=this.data.prefix+a;this.storageClient.uploadObject(r,c,n).then(()=>{this.dialogRef.close(a)})}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Ut),w(X),w(Qe),w(It),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["app-create-display-dialog"]],viewQuery:function(e,a){if(e&1&&_e(xc,5),e&2){let n;he(n=fe())&&(a.filenameInput=n.first)}},standalone:!0,features:[F],decls:10,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["align","end"],["mat-dialog-close",""],[3,"disabled"],["appearance","primary",3,"disabled"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],[1,"error-message"],["type","text","formControlName","path"],[3,"click","disabled"],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",1),s(1,"Create display"),o(),l(2,"mat-dialog-content"),g(3,bc,6,1,"form",2)(4,wc,10,4,"form",2),o(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),s(7,"CANCEL"),o(),g(8,Tc,2,1,"ya-button",5)(9,Dc,2,1,"ya-button",6),o()),e&2&&(p(3),x(a.page===1?3:-1),p(),x(a.page===2?4:-1),p(4),x(a.page===1?8:-1),p(),x(a.page===2?9:-1))},dependencies:[Y,De,Ni,Fi,Ze,Vi,de,be,Se,Pe,Be,ht,He,$e,ge],encapsulation:2})}};var Bn=class t{constructor(i,e,a,n){this.dialogRef=i;this.data=n;this.storageClient=a.createStorageClient(),this.form=e.group({name:["",Ee.required]})}save(){let{path:i,bucket:e}=this.data;i.startsWith("/")&&(i=i.substring(1));let a=this.form.value.name,n=i?`${i}/${a}/`:`${a}/`;this.storageClient.uploadObject(e,n,new Blob).then(()=>this.dialogRef.close(!0))}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Ut),w(X),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-create-display-folder-dialog"]],standalone:!0,features:[F],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Create folder"),o(),l(2,"mat-dialog-content")(3,"form",1)(4,"label"),s(5," Folder name "),b(6,"input",2),o()()(),l(7,"mat-dialog-actions",3)(8,"ya-button",4),s(9,"CANCEL"),o(),l(10,"ya-button",5),E("click",function(){return a.save()}),s(11,"CREATE"),o()()),e&2&&(p(3),C("formGroup",a.form),p(7),C("disabled",!a.form.valid))},dependencies:[Y,De,Ze,de,be,Yo,Se,Pe,Be,ht,He,$e,ge],encapsulation:2,changeDetection:0})}};var $n=class t{constructor(i,e,a,n,r){this.dialogRef=i;this.data=r;this.storageClient=a.createStorageClient(),this.bucket=n.getDisplayBucket();let c=B.getFilename(this.data.name);this.filenameForm=e.group({name:[c,[Ee.required]]})}async rename(){let i,e=this.data.name.lastIndexOf("/");e!==-1&&(i=this.data.name.substring(0,e+1));let n=await(await this.storageClient.getObject(this.bucket,this.data.name)).blob(),r=(i||"")+this.filenameForm.get("name").value;await this.storageClient.uploadObject(this.bucket,r,n),await this.storageClient.deleteObject(this.bucket,this.data.name),this.dialogRef.close(r)}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Ut),w(X),w(Ce),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-rename-display-dialog"]],standalone:!0,features:[F],decls:13,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"h2",1),s(1,"Rename file"),o(),l(2,"mat-dialog-content")(3,"form",2)(4,"label"),s(5," Name "),b(6,"input",3,0),o()()(),l(8,"mat-dialog-actions",4)(9,"ya-button",5),s(10,"CANCEL"),o(),l(11,"ya-button",6),E("click",function(){return k(n),A(a.rename())}),s(12," RENAME "),o()()}if(e&2){let n;p(3),C("formGroup",a.filenameForm),p(),me("invalid",(n=a.filenameForm.get("name"))==null?null:n.invalid),p(7),C("disabled",!a.filenameForm.valid)}},dependencies:[Y,De,Ze,de,be,Se,Pe,Be,ht,He,$e,ge],encapsulation:2})}};var Hn=class t{transform(i){if(!i)return null;let e=i.toLowerCase();return e.endsWith(".opi")?"Operator Interface":e.endsWith(".par")?"Parameter Table":e.endsWith(".js")?"Script File":e.indexOf(".")!==-1?e.substr(e.lastIndexOf(".")+1).toUpperCase()+" File":null}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275pipe=za({name:"displayType",type:t,pure:!0,standalone:!0})}};var Pc=["droparea"],Ec=["uploader"],Gn=t=>({c:t});function kc(t,i){if(t&1){let e=N();l(0,"ya-page-button",10),E("click",function(){k(e);let n=h();return A(n.createDisplay())}),s(1," Create display "),o()}}function Ac(t,i){if(t&1){let e=N();l(0,"ya-page-button",11),E("click",function(){k(e);let n=le(3);return A(n.click())}),s(1," Upload files "),l(2,"input",12,1),E("change",function(){k(e);let n=h();return A(n.uploadFiles())}),o()()}}function Mc(t,i){if(t&1){let e=N();l(0,"ya-page-button",13),E("click",function(){k(e);let n=h();return A(n.createFolder())}),s(1," Create folder "),o()}}function Rc(t,i){if(t&1){let e=N();l(0,"ya-page-button",14),E("click",function(){k(e);let n=h();return A(n.deleteSelectedDisplays())}),s(1," Delete "),o()}if(t&2){let e=h();C("disabled",!e.selection.hasValue())}}function Ic(t,i){if(t&1&&b(0,"ya-breadcrumb",16),t&2){let e=i.$implicit,a=h(3);C("link",e.route)("queryParams",Z(3,Gn,a.yamcs.context))("label",e.name)}}function Lc(t,i){if(t&1&&(l(0,"ya-breadcrumb-trail"),b(1,"ya-breadcrumb",15),re(2,Ic,1,5,"ya-breadcrumb",16,ne),o()),t&2){let e=h(),a=h();p(),C("queryParams",Z(1,Gn,a.yamcs.context)),p(),oe(e)}}function Oc(t,i){t&1&&g(0,Lc,4,3,"ya-breadcrumb-trail"),t&2&&x(i.length?0:-1)}function Vc(t,i){if(t&1){let e=N();l(0,"input",33),E("change",function(n){k(e);let r=h(3);return A(n?r.masterToggle():null)}),o()}if(t&2){let e=h(3);C("checked",e.selection.hasValue()&&e.isAllSelected())}}function Nc(t,i){if(t&1&&(l(0,"th",31),g(1,Vc,1,1,"input",32),o()),t&2){let e=h(2);p(),x(e.mayManageDisplays()?1:-1)}}function Fc(t,i){if(t&1){let e=N();l(0,"input",35),E("click",function(n){return k(e),A(n.stopPropagation())})("change",function(n){k(e);let r=h().$implicit,c=h(2);return A(n?c.selection.toggle(r):null)}),o()}if(t&2){let e=h().$implicit,a=h(2);C("checked",a.selection.isSelected(e))}}function Bc(t,i){if(t&1&&(l(0,"td",34),g(1,Fc,1,1,"input",32),o()),t&2){let e=h(2);p(),x(e.mayManageDisplays()?1:-1)}}function $c(t,i){t&1&&(l(0,"th",36),s(1,"Name"),o())}function Hc(t,i){if(t&1){let e=N();l(0,"mat-icon",38),s(1," folder "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),s(3),S(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);p(2),C("routerLink","/telemetry/displays/browse/"+e.name)("queryParams",Z(5,Gn,a.yamcs.context)),p(),L(" ",T(4,3,e.name)," ")}}function Yc(t,i){if(t&1){let e=N();l(0,"mat-icon",38),s(1," description "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),s(3),S(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);p(2),C("routerLink","/telemetry/displays/files/"+e.name)("queryParams",Z(5,Gn,a.yamcs.context)),p(),L(" ",T(4,3,e.name)," ")}}function Gc(t,i){if(t&1&&(l(0,"td",37),g(1,Hc,5,7)(2,Yc,5,7),o()),t&2){let e=i.$implicit;p(),x(e.folder?1:2)}}function Uc(t,i){t&1&&(l(0,"th",36),s(1,"Type"),o())}function zc(t,i){t&1&&s(0," Folder ")}function Wc(t,i){if(t&1&&(s(0),S(1,"displayType")),t&2){let e=h().$implicit;L(" ",T(1,1,e.name)||"-"," ")}}function jc(t,i){if(t&1&&(l(0,"td",37),g(1,zc,1,0)(2,Wc,2,3),o()),t&2){let e=i.$implicit;p(),x(e.folder?1:2)}}function qc(t,i){t&1&&(l(0,"th",36),s(1,"Visibility"),o())}function Xc(t,i){t&1&&(l(0,"td",37),s(1,"Private"),o())}function Zc(t,i){t&1&&(l(0,"th",36),s(1,"Date modified"),o())}function Qc(t,i){if(t&1&&(l(0,"td",37),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.modified)||"-"," ")}}function Kc(t,i){t&1&&b(0,"th",40)}function Jc(t,i){if(t&1){let e=N();l(0,"ya-more")(1,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.renameFile(n))}),s(2,"Rename"),o(),l(3,"a",42),s(4,"Download"),o(),b(5,"mat-divider"),l(6,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.deleteFile(n))}),s(7,"Delete"),o()()}if(t&2){let e=h(2).$implicit;p(3),C("href",e.objectUrl,ja)}}function ep(t,i){if(t&1&&g(0,Jc,8,1,"ya-more"),t&2){let e=h(3);x(e.mayManageDisplays()?0:-1)}}function tp(t,i){if(t&1&&(l(0,"td",37),g(1,ep,1,1),o()),t&2){let e=i.$implicit;p(),x(e.folder?-1:1)}}function ip(t,i){t&1&&b(0,"tr",43)}function ap(t,i){if(t&1){let e=N();l(0,"tr",44),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);me("selected",a.selection.isSelected(e))}}function np(t,i){if(t&1&&(l(0,"table",9),G(1,17),g(2,Nc,2,1,"th",18)(3,Bc,2,1,"td",19),U(),G(4,20),g(5,$c,2,0,"th",21)(6,Gc,3,1,"td",22),U(),G(7,23),g(8,Uc,2,0,"th",21)(9,jc,3,1,"td",22),U(),G(10,24),g(11,qc,2,0,"th",21)(12,Xc,2,0,"td",22),U(),G(13,25),g(14,Zc,2,0,"th",21)(15,Qc,3,3,"td",22),U(),G(16,26),g(17,Kc,1,0,"th",27)(18,tp,2,1,"td",28),U(),g(19,ip,1,0,"tr",29)(20,ap,1,2,"tr",30),o()),t&2){let e=h();C("dataSource",e.dataSource),p(19),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}function rp(t,i){t&1&&(l(0,"ya-empty-message"),s(1,"Empty directory."),o())}var Yn=class t{constructor(i,e,a,n,r,c,d,m){this.dialog=i;this.yamcs=e;this.router=n;this.route=r;this.authService=c;this.messageService=d;this.breadcrumb$=new $([]);this.dragActive$=new $(!1);this.displayedColumns=["select","name","type","modified","actions"];this.dataSource=new Ot([]);this.selection=new Bi(!0,[]);a.setTitle("Displays"),this.storageClient=e.createStorageClient(),this.bucket=m.getDisplayBucket(),this.loadCurrentFolder(),this.routerSubscription=n.events.pipe($a(u=>u instanceof Za)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){let i={delimiter:"/"},e=this.route.snapshot.url;e.length&&(i.prefix=e.map(a=>a.path).join("/")+"/"),this.storageClient.listObjects(this.bucket,i).then(a=>{this.updateBrowsePath(),this.changedir(a)})}changedir(i){this.selection.clear();let e=[];for(let a of i.prefixes||[])e.push({folder:!0,name:a});for(let a of i.objects||[])a.name.endsWith("/")||e.push({folder:!1,name:a.name,modified:a.created,objectUrl:this.storageClient.getObjectURL(this.bucket,a.name)});this.dataSource.data=e}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}createDisplay(){this.dialog.open(Fn,{width:"400px",data:{path:this.getCurrentPath(),prefix:""}}).afterClosed().subscribe(e=>{e&&this.router.navigateByUrl(`/telemetry/displays/files/${e}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Bn,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let i=this.getCurrentPath();i.startsWith("/")&&(i=i.substring(1));let e=this.uploaderEl.nativeElement.files,a=[];for(let n in e)if(!isNaN(parseInt(n,10))){let r=e[n],m=""+(i?i+"/"+r.name:r.name),u=this.storageClient.uploadObject(this.bucket,m,r);a.push(u)}Promise.all(a).then(()=>this.loadCurrentFolder()).catch(n=>this.messageService.showError(n))}getCurrentPath(){let i="";for(let e of this.route.snapshot.url)i+="/"+e.path;return i||"/"}deleteSelectedDisplays(){let i=[],e=[];for(let a of this.selection.selected)a.folder?e.push(this.storageClient.listObjects(this.bucket,{prefix:a.name}).then(n=>{let r=n.objects||[];i.push(...r.map(c=>c.name))})):i.push(a.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${i.length} files. Are you sure you want to continue?`)){let a=[];for(let n of i)a.push(this.storageClient.deleteObject(this.bucket,n));Promise.all(a).then(()=>{this.loadCurrentFolder()})}})}renameFile(i){this.dialog.open($n,{data:{name:i.name},width:"400px"}).afterClosed().subscribe(a=>{a&&this.loadCurrentFolder()})}deleteFile(i){confirm(`Are you sure you want to delete ${i.name}?`)&&this.storageClient.deleteObject(this.bucket,i.name).then(()=>{this.loadCurrentFolder()})}dragEnter(i){return this.dragActive$.next(!0),i.preventDefault(),i.stopPropagation(),!1}dragOver(i){return i.preventDefault(),i.stopPropagation(),!1}dragLeave(i){return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}drop(i){let e=i.dataTransfer||{};if(e){let a=this.getCurrentPath().substring(1);a!==""&&(a+="/"),dl(e).then(n=>{let r=[];for(let c of n){let d=a+c._fullPath,m=this.storageClient.uploadObject(this.bucket,d,c);r.push(m)}Promise.all(r).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){let i=[],e="";for(let a of this.route.snapshot.url)e+="/"+a.path,i.push({name:a.path,route:"/telemetry/displays/browse"+e});return this.breadcrumb$.next(i),e||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(Fe),w(X),w(nt),w(Re),w(Te),w(Ct),w(Ke),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(_e(Pc,7),_e(Ec,5)),e&2){let n;he(n=fe())&&(a.dropArea=n.first),he(n=fe())&&(a.uploaderEl=n.first)}},standalone:!0,features:[F],decls:17,vars:16,consts:[["droparea",""],["uploader",""],["icon","add_circle_outline"],["icon","file_upload"],["icon","create_new_folder"],["icon","delete",3,"disabled"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["icon","add_circle_outline",3,"click"],["icon","file_upload",3,"click"],["type","file","hidden","","multiple","",3,"change"],["icon","create_new_folder",3,"click"],["icon","delete",3,"click","disabled"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink","queryParams"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){if(e&1){let n=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Displays \xA0\xA0\xA0 "),g(3,kc,2,0,"ya-page-button",2)(4,Ac,4,0,"ya-page-button",3)(5,Mc,2,0,"ya-page-button",4)(6,Rc,2,1,"ya-page-button",5),o(),l(7,"div",6,0),S(9,"async"),E("dragenter",function(c){return k(n),A(a.dragEnter(c))}),l(10,"div",7),S(11,"async"),E("dragover",function(c){return k(n),A(a.dragOver(c))})("dragleave",function(c){return k(n),A(a.dragLeave(c))})("drop",function(c){return k(n),A(a.drop(c))}),o(),l(12,"div",8),g(13,Oc,1,1),S(14,"async"),g(15,np,21,3,"table",9)(16,rp,2,0,"ya-empty-message"),o()()()}if(e&2){let n;p(3),x(a.mayManageDisplays()?3:-1),p(),x(a.mayManageDisplays()?4:-1),p(),x(a.mayManageDisplays()?5:-1),p(),x(a.mayManageDisplays()?6:-1),p(),me("active",T(9,10,a.dragActive$)),p(3),me("hide",!T(11,12,a.dragActive$)),p(3),x((n=T(14,14,a.breadcrumb$))?13:-1,n),p(2),x(a.dataSource&&a.dataSource.data.length?15:16)}},dependencies:[Hn,et,Je,Y,ee,Ie,ci,Lt,li,si,zi,wt,Wt,ut,Ye,_t,ot,ft,Ge,Ue,ze,We,pn,cn,Xt,Vt,lt,Le,un],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0})}};var Un=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-display-page"]],standalone:!0,features:[F],decls:1,vars:0,template:function(e,a){e&1&&b(0,"router-outlet")},dependencies:[oi],encapsulation:2,changeDetection:0})}};var zn=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-displays-page"]],standalone:!0,features:[F],decls:1,vars:0,template:function(e,a){e&1&&b(0,"router-outlet")},dependencies:[oi],encapsulation:2,changeDetection:0})}};var Wn=class t{constructor(i){this.yamcs=i}transform(i){if(!i)return null;let e=this.yamcs.instance;return this.yamcs.yamcsClient.getPacketDownloadURL(e,i.id.name,i.generationTime,i.sequenceNumber)}static{this.\u0275fac=function(e){return new(e||t)(w(X,16))}}static{this.\u0275pipe=za({name:"packetDownloadLink",type:t,pure:!0,standalone:!0})}};var jn=class{constructor(){this.dirty=!1;this.archivePackets=[]}addArchiveData(i){this.archivePackets=this.archivePackets.concat(i),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}};var qn=class extends zt{constructor(e,a){super();this.yamcs=e;this.pageSize=100;this.blockHasMore=!1;this.packets$=new $([]);this.loading$=new $(!1);this.syncSubscription=a.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitPackets(),this.buffer.dirty=!1)}),this.buffer=new jn}connect(){return this.packets$}emitPackets(){this.packets$.next(this.buffer.snapshot())}loadEntries(e,a){return this.loading$.next(!0),this.loadPage(bt(tt({},a),{limit:this.pageSize})).then(n=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n),this.emitPackets()})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(e){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,bt(tt({},e),{fields:["id","generationTime","earthReceptionTime","receptionTime","sequenceNumber","link","size"]})).then(a=>(this.continuationToken=a.continuationToken,a.packet||[]))}loadMoreData(e){this.continuationToken&&this.loadPage(bt(tt({},e),{next:this.continuationToken,limit:this.pageSize})).then(a=>{this.buffer.addArchiveData(a),this.emitPackets()})}disconnect(){this.syncSubscription?.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}};function op(t,i){if(t&1&&(s(0),S(1,"deltaWith")),t&2){let e=h();L(" (",it(1,1,e.earthReceptionTime,e.generationTime),") ")}}function lp(t,i){if(t&1){let e=N();l(0,"ya-detail-toolbar"),s(1,"Packet Detail"),o(),l(2,"div",31)(3,"div",32),s(4,"Packet name"),o(),l(5,"div",33),s(6),o(),l(7,"div",32),s(8,"Generation time"),o(),l(9,"div",33),s(10),S(11,"datetime"),o(),l(12,"div",32),s(13,"Earth reception time"),o(),l(14,"div",33),s(15),S(16,"datetime"),g(17,op,2,4),o(),l(18,"div",32),s(19,"Reception time"),o(),l(20,"div",33),s(21),S(22,"datetime"),S(23,"deltaWith"),o(),l(24,"div",32),s(25,"Link"),o(),l(26,"div",33),s(27),o(),l(28,"div",32),s(29,"Size"),o(),l(30,"div",33),s(31),S(32,"formatBytes"),o(),l(33,"div",32),s(34," Data "),l(35,"ya-more",34)(36,"button",35),E("click",function(){let n=k(e),r=h();return A(r.copyHex(n))}),s(37,"Copy Hex"),o(),l(38,"button",35),E("click",function(){let n=k(e),r=h();return A(r.copyBinary(n))}),s(39,"Copy Binary"),o(),b(40,"mat-divider"),l(41,"ya-download-menu-item",4),S(42,"packetDownloadLink"),s(43," Download "),o()()(),l(44,"div",36),b(45,"app-hex",37,2),o()()}if(t&2){let e=i;p(6),L(" ",e.id.name," "),p(4),L(" ",T(11,10,e.generationTime)," "),p(5),L(" ",T(16,12,e.earthReceptionTime)||"-"," "),p(2),x(e.earthReceptionTime?17:-1),p(4),Ht(" ",T(22,14,e.receptionTime)," (",it(23,16,e.receptionTime,e.generationTime),") "),p(6),L(" ",e.link||"-"," "),p(4),L(" ",T(32,19,e.size)," "),p(10),C("link",T(42,21,e)),p(4),C("base64String",e.packet)}}function sp(t,i){t&1&&(l(0,"ya-detail-toolbar"),s(1,"Select a packet"),o())}function cp(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",38)(1,"ya-date-time-input",39),l(2,"ya-button",30),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3," Apply "),o()}if(t&2){let e=h();p(2),C("disabled",e.filterForm.invalid)}}function pp(t,i){if(t&1){let e=N();l(0,"ya-button",40),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function mp(t,i){t&1&&b(0,"ya-dots")}function dp(t,i){t&1&&(l(0,"th",41),s(1,"Packet name"),o())}function up(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.id.name," ")}}function hp(t,i){t&1&&(l(0,"th",41),s(1,"Generation time"),o())}function fp(t,i){if(t&1&&(l(0,"td",42),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.generationTime)," ")}}function _p(t,i){t&1&&(l(0,"th",41),s(1,"Seq"),o())}function gp(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e,a=i.$implicit;p(),L(" ",(e=a.sequenceNumber)!==null&&e!==void 0?e:"-"," ")}}function vp(t,i){t&1&&(l(0,"th",41),s(1,"Earth reception time"),o())}function yp(t,i){if(t&1&&(l(0,"td",42),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.earthReceptionTime)||"-"," ")}}function Cp(t,i){t&1&&(l(0,"th",41),s(1,"Reception time"),o())}function xp(t,i){if(t&1&&(l(0,"td",42),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.receptionTime)," ")}}function bp(t,i){t&1&&(l(0,"th",41),s(1,"Link"),o())}function Sp(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.link||"-"," ")}}function wp(t,i){t&1&&(l(0,"th",41),s(1,"Size"),o())}function Tp(t,i){if(t&1&&(l(0,"td",42),s(1),S(2,"formatBytes"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.size)," ")}}function Dp(t,i){t&1&&b(0,"th",43)}function Pp(t,i){if(t&1){let e=N();l(0,"td",42)(1,"ya-text-action",44),E("click",function(){let n=k(e).$implicit,r=h();return A(r.extractPacket(n))}),s(2,"Extract"),o(),l(3,"ya-more")(4,"button",35),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyHex(n))}),s(5,"Copy Hex"),o(),l(6,"button",35),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyBinary(n))}),s(7,"Copy Binary"),o(),b(8,"mat-divider"),l(9,"ya-download-menu-item",4),S(10,"packetDownloadLink"),s(11," Download "),o()()()}if(t&2){let e=i.$implicit;p(9),C("link",T(10,1,e))}}function Ep(t,i){t&1&&b(0,"tr",45)}function kp(t,i){if(t&1){let e=N();l(0,"tr",46),E("click",function(){let n=k(e).$implicit,r=h();return A(r.selectPacket(n))}),o()}if(t&2){let e=i.$implicit,a=h();me("selected",a.isSelected(e))}}var Ta="PT1H",Xn=class t{constructor(i,e,a,n,r,c,d){this.yamcs=i;this.router=e;this.route=a;this.clipboard=c;this.messageService=d;this.columns=[{id:"packetName",label:"Packet name",alwaysVisible:!0},{id:"generationTime",label:"Generation time",alwaysVisible:!0},{id:"earthReceptionTime",label:"Earth reception time",visible:!1},{id:"receptionTime",label:"Reception time",visible:!0},{id:"sequenceNumber",label:"Sequence number",visible:!1},{id:"link",label:"Link",visible:!0},{id:"size",label:"Size",visible:!0},{id:"actions",label:"",alwaysVisible:!0}];this.filterForm=new rt({name:new te("ANY"),link:new te("ANY"),interval:new te(Ta),customStart:new te(null),customStop:new te(null)});this.detailPacket$=new $(null);this.nameOptions$=new $([{id:"ANY",label:"Any name"}]);this.linkOptions$=new $([{id:"ANY",label:"Any link"}]);this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}];this.downloadURL$=new $(null);n.setTitle("Packets"),this.dataSource=new qn(this.yamcs,r),i.yamcsClient.getPacketNames(i.instance).then(m=>{for(let u of m.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:u,label:u}]);for(let u of m.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:u,label:u}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(m=>{this.name=m!=="ANY"?m:null,this.loadData()}),this.filterForm.get("link").valueChanges.forEach(m=>{this.link=m!=="ANY"?m:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(m=>{if(m==="CUSTOM"){let u=this.validStart||this.yamcs.getMissionTime(),v=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(u)),this.filterForm.get("customStop").setValue(B.toISOString(v))}else m==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=m,this.loadData()):(this.validStop=i.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,m),this.appliedInterval=m,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("name")&&(this.name=i.get("name")||"",this.filterForm.get("name").setValue(this.name)),i.has("link")&&(this.link=i.get("link")||"",this.filterForm.get("link").setValue(this.link)),i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Ta,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Ta)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(Ta):i==="CUSTOM"?this.filterForm.get("interval").setValue(Ta):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filterForm.value.customStart),this.validStop=B.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.name&&(i.name=this.name),this.link&&(i.link=this.link);let e={};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.name&&(e.name=this.name),this.link&&(e.link=this.link),this.dataSource.loadEntries("realtime",i).then(a=>{let n=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(n)})}loadMoreData(){let i={};this.validStart&&(i.start=this.validStart.toISOString()),this.name&&(i.name=this.name),this.link&&(i.link=this.link),this.dataSource.loadMoreData(i)}copyHex(i){this.fetchPacket(i).then(e=>{let a=B.convertBase64ToHex(e.packet??"");this.clipboard.copy(a)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}).catch(e=>this.messageService.showError(e))}copyBinary(i){this.fetchPacket(i).then(e=>{let a=window.atob(e.packet??"");this.clipboard.copy(a)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}).catch(e=>this.messageService.showError(e))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,link:this.link||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(i){this.fetchPacket(i).then(e=>{this.detailPacket$.next(e)}).catch(e=>this.messageService.showError(e))}fetchPacket(i){return this.yamcs.yamcsClient.getPacket(this.yamcs.instance,i.id.name,i.generationTime,i.sequenceNumber)}extractPacket(i){this.router.navigate(["/telemetry/packets"+i.id.name,"-","log",i.generationTime,i.sequenceNumber],{queryParams:{c:this.yamcs.context}})}isSelected(i){let e=this.detailPacket$.value;return e?i.id.name===e.id.name&&i.generationTime===e.generationTime&&i.sequenceNumber===e.sequenceNumber:!1}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Re),w(Te),w(nt),w(yt),w(Ui),w(Ke))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:65,vars:32,consts:[["exportMenu","matMenu"],["columnChooser",""],["hexdump",""],[1,"ya-menu"],[3,"link"],["icon","save_alt",3,"matMenuTriggerFor","disabled"],["matTooltip","Jump to now","icon","refresh",3,"click"],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["formControlName","link",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["preferenceKey","tmPackets",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","sequenceNumber"],["matColumnDef","earthReceptionTime"],["matColumnDef","receptionTime"],["matColumnDef","link"],["matColumnDef","size"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[3,"click","disabled"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block",2,"margin-top","4px"],[3,"base64String"],["formControlName","customStart"],["formControlName","customStop"],[3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["icon","output",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){if(e&1){let n=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Packets \xA0\xA0\xA0 "),l(3,"mat-menu",3,0)(5,"ya-download-menu-item",4),S(6,"async"),s(7,"Raw dump"),o()(),l(8,"ya-page-button",5),S(9,"async"),s(10," Export "),o(),l(11,"ya-page-icon-button",6),E("click",function(){return k(n),A(a.jumpToNow())}),o()(),l(12,"ya-detail-pane"),g(13,lp,47,23),S(14,"async"),g(15,sp,2,0,"ya-detail-toolbar"),o(),l(16,"div",7)(17,"div",8)(18,"form",9)(19,"div",10),b(20,"ya-select",11),S(21,"async"),b(22,"ya-select",12),S(23,"async"),b(24,"ya-select",13),g(25,cp,4,1)(26,pp,2,0,"ya-button"),b(27,"ya-column-chooser",14,1),g(29,mp,1,0,"ya-dots"),S(30,"async"),o()(),l(31,"table",15),G(32,16),g(33,dp,2,0,"th",17)(34,up,2,1,"td",18),U(),G(35,19),g(36,hp,2,0,"th",17)(37,fp,3,3,"td",18),U(),G(38,20),g(39,_p,2,0,"th",17)(40,gp,2,1,"td",18),U(),G(41,21),g(42,vp,2,0,"th",17)(43,yp,3,3,"td",18),U(),G(44,22),g(45,Cp,2,0,"th",17)(46,xp,3,3,"td",18),U(),G(47,23),g(48,bp,2,0,"th",17)(49,Sp,2,1,"td",18),U(),G(50,24),g(51,wp,2,0,"th",17)(52,Tp,3,3,"td",18),U(),G(53,25),g(54,Dp,1,0,"th",26)(55,Pp,12,3,"td",18),U(),g(56,Ep,1,0,"tr",27),S(57,"async"),g(58,kp,1,2,"tr",28),S(59,"async"),o(),l(60,"mat-toolbar"),b(61,"span",29),l(62,"ya-button",30),E("click",function(){return k(n),A(a.loadMoreData())}),s(63,"Load more"),o(),b(64,"span",29),o()()()()}if(e&2){let n,r,c=le(4),d=le(28);p(5),C("link",T(6,16,a.downloadURL$)),p(3),C("matMenuTriggerFor",c)("disabled",!((n=T(9,18,a.dataSource.packets$))!=null&&n.length)),p(5),x((r=T(14,20,a.detailPacket$))?13:15,r),p(5),C("formGroup",a.filterForm),p(2),C("options",T(21,22,a.nameOptions$)),p(2),C("options",T(23,24,a.linkOptions$)),p(2),C("options",a.intervalOptions),p(),x(a.filterForm.value.interval==="CUSTOM"?25:-1),p(),x(a.filterForm.value.interval!=="CUSTOM"?26:-1),p(),C("columns",a.columns),p(2),x(T(30,26,a.dataSource.loading$)?29:-1),p(2),C("dataSource",a.dataSource),p(25),C("matHeaderRowDef",T(57,28,d.displayedColumns$)),p(2),C("matRowDefColumns",T(59,30,d.displayedColumns$)),p(4),C("disabled",!a.dataSource.hasMore())}},dependencies:[Qi,et,Je,Wn,Y,ee,De,de,be,Se,Pe,Wt,$i,ut,Hi,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,Gi,Yi,ge,jt,vt,ji,qi,qt,Zo,Vt,lt,Kt,Dt,Qt,Le,tl,nl],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}"],changeDetection:0})}};var Ap=["hex"],Da=t=>({c:t}),Kr=()=>[];function Mp(t,i){if(t&1&&(l(0,"tr")(1,"td",42)(2,"mat-icon",43),s(3,"warning"),o()(),l(4,"td",44),s(5),o()()),t&2){let e=i.$implicit;p(5),q(e)}}function Rp(t,i){if(t&1&&(l(0,"h4"),s(1,"Warnings"),o(),l(2,"table",40),re(3,Mp,6,1,"tr",null,ne),S(5,"async"),o(),l(6,"div",41),b(7,"mat-divider"),o()),t&2){let e=h(2);p(3),oe(T(5,0,e.messages$))}}function Ip(t,i){t&1&&b(0,"th",45)}function Lp(t,i){if(t&1&&b(0,"ya-icon-action",47),t&2){let e=h().$implicit;C("icon",e.expanded?"expand_more":"chevron_right")("padding",!1)}}function Op(t,i){if(t&1&&(l(0,"td",46),g(1,Lp,1,2,"ya-icon-action",47),o()),t&2){let e=i.$implicit;p(),x(e.type==="CONTAINER"?1:-1)}}function Vp(t,i){t&1&&(l(0,"th",48),s(1,"Loc"),o())}function Np(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.location," ")}}function Fp(t,i){if(t&1&&(l(0,"td",49),g(1,Np,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Bp(t,i){t&1&&(l(0,"th",45),s(1,"Bits"),o())}function $p(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.size," ")}}function Hp(t,i){if(t&1&&(l(0,"td",50),g(1,$p,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Yp(t,i){t&1&&b(0,"th",51)}function Gp(t,i){if(t&1&&b(0,"ya-icon-action",53),t&2){let e=h().$implicit;C("icon",e.expanded?"expand_more":"chevron_right")}}function Up(t,i){if(t&1&&(l(0,"td",52),g(1,Gp,1,1,"ya-icon-action",53),o()),t&2){let e=i.$implicit;p(),x(e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function zp(t,i){t&1&&(l(0,"th",54),s(1,"Entry"),o())}function Wp(t,i){if(t&1&&(l(0,"a",56),s(1),o()),t&2){let e=h().$implicit,a=h(2);C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Z(3,Da,a.yamcs.context)),p(),L(" ",e.parameter.qualifiedName," ")}}function jp(t,i){t&1&&(l(0,"mat-icon",57),s(1,"chevron_right"),o())}function qp(t,i){if(t&1&&(re(0,jp,2,0,"mat-icon",57,ne),l(2,"a",56),s(3),o()),t&2){let e=h().$implicit,a=h(2);oe(Li(3,Kr).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Z(4,Da,a.yamcs.context)),p(),L(" ",e.name," ")}}function Xp(t,i){if(t&1&&(l(0,"mat-icon",43),s(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;St("visibility",e===a-1?"visible":"hidden"),p(),L(" ",n.expanded?"expand_more":"chevron_right"," ")}}function Zp(t,i){if(t&1&&(re(0,Xp,2,3,"mat-icon",58,ne),l(2,"a",56),s(3),o()),t&2){let e=h().$implicit,a=h(2);oe(Li(3,Kr).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Z(4,Da,a.yamcs.context)),p(),L(" ",e.name," ")}}function Qp(t,i){if(t&1&&(l(0,"mat-icon",43),s(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;St("visibility",e===a-1?"visible":"hidden"),p(),L(" ",n.expanded?"expand_more":"chevron_right"," ")}}function Kp(t,i){if(t&1&&(re(0,Qp,2,3,"mat-icon",58,ne),l(2,"a",56),s(3),o()),t&2){let e=h().$implicit,a=h(2);oe(Li(3,Kr).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Z(4,Da,a.yamcs.context)),p(),L(" ",e.name," ")}}function Jp(t,i){if(t&1&&(l(0,"td",55),g(1,Wp,2,5,"a",56)(2,qp,4,6,"a",56)(3,Zp,4,6,"a",56)(4,Kp,4,6,"a",56),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1),p(),x(e.type==="SIMPLE_VALUE"?2:-1),p(),x(e.type==="AGGREGATE_VALUE"?3:-1),p(),x(e.type==="ARRAY_VALUE"?4:-1)}}function em(t,i){t&1&&(l(0,"th",59),s(1,"Type"),o())}function tm(t,i){t&1&&s(0," container ")}function im(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.type.engType," ")}}function am(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.type.engType," ")}}function nm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit,a=h(2);L(" ",a.fillTypeWithValueDimension(e.parameter.type.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function rm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameterType.engType," ")}}function om(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameterType.engType," ")}}function lm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit,a=h(2);L(" ",a.fillTypeWithValueDimension(e.parameterType.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function sm(t,i){if(t&1&&(l(0,"td",60),g(1,tm,1,0)(2,im,1,1)(3,am,1,1)(4,nm,1,1)(5,rm,1,1)(6,om,1,1)(7,lm,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="CONTAINER"?1:-1),p(),x(e.type==="SIMPLE_PARAMETER"?2:-1),p(),x(e.type==="AGGREGATE_PARAMETER"?3:-1),p(),x(e.type==="ARRAY_PARAMETER"?4:-1),p(),x(e.type==="SIMPLE_VALUE"?5:-1),p(),x(e.type==="AGGREGATE_VALUE"?6:-1),p(),x(e.type==="ARRAY_VALUE"?7:-1)}}function cm(t,i){t&1&&(l(0,"th",59),s(1,"Raw value"),o())}function pm(t,i){if(t&1&&b(0,"ya-value",62),t&2){let e=h();C("value",e)}}function mm(t,i){if(t&1&&b(0,"ya-value",62),t&2){let e=h();C("value",e)}}function dm(t,i){if(t&1&&g(0,pm,1,1,"ya-value",62)(1,mm,1,1,"ya-value",62),t&2){let e=h().$implicit;x(e.type==="SIMPLE_PARAMETER"?0:-1),p(),x(e.type==="SIMPLE_VALUE"?1:-1)}}function um(t,i){if(t&1&&(l(0,"td",61),g(1,dm,2,2),o()),t&2){let e,a=i.$implicit;p(),x((e=a.rawValue)?1:-1,e)}}function hm(t,i){t&1&&(l(0,"th",59),s(1,"Engineering value"),o())}function fm(t,i){t&1&&(s(0),S(1,"units")),t&2&&L(" ",T(1,1,i)," ")}function _m(t,i){if(t&1&&(b(0,"ya-value",62),g(1,fm,2,3)),t&2){let e,a=h(),n=h().$implicit;C("value",a),p(),x((e=n.parameter.type==null?null:n.parameter.type.unitSet)?1:-1,e)}}function gm(t,i){t&1&&(s(0),S(1,"units")),t&2&&L(" ",T(1,1,i)," ")}function vm(t,i){if(t&1&&(b(0,"ya-value",62),g(1,gm,2,3)),t&2){let e,a=h(),n=h().$implicit;C("value",a),p(),x((e=n.parameterType.unitSet)?1:-1,e)}}function ym(t,i){if(t&1&&g(0,_m,2,2)(1,vm,2,2),t&2){let e=h().$implicit;x(e.type==="SIMPLE_PARAMETER"?0:-1),p(),x(e.type==="SIMPLE_VALUE"?1:-1)}}function Cm(t,i){if(t&1&&(l(0,"td",61),g(1,ym,2,2),o()),t&2){let e,a=i.$implicit;p(),x((e=a.engValue)?1:-1,e)}}function xm(t,i){t&1&&b(0,"th",63)}function bm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.container.qualifiedName," ")}}function Sm(t,i){if(t&1&&(l(0,"td",64),g(1,bm,1,1),o()),t&2){let e=i.$implicit;Lo("colspan",4),p(),x(e.type==="CONTAINER"?1:-1)}}function wm(t,i){t&1&&b(0,"th",65)}function Tm(t,i){if(t&1){let e=N();l(0,"ya-more",67)(1,"button",5),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.selectBitRange(n))}),s(2,"Select in hex view"),o()()}t&2&&C("padding",!1)}function Dm(t,i){if(t&1&&(l(0,"td",66),g(1,Tm,3,1,"ya-more",67),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Pm(t,i){t&1&&b(0,"tr",68)}function Em(t,i){if(t&1){let e=N();l(0,"tr",69),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}}function km(t,i){if(t&1){let e=N();l(0,"tr",70),E("mouseover",function(){let n=k(e).$implicit,r=h(2);return A(r.highlightBitRange(n))})("mouseout",function(){k(e);let n=h(2);return A(n.clearHighlightedBitRange())})("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);me("expandable",a.isExpandable(e))}}function Am(t,i){if(t&1){let e=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",1),s(3),l(4,"ya-page-button",2),E("click",function(){k(e);let n=h();return A(n.expandAll())}),s(5,"Expand all"),o(),l(6,"ya-page-button",3),E("click",function(){k(e);let n=h();return A(n.collapseAll())}),s(7,"Collapse all"),o()(),l(8,"ya-detail-pane")(9,"ya-detail-toolbar"),s(10," Hex view "),b(11,"span",4),l(12,"ya-more")(13,"button",5),E("click",function(){let n=k(e),r=h();return A(r.copyHex(n.packet))}),s(14,"Copy Hex"),o(),l(15,"button",5),E("click",function(){let n=k(e),r=h();return A(r.copyBinary(n.packet))}),s(16,"Copy Binary"),o()()(),l(17,"div",6),b(18,"app-hex",7,0),o()(),l(20,"div",8)(21,"div",9),g(22,Rp,8,2),S(23,"async"),l(24,"table",10),G(25,11),g(26,Ip,1,0,"th",12)(27,Op,2,1,"td",13),U(),G(28,14),g(29,Vp,2,0,"th",15)(30,Fp,2,1,"td",16),U(),G(31,17),g(32,Bp,2,0,"th",12)(33,Hp,2,1,"td",18),U(),G(34,19),g(35,Yp,1,0,"th",20)(36,Up,2,1,"td",21),U(),G(37,22),g(38,zp,2,0,"th",23)(39,Jp,5,4,"td",24),U(),G(40,25),g(41,em,2,0,"th",26)(42,sm,8,7,"td",27),U(),G(43,28),g(44,cm,2,0,"th",26)(45,um,2,1,"td",29),U(),G(46,30),g(47,hm,2,0,"th",26)(48,Cm,2,1,"td",29),U(),G(49,31),g(50,xm,1,0,"th",32)(51,Sm,2,2,"td",33),U(),G(52,34),g(53,wm,1,0,"th",35)(54,Dm,2,1,"td",36),U(),g(55,Pm,1,0,"tr",37)(56,Em,1,0,"tr",38)(57,km,1,2,"tr",39),o()()()()}if(t&2){let e,a=i,n=h();p(2),C("queryParams",Z(14,Da,n.yamcs.context)),p(),Vo(" ",a.id.name," / ",a.generationTime," / ",a.sequenceNumber," \xA0\xA0\xA0 "),p(15),C("base64String",a.packet),p(4),x((e=T(23,12,n.messages$))!=null&&e.length?22:-1),p(2),C("dataSource",n.dataSource),p(31),C("matHeaderRowDef",n.displayedColumns),p(),C("matRowDefColumns",n.containerColumns)("matRowDefWhen",n.isContainer),p(),C("matRowDefColumns",n.displayedColumns)("matRowDefWhen",n.isNoContainer)}}var Zn=class t{constructor(i,e,a,n,r,c){this.title=i;this.route=e;this.yamcs=a;this.messageService=n;this.clipboard=r;this.changeDetection=c;this.packetName=Rt.required({alias:"packet"});this.packet$=new $(null);this.messages$=new $([]);this.allNodes=[];this.dataSource=new Ot;this.displayedColumns=["icon","location","size","expand-aggray","entry","type","rawValue","engValue","actions"];this.containerColumns=["icon","containerName","type","rawValue","engValue","actions"];this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}]}ngOnInit(){let i=this.packetName(),e=this.route.snapshot.paramMap.get("gentime"),a=Number(this.route.snapshot.paramMap.get("seqno"));this.title.setTitle(i),this.yamcs.yamcsClient.getPacket(this.yamcs.instance,i,e,a).then(n=>this.packet$.next(n)).catch(n=>this.messageService.showError(n)),this.yamcs.yamcsClient.extractPacket(this.yamcs.instance,i,e,a).then(n=>this.processResponse(n)).catch(n=>this.messageService.showError(n))}processResponse(i){this.messages$.next(i.messages||[]);let e;for(let a of i.parameterValues||[]){if(a.entryContainer.qualifiedName!==e?.container.qualifiedName){let n={type:"CONTAINER",container:a.entryContainer,expanded:!1};this.allNodes.push(n),e=n}this.addParameterNodes(e,a,this.allNodes)}e&&(e.expanded=!0),this.updateDataSource()}addParameterNodes(i,e,a){let{parameter:n,location:r,rawValue:c,engValue:d,size:m}=e;if(n.type?.engType.endsWith("[]")){let u={type:"ARRAY_PARAMETER",parent:i,expanded:!1,parameter:n,location:r,rawValue:c,engValue:d,size:m};a.push(u);let v=c?.arrayValue||[],f=d?.arrayValue||[],y=n.type.arrayInfo.type;for(let _=0;_<f.length;_++)this.addValueNode(u,n,y,"["+_+"]","["+_+"]",1,v[_],f[_],a)}else if(n.type?.engType==="aggregate"){let u={type:"AGGREGATE_PARAMETER",parent:i,expanded:!1,parameter:n,location:r,rawValue:c,engValue:d,size:m};a.push(u);let v=c.aggregateValue,f=d.aggregateValue;for(let y=0;y<f.name.length;y++){let _=n.type.member[y].type;this.addValueNode(u,n,_,f.name[y],"."+f.name[y],1,v.value[y],f.value[y],a)}}else a.push({type:"SIMPLE_PARAMETER",parent:i,expanded:!1,parameter:n,location:r,rawValue:c,engValue:d,size:m})}addValueNode(i,e,a,n,r,c,d,m,u){if(a.engType.endsWith("[]")){let v={type:"ARRAY_VALUE",parent:i,expanded:!1,parameter:e,parameterType:a,name:n,offset:r,rawValue:d,engValue:m,depth:c};u.push(v);let f=d?.arrayValue||[],y=m?.arrayValue||[];for(let _=0;_<y.length;_++)this.addValueNode(v,e,a.arrayInfo.type,"["+_+"]",r+"["+_+"]",c+1,f[_],y[_],u)}else if(a.engType==="aggregate"){let v={type:"AGGREGATE_VALUE",parent:i,expanded:!1,parameter:e,parameterType:a,name:n,offset:r,rawValue:d,engValue:m,depth:c};u.push(v);let f=d.aggregateValue,y=m.aggregateValue;for(let _=0;_<y.name.length;_++){let D=a.member[_].type;this.addValueNode(v,e,D,y.name[_],r+"."+y.name[_],c+1,f.value[_],y.value[_],u)}}else u.push({type:"SIMPLE_VALUE",parent:i,expanded:!1,parameter:e,parameterType:a,name:n,offset:r,rawValue:d,engValue:m,depth:c})}get hex(){return this._hex}set hex(i){this._hex=i}highlightBitRange(i){(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER")&&this.hex?.setHighlight(new qr(i.location,i.size))}clearHighlightedBitRange(){this.hex?.setHighlight(null)}selectBitRange(i){(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER")&&this.hex?.setSelection(new qr(i.location,i.size))}toggleRow(i){this.isExpandable(i)&&(i.expanded?this.collapseNode(i):i.expanded=!0),this.updateDataSource()}collapseNode(i){for(let e of this.allNodes)e.parent===i&&this.collapseNode(e);i.expanded=!1,this.updateDataSource()}expandAll(){for(let i of this.allNodes)this.isExpandable(i)&&(i.expanded=!0);this.updateDataSource()}collapseAll(){for(let i of this.allNodes)i.expanded=!1;this.updateDataSource()}isExpandable(i){return i.type==="CONTAINER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"||i.type==="AGGREGATE_VALUE"||i.type==="ARRAY_VALUE"}updateDataSource(){let i=[];for(let e of this.allNodes)(!e.parent||e.parent?.expanded)&&i.push(e);this.dataSource.data=i}isContainer(i,e){return e.type==="CONTAINER"}isNoContainer(i,e){return e.type!=="CONTAINER"}copyHex(i){let e=B.convertBase64ToHex(i);this.clipboard.copy(e)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}copyBinary(i){let e=window.atob(i);this.clipboard.copy(e)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}fillTypeWithValueDimension(i,e){if(i.endsWith("[]")){let a=e?.length||0;i=i.substring(0,i.length-2)+"["+a+"]"}return i.replaceAll("[]","[?]")}static{this.\u0275fac=function(e){return new(e||t)(w(nt),w(Te),w(X),w(Ke),w(Ui),w(It))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&_e(Ap,5),e&2){let n;he(n=fe())&&(a.hex=n.first)}},inputs:{packetName:[1,"packet","packetName"]},standalone:!0,features:[F],decls:2,vars:3,consts:[["hex",""],["routerLink","/telemetry/packets","icon","arrow_back",3,"queryParams"],["icon","unfold_more",3,"click"],["icon","unfold_less",3,"click"],[2,"flex","1 1 auto"],["mat-menu-item","",3,"click"],[2,"padding","0 16px"],[3,"base64String"],[1,"table-wrapper"],[1,"panel-content"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop",4,"matCellDef"],["matColumnDef","location"],["mat-header-cell","","class","no-left-padding","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop right no-left-padding",4,"matCellDef"],["matColumnDef","size"],["mat-cell","","class","vtop right",4,"matCellDef"],["matColumnDef","expand-aggray"],["mat-header-cell","","width","1","class","icon",4,"matHeaderCellDef"],["mat-cell","","class","icon vtop",4,"matCellDef"],["matColumnDef","entry"],["mat-header-cell","","class","entry",4,"matHeaderCellDef"],["mat-cell","","class","entry vtop",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","mono vtop",4,"matCellDef"],["matColumnDef","rawValue"],["mat-cell","","class","vtop wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","containerName"],["mat-header-cell","","class","no-left-padding",4,"matHeaderCellDef"],["mat-cell","","class","no-left-padding",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","","class","icon",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","expandable container",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-row","",3,"expandable","mouseover","mouseout","click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["yaDataTable","",1,"expand"],[1,"section-divider"],[1,"iconcol"],[1,"icon12"],[1,"expand"],["mat-header-cell","","width","1"],["mat-cell","",1,"vtop"],[3,"icon","padding"],["mat-header-cell","","width","1",1,"no-left-padding"],["mat-cell","",1,"vtop","right","no-left-padding"],["mat-cell","",1,"vtop","right"],["mat-header-cell","","width","1",1,"icon"],["mat-cell","",1,"icon","vtop"],[3,"icon"],["mat-header-cell","",1,"entry"],["mat-cell","",1,"entry","vtop"],[1,"ya-link",3,"routerLink","queryParams"],[1,"icon12",2,"visibility","hidden"],[1,"icon12",3,"visibility"],["mat-header-cell",""],["mat-cell","",1,"mono","vtop"],["mat-cell","",1,"vtop","wrap200"],[3,"value"],["mat-header-cell","",1,"no-left-padding"],["mat-cell","",1,"no-left-padding"],["mat-header-cell","",1,"expand"],["mat-cell","",1,"icon"],[3,"padding"],["mat-header-row",""],["mat-row","",1,"expandable","container",3,"click"],["mat-row","",3,"mouseover","mouseout","click"]],template:function(e,a){if(e&1&&(g(0,Am,58,16,"app-instance-page"),S(1,"async")),e&2){let n;x((n=T(1,1,a.packet$))?0:-1,n)}},dependencies:[Qi,et,Je,Y,ee,Ie,mi,wt,Wt,ut,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,ji,qi,pi,Vt,lt,Kt,Xi,Jt],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f0f0f0}tr.container[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f0f0f0!important}tr.expandable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}td.vtop[_ngcontent-%COMP%]{vertical-align:top}td.icon[_ngcontent-%COMP%]{padding:0;line-height:25px;text-align:right}th.entry[_ngcontent-%COMP%], td.entry[_ngcontent-%COMP%]{padding-left:7px}td.right[_ngcontent-%COMP%]{text-align:right}th.no-left-padding[_ngcontent-%COMP%], td.no-left-padding[_ngcontent-%COMP%]{padding-left:5px}.icon12[_ngcontent-%COMP%]{vertical-align:middle}"],changeDetection:0})}};var Mm=t=>({c:t});function Rm(t,i){t&1&&(l(0,"tr")(1,"td",10),s(2,"No rows to display"),o()())}function Im(t,i){if(t&1){let e=N();l(0,"tr")(1,"td"),s(2),o(),l(3,"td",11)(4,"ya-icon-action",12),E("click",function(n){let r=k(e).$index;return h(2).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",13),E("click",function(n){let r=k(e).$index;return h(2).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",14),E("click",function(){let n=k(e).$index,r=h(2);return A(r.deletePattern(n))}),s(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;p(2),q(e)}}function Lm(t,i){if(t&1&&(l(0,"table",6)(1,"tr")(2,"th"),s(3,"Pattern"),o(),b(4,"th"),o(),g(5,Rm,3,0,"tr"),re(6,Im,8,1,"tr",null,ne),o()),t&2){let e=i;p(5),x(e.length?-1:5),p(),oe(e)}}var Qn=class t{constructor(i,e,a,n,r,c,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=c;this.messageService=d;this.location=m;this.patterns$=new $([]);e.setTitle("Create a Parameter List"),this.form=i.group({name:new te("",[Ee.required]),description:new te})}showAddPatternDialog(){this.dialog.open(ti,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&this.patterns$.next([...this.patterns$.value,e])})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value])}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value])}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value])}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patterns:[...this.patterns$.value]};this.yamcs.yamcsClient.createParameterList(this.yamcs.instance,i).then(()=>this.router.navigate([".."],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})).catch(e=>this.messageService.showError(e))}static{this.\u0275fac=function(e){return new(e||t)(w(Ut),w(nt),w(Re),w(Te),w(X),w(Fe),w(Ke),w(Xa))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:29,vars:8,consts:[["routerLink","..","icon","arrow_back",3,"queryParams"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle_outline",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",0),s(3," Create parameter list "),o(),l(4,"div",1)(5,"form",2)(6,"label"),s(7," Name "),b(8,"br")(9,"input",3),o(),b(10,"br"),l(11,"label"),s(12," Description "),b(13,"textarea",4),o()(),l(14,"p"),s(15,"\xA0"),o(),l(16,"ya-button",5),E("click",function(){return a.showAddPatternDialog()}),s(17," Add parameter or pattern "),o(),l(18,"p"),s(19,"\xA0"),o(),g(20,Lm,8,1,"table",6),S(21,"async"),l(22,"p"),s(23,"\xA0"),o(),l(24,"div",7)(25,"ya-button",8),E("click",function(){return a.location.back()}),s(26,"Cancel"),o(),l(27,"ya-button",9),E("click",function(){return a.onConfirm()}),s(28," CREATE "),o()()()()),e&2){let n;p(2),C("queryParams",Z(6,Mm,a.yamcs.context)),p(3),C("formGroup",a.form),p(15),x((n=T(21,4,a.patterns$))?20:-1,n),p(7),C("disabled",!a.form.valid)}},dependencies:[et,Je,Y,ee,De,Ze,de,be,Se,Pe,Ie,mi,ge,pi,Kt,Qt],encapsulation:2,changeDetection:0})}};function Om(t,i){t&1&&(l(0,"tr")(1,"td",9),s(2,"No rows to display"),o()())}function Vm(t,i){if(t&1){let e=N();l(0,"tr")(1,"td"),s(2),o(),l(3,"td",10)(4,"ya-icon-action",11),E("click",function(n){let r=k(e).$index;return h(3).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",12),E("click",function(n){let r=k(e).$index;return h(3).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",13),E("click",function(){let n=k(e).$index,r=h(3);return A(r.deletePattern(n))}),s(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;p(2),q(e)}}function Nm(t,i){if(t&1&&(l(0,"table",5)(1,"tr")(2,"th"),s(3,"Pattern"),o(),b(4,"th"),o(),g(5,Om,3,0,"tr"),re(6,Vm,8,1,"tr",null,ne),o()),t&2){let e=i;p(5),x(e.length?-1:5),p(),oe(e)}}function Fm(t,i){if(t&1){let e=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2),o(),l(3,"div",0)(4,"form",1)(5,"label"),s(6," Name "),b(7,"br")(8,"input",2),o(),b(9,"br"),l(10,"label"),s(11," Description "),b(12,"textarea",3),o()(),l(13,"p"),s(14,"\xA0"),o(),l(15,"ya-button",4),E("click",function(){k(e);let n=h();return A(n.showAddPatternDialog())}),s(16," Add parameter or pattern "),o(),l(17,"p"),s(18,"\xA0"),o(),g(19,Nm,8,1,"table",5),S(20,"async"),l(21,"p"),s(22,"\xA0"),o(),l(23,"div",6)(24,"ya-button",7),E("click",function(){k(e);let n=h();return A(n.location.back())}),s(25,"Cancel"),o(),l(26,"ya-button",8),S(27,"async"),E("click",function(){k(e);let n=h();return A(n.onConfirm())}),s(28," SAVE CHANGES "),o()()()()}if(t&2){let e,a=h();p(2),L("Edit list: ",i.name,""),p(2),C("formGroup",a.form),p(15),x((e=T(20,4,a.patterns$))?19:-1,e),p(7),C("disabled",!T(27,6,a.dirty$)||!a.form.valid)}}var Kn=class t{constructor(i,e,a,n,r,c,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=c;this.messageService=d;this.location=m;this.patterns$=new $([]);this.dirty$=new $(!1);e.setTitle("Edit Parameter List");let u=n.snapshot.paramMap.get("list");this.plist$=r.yamcsClient.getParameterList(r.instance,u),this.plist$.then(v=>{this.plist=v,this.form=i.group({name:new te(v.name,[Ee.required]),description:new te(v.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)}),this.patterns$.next(v.patterns||[])})}showAddPatternDialog(){this.dialog.open(ti,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&(this.patterns$.next([...this.patterns$.value,e]),this.dirty$.next(!0))})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patternDefinition:{patterns:[...this.patterns$.value]}};this.yamcs.yamcsClient.updateParameterList(this.yamcs.instance,this.plist.id,i).then(()=>this.router.navigateByUrl(`/telemetry/parameter-lists/${this.plist.id}?c=${this.yamcs.context}`)).catch(e=>this.messageService.showError(e))}ngOnDestroy(){this.formSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(Ut),w(nt),w(Re),w(Te),w(X),w(Fe),w(Ke),w(Xa))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:2,vars:3,consts:[[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle_outline",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(g(0,Fm,29,8,"app-instance-page"),S(1,"async")),e&2){let n;x((n=T(1,1,a.plist$))?0:-1,n)}},dependencies:[et,Je,Y,ee,De,Ze,de,be,Se,Pe,mi,ge,pi,Qt],encapsulation:2,changeDetection:0})}};function Bm(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",9)(1,"ya-date-time-input",10),l(2,"ya-button",11),E("click",function(){k(e);let n=h(2);return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h(2);p(2),C("disabled",e.filterForm.invalid)}}function $m(t,i){if(t&1){let e=N();l(0,"ya-button",12),E("click",function(){k(e);let n=h(2);return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function Hm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last hour"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),q(T(7,1,e.validStop))}}function Ym(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 6 hours"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),q(T(7,1,e.validStop))}}function Gm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 24 hours"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),q(T(7,1,e.validStop))}}function Um(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function zm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),S(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),S(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h(2);p(3),q(T(4,2,e.validStart)),p(4),q(T(8,4,e.validStop))}}function Wm(t,i){t&1&&(l(0,"th",22),s(1,"Generation time"),o())}function jm(t,i){if(t&1&&(l(0,"td",23),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.generationTime)," ")}}function qm(t,i){if(t&1&&(l(0,"th",22),s(1),o()),t&2){let e=h().$implicit;p(),q(e)}}function Xm(t,i){if(t&1&&(l(0,"td",23),s(1),o()),t&2){let e,a=i.$implicit,n=h().$index;p(),L(" ",(e=a.values[n])!==null&&e!==void 0?e:"-"," ")}}function Zm(t,i){if(t&1&&(G(0,17),g(1,qm,2,1,"th",15)(2,Xm,2,1,"td",16),U()),t&2){let e=i.$implicit;C("cdkColumnDef",e)}}function Qm(t,i){t&1&&b(0,"th",24)}function Km(t,i){t&1&&b(0,"td",23)}function Jm(t,i){t&1&&b(0,"tr",25)}function ed(t,i){t&1&&b(0,"tr",26)}function td(t,i){if(t&1&&(l(0,"div",8)(1,"table",13),G(2,14),g(3,Wm,2,0,"th",15)(4,jm,3,3,"td",16),U(),re(5,Zm,3,1,"ng-container",17,ne),G(7,18),g(8,Qm,1,0,"th",19)(9,Km,1,0,"td",16),U(),g(10,Jm,1,0,"tr",20),S(11,"async"),g(12,ed,1,0,"tr",21),S(13,"async"),o()()),t&2){let e=h(2);p(),C("dataSource",e.dataSource),p(4),oe(i.headers),p(5),C("matHeaderRowDef",T(11,4,e.displayedColumns$))("matHeaderRowDefSticky",!0),p(2),C("cdkRowDefColumns",T(13,6,e.displayedColumns$))}}function id(t,i){if(t&1){let e=N();l(0,"div",0)(1,"form",1)(2,"div",2),b(3,"ya-select",3),g(4,Bm,4,1)(5,$m,2,0,"ya-button"),b(6,"div",4),l(7,"ya-button",5),E("click",function(){k(e);let n=h();return A(n.exportParameterData())}),s(8," Export CSV "),o()()(),l(9,"div",6),b(10,"div",7),g(11,Hm,9,3,"span")(12,Ym,9,3,"span")(13,Gm,9,3,"span")(14,Um,4,0,"span")(15,zm,10,6,"span"),o(),g(16,td,14,8,"div",8),S(17,"async"),o()}if(t&2){let e,a,n=h();p(),C("formGroup",n.filterForm),p(2),C("options",n.intervalOptions),p(),x(n.filterForm.value.interval==="CUSTOM"?4:-1),p(),x(n.filterForm.value.interval!=="CUSTOM"?5:-1),p(6),x((e=n.appliedInterval)==="PT1H"?11:e==="PT6H"?12:e==="P1D"?13:e==="NO_LIMIT"?14:e==="CUSTOM"?15:-1),p(5),x((a=T(17,6,n.exportData$))?16:-1,a)}}var ta="PT1H",Jn=class t{constructor(i,e,a,n){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new rt({interval:new te(ta),customStart:new te(null),customStop:new te(null)});this.displayedColumns=["generationTime","actions"];this.displayedColumns$=new $(this.displayedColumns);this.plist$=new $(null);this.exportData$=new $(null);this.dataSource=new Ot;this.plistId=e.snapshot.paramMap.get("list"),this.validStop=a.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,ta),this.appliedInterval=ta,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(r=>{if(r==="CUSTOM"){let c=this.validStart||this.yamcs.getMissionTime(),d=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(c)),this.filterForm.get("customStop").setValue(B.toISOString(d))}else r==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=r,this.loadData()):(this.validStop=a.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,r),this.appliedInterval=r,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=ta,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,ta)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(ta):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filterForm.value.customStart),this.validStop=B.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={delimiter:"TAB",limit:100,order:"desc"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,this.plistId).then(e=>{this.plist$.next(e),e.match&&this.yamcs.yamcsClient.exportParameterValues(this.yamcs.instance,bt(tt({},i),{list:e.id})).then(a=>{let n=this.processCsv(a);this.exportData$.next(n),this.displayedColumns$.next(["generationTime",...n.headers,"actions"]),this.dataSource.data=n.records})})}processCsv(i){let e=[],a=i.split(/\r?\n/);for(let d=1;d<a.length;d++){let m=a[d];if(!m)continue;let u=m.split(/\t/),v={generationTime:u[0],values:[]};for(let f=1;f<u.length;f++)v.values[f-1]=u[f]||null;e.push(v)}return{headers:a[0].split(/\t/).slice(1).map(d=>B.getFilename(d)),records:e}}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){let i=this.plist$.value;if(i?.match){let a=i.name;this.validStart&&this.validStop?a+="_"+this.validStart.toISOString()+"_"+this.validStop.toISOString():this.validStart?a+="_"+this.validStart.toISOString():this.validStop&&(a+="_"+this.validStop.toISOString()),a+=".csv",this.dialog.open(ea,{width:"400px",data:{list:i.id,start:this.validStart,stop:this.validStop,filename:a}})}}static{this.\u0275fac=function(e){return new(e||t)(w(Re),w(Te),w(X),w(Fe))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:2,vars:3,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[2,"flex","1 1 auto"],["appearance","primary","icon","download",1,"no-margin",3,"click"],[1,"table-status"],[1,"toggles"],[1,"table-container"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime","sticky",""],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(g(0,id,18,8,"div",0),S(1,"async")),e&2){let n;x((n=T(1,1,a.plist$))?0:-1,n)}},dependencies:[Y,ee,De,de,be,Se,Pe,ci,Lt,li,si,Ye,gt,ot,Ge,Ue,ze,We,ge,vt,Dt,Le],styles:[".table-container[_ngcontent-%COMP%]{position:absolute;inset:96px 0 0;overflow:auto;margin-top:24px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;background-color:inherit;border-bottom:none}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background-color:var(--y-background-color);border-left:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}"],changeDetection:0})}};var Jr=t=>({c:t}),ad=t=>[t,"edit"];function nd(t,i){if(t&1&&(l(0,"ya-page-button",0),s(1," Create list "),o()),t&2){let e=h();C("queryParams",Z(1,Jr,e.yamcs.context))}}function rd(t,i){t&1&&(l(0,"th",14),s(1,"Name"),o())}function od(t,i){if(t&1&&(l(0,"td",15)(1,"a",16),s(2),o()()),t&2){let e=i.$implicit,a=h();p(),C("routerLink",e.id)("queryParams",Z(3,Jr,a.yamcs.context)),p(),q(e.name)}}function ld(t,i){t&1&&(l(0,"th",14),s(1,"Description"),o())}function sd(t,i){if(t&1&&(l(0,"td",17),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.description||"-"," ")}}function cd(t,i){t&1&&b(0,"th",18)}function pd(t,i){if(t&1){let e=N();l(0,"td",15)(1,"ya-more")(2,"a",19),s(3," Edit list "),o(),l(4,"button",20),E("click",function(){let n=k(e).$implicit,r=h();return A(r.deleteList(n))}),s(5,"Delete list"),o()()()}if(t&2){let e=i.$implicit,a=h();p(2),C("routerLink",Z(2,ad,e.id))("queryParams",Z(4,Jr,a.yamcs.context))}}function md(t,i){t&1&&b(0,"tr",21)}function dd(t,i){t&1&&b(0,"tr",22)}function ud(t,i){t&1&&(l(0,"ya-empty-message"),s(1,"No rows to display"),o())}var er=class t{constructor(i,e,a,n,r,c){this.yamcs=i;this.authService=e;this.route=n;this.router=r;this.messageService=c;this.filterControl=new te;this.displayedColumns=["name","description","actions"];this.dataSource=new Ot;a.setTitle("Parameter lists"),this.dataSource.filterPredicate=(d,m)=>d.name.toLowerCase().indexOf(m)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh()}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}refresh(){this.yamcs.yamcsClient.getParameterLists(this.yamcs.instance).then(i=>{this.dataSource.data=i}).catch(i=>this.messageService.showError(i))}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteList(i){confirm(`Are you sure you want to delete the list '${i.name}'`)&&this.yamcs.yamcsClient.deleteParameterList(this.yamcs.instance,i.id).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Ct),w(nt),w(Te),w(Re),w(Ke))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:20,vars:6,consts:[["routerLink","create","icon","add_circle_outline",3,"queryParams"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Filter lists",3,"formControl"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","vertical-align: top",4,"matCellDef"],["matColumnDef","description"],["mat-cell","","class","wrap400","style","white-space: pre-wrap",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",2,"vertical-align","top"],[3,"routerLink","queryParams"],["mat-cell","",1,"wrap400",2,"white-space","pre-wrap"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Parameter lists \xA0\xA0\xA0 "),g(3,nd,2,3,"ya-page-button",0),o(),l(4,"div",1)(5,"div",2),b(6,"ya-search-filter",3),o(),l(7,"table",4),G(8,5),g(9,rd,2,0,"th",6)(10,od,3,5,"td",7),U(),G(11,8),g(12,ld,2,0,"th",6)(13,sd,2,1,"td",9),U(),G(14,10),g(15,cd,1,0,"th",11)(16,pd,6,6,"td",7),U(),g(17,md,1,0,"tr",12)(18,dd,1,0,"tr",13),o(),g(19,ud,2,0,"ya-empty-message"),o()()),e&2&&(p(3),x(a.mayManageParameterLists()?3:-1),p(3),C("formControl",a.filterControl),p(),C("dataSource",a.dataSource),p(10),C("matHeaderRowDef",a.displayedColumns),p(),C("matRowDefColumns",a.displayedColumns),p(),x(a.dataSource.data.length?-1:19))},dependencies:[et,Je,Y,de,Gt,Ie,ut,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,Xt,Vt,lt,dn],encapsulation:2,changeDetection:0})}};var tr=class extends zt{constructor(e,a){super();this.yamcs=e;this.synchronizer=a;this.binaryPreview=16;this.items$=new $([]);this.totalSize$=new $(0);this.loading$=new $(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){return this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,e).then(a=>{this.totalSize$.next(a.totalSize);let n=[];for(let r of a.systems||[])n.push({name:r.qualifiedName,system:r});for(let r of a.parameters||[])n.push({name:B.getMemberPath(r),parameter:r});this.items$.next(n),this.startSubscription(a.parameters||[])}).finally(()=>this.loading$.next(!1))}refreshTable(){let e=this.items$.value;for(let a of e)a.system||(a.pval=this.latestValues.get(a.name));this.items$.next([...e])}startSubscription(e){let a=e.map(n=>({name:B.getMemberPath(n)}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),n.mapping&&this.refreshTable()}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}getAliasNamespaces(){let e=[];for(let a of this.items$.value)if(a.parameter?.alias)for(let n of a.parameter.alias)n.namespace&&e.indexOf(n.namespace)===-1&&e.push(n.namespace);return e.sort()}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var hd=["top"],bl=t=>({c:t}),fd=(t,i)=>({c:t,system:i}),Sl=t=>({maxBytes:t});function _d(t,i){if(t&1&&b(0,"ya-breadcrumb",30),t&2){let e=i.$implicit;C("link",e.route)("queryParams",e.queryParams)("label",e.name)}}function gd(t,i){if(t&1&&(l(0,"div",5)(1,"ya-breadcrumb-trail"),b(2,"ya-breadcrumb",29),re(3,_d,1,3,"ya-breadcrumb",30,ne),o()()),t&2){let e=h(),a=h();p(2),C("queryParams",Z(1,bl,a.yamcs.context)),p(),oe(e)}}function vd(t,i){t&1&&g(0,gd,5,3,"div",5),t&2&&x(i.length?0:-1)}function yd(t,i){t&1&&b(0,"ya-dots")}function Cd(t,i){t&1&&(l(0,"th",31),s(1,"Name"),o())}function xd(t,i){if(t&1&&(l(0,"mat-icon",33),s(1,"folder"),o(),l(2,"a",34),s(3),S(4,"filename"),o()),t&2){let e=h().$implicit,a=h();p(2),C("queryParams",_i(4,fd,a.yamcs.context,e.name)),p(),L(" ",T(4,2,e.name),"/ ")}}function bd(t,i){if(t&1&&b(0,"ya-highlight",36),t&2){let e=h(2).$implicit,a=h();C("text",e.name)("term",a.filterForm.value.filter)}}function Sd(t,i){if(t&1&&(b(0,"ya-highlight",36),S(1,"slice")),t&2){let e=h(2).$implicit,a=h();C("text",it(1,2,e.name,i.length+1))("term",a.filterForm.value.filter)}}function wd(t,i){if(t&1&&(l(0,"mat-icon",33),s(1,"toll"),o(),l(2,"a",35),g(3,bd,1,2,"ya-highlight",36),S(4,"async"),g(5,Sd,2,5,"ya-highlight",36),S(6,"async"),o()),t&2){let e,a=h().$implicit,n=h();p(2),C("routerLink","/telemetry/parameters"+a.name)("queryParams",Z(8,bl,n.yamcs.context)),p(),x(T(4,4,n.system$)?-1:3),p(2),x((e=T(6,6,n.system$))?5:-1,e)}}function Td(t,i){if(t&1&&(l(0,"td",32),g(1,xd,5,7)(2,wd,7,10),o()),t&2){let e=i.$implicit;p(),x(e.system?1:-1),p(),x(e.system?-1:2)}}function Dd(t,i){t&1&&(l(0,"th",37),s(1,"Raw value"),o())}function Pd(t,i){if(t&1&&(l(0,"td",38),s(1),S(2,"value"),o()),t&2){let e=i.$implicit,a=h();p(),L(" ",it(2,1,e.pval==null?null:e.pval.rawValue,Z(4,Sl,a.dataSource.binaryPreview))||"-"," ")}}function Ed(t,i){t&1&&(l(0,"th",37),s(1,"Value"),o())}function kd(t,i){if(t&1&&(l(0,"span"),s(1),S(2,"parameterTypeForPath"),S(3,"units"),o()),t&2){let e,a=h(2).$implicit;p(),L(" ",T(3,3,(e=T(2,1,a.parameter))==null?null:e.unitSet)," ")}}function Ad(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Md(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function Rd(t,i){if(t&1&&(l(0,"ya-expirable",39),s(1),S(2,"value"),g(3,kd,4,5,"span")(4,Ad,2,0,"span")(5,Md,2,0,"span"),o()),t&2){let e=h().$implicit,a=h();C("pval",e.pval),p(),L(" ",it(2,5,e.pval==null?null:e.pval.engValue,Z(8,Sl,a.dataSource.binaryPreview))||"-"," "),p(2),x(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function Id(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Ld(t,i){if(t&1&&(l(0,"td",38),g(1,Rd,6,10,"ya-expirable",39)(2,Id,2,0,"span"),o()),t&2){let e=i.$implicit;me("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),p(),x(e.pval?1:-1),p(),x(e.pval?-1:2)}}function Od(t,i){t&1&&(l(0,"th",31),s(1,"Type"),o())}function Vd(t,i){t&1&&(l(0,"span",40),s(1),o()),t&2&&(p(),L(" ",i," "))}function Nd(t,i){t&1&&s(0," - ")}function Fd(t,i){if(t&1&&(l(0,"td",38),g(1,Vd,2,1,"span",40),S(2,"parameterTypeForPath"),g(3,Nd,1,0),o()),t&2){let e,a=i.$implicit;p(),x((e=(e=T(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function Bd(t,i){t&1&&(l(0,"th",31),s(1,"Data source"),o())}function $d(t,i){if(t&1&&(l(0,"td",38),s(1),S(2,"titlecase"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function Hd(t,i){t&1&&(l(0,"th",37),s(1,"Description"),o())}function Yd(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.system.shortDescription||"-"," ")}}function Gd(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.shortDescription||"-"," ")}}function Ud(t,i){if(t&1&&(l(0,"td",38),g(1,Yd,1,1)(2,Gd,1,1),o()),t&2){let e=i.$implicit;p(),x(e.system?1:-1),p(),x(e.parameter?2:-1)}}function zd(t,i){if(t&1&&(l(0,"th",31),s(1),o()),t&2){let e=h().$implicit;p(),L(" ",e.label," ")}}function Wd(t,i){if(t&1&&b(0,"ya-highlight",36),t&2){let e=h(3);C("text",i)("term",e.filterForm.value.filter)}}function jd(t,i){t&1&&s(0," - ")}function qd(t,i){if(t&1&&(l(0,"td",38),g(1,Wd,1,2,"ya-highlight",36),S(2,"alias"),g(3,jd,1,0),o()),t&2){let e,a=i.$implicit,n=h().$implicit;p(),x((e=it(2,1,a.parameter,n.id))?1:3,e)}}function Xd(t,i){if(t&1&&(G(0,23),g(1,zd,2,1,"th",12)(2,qd,4,4,"td",20),U()),t&2){let e=i.$implicit;C("matColumnDef",e.id)}}function Zd(t,i){t&1&&b(0,"th",41)}function Qd(t,i){t&1&&b(0,"td",38)}function Kd(t,i){t&1&&b(0,"tr",42)}function Jd(t,i){if(t&1&&b(0,"tr",43),t&2){let e=i.$implicit,a=h();me("selected",a.selection.isSelected(e))}}function eu(t,i){if(t&1&&(l(0,"div",3),s(1," The Mission Database for "),l(2,"i"),s(3),o(),s(4," does not define any parameters. "),o()),t&2){let e=h();p(3),q(e.yamcs.instance)}}var eo=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],tu=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],iu=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],ir=class t{constructor(i,e,a,n){this.yamcs=i;this.route=e;this.router=a;this.synchronizer=n;this.filterForm=new rt({filter:new te,type:new te("ANY"),source:new te("ANY")});this.shortName=!1;this.pageSize=100;this.system=null;this.system$=new $(null);this.breadcrumb$=new $([]);this.columns=eo;this.typeOptions=tu;this.sourceOptions=iu;this.aliasColumns$=new $([]);this.selection=new Bi(!1);this.dataSource=new tr(this.yamcs,this.synchronizer)}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filter=i.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),i.has("type")&&(this.type=i.get("type"),this.filterForm.get("type").setValue(this.type)),i.has("source")&&(this.source=i.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(e=>{this.paginator.pageIndex=0,this.filter=e,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(e=>{this.type=e!=="ANY"?e:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(e=>{this.source=e!=="ANY"?e:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(e=>{e.get("system")!==this.system&&this.changeSystem(e)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(i){this.system=i.get("system"),this.updateBrowsePath(),i.has("page")?this.paginator.pageIndex=Number(i.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let i={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(i.q=this.filter,i.searchMembers=!0),this.type&&(i.type=this.type),this.source&&(i.source=this.source),this.dataSource.loadParameters(i).then(()=>{this.selection.clear(),this.updateBrowsePath(),this.system$.next(this.system);let e=[...this.columns];for(let n of this.aliasColumns$.value){let r=e.indexOf(n);r!==-1&&e.splice(r,1)}let a=[];for(let n of this.dataSource.getAliasNamespaces()){let r={id:n,label:n,alwaysVisible:!0};a.push(r)}e.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(e)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let i=[],e="";if(this.system)for(let a of this.system.slice(1).split("/"))e+="/"+a,i.push({name:a,route:"/telemetry/parameters",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(i)}selectNext(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.min(i.indexOf(a)+1,i.length-1))}this.selection.select(i[e])}selectPrevious(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.max(i.indexOf(a)-1,0))}this.selection.select(i[e])}applySelection(){if(this.selection.hasValue()){let i=this.selection.selected[0],e=this.dataSource.items$.value;i.parameter&&e.indexOf(i)!==-1&&this.router.navigate(["/telemetry/parameters"+i.parameter?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe(),this.dataSource.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Te),w(Re),w(yt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(_e(hd,7),_e(nn,7),_e(jt,5)),e&2){let n;he(n=fe())&&(a.top=n.first),he(n=fe())&&(a.paginator=n.first),he(n=fe())&&(a.columnChooser=n.first)}},standalone:!0,features:[F],decls:50,vars:26,consts:[["top",""],["columnChooser",""],["empty",""],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/telemetry/parameters",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1){let n=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2,"Parameters"),o(),b(3,"span",null,0),l(5,"div",3)(6,"form",4),g(7,vd,1,1),S(8,"async"),l(9,"div",5)(10,"ya-search-filter",6),E("onArrowDown",function(){return k(n),A(a.selectNext())})("onArrowUp",function(){return k(n),A(a.selectPrevious())})("onEnter",function(){return k(n),A(a.applySelection())}),o(),b(11,"ya-select",7)(12,"ya-select",8)(13,"ya-column-chooser",9,1),g(15,yd,1,0,"ya-dots"),S(16,"async"),o()(),l(17,"table",10),G(18,11),g(19,Cd,2,0,"th",12)(20,Td,3,2,"td",13),U(),G(21,14),g(22,Dd,2,0,"th",15)(23,Pd,3,6,"td",16),U(),G(24,17),g(25,Ed,2,0,"th",15)(26,Ld,3,4,"td",18),U(),G(27,19),g(28,Od,2,0,"th",12)(29,Fd,4,3,"td",20),U(),G(30,21),g(31,Bd,2,0,"th",12)(32,$d,3,3,"td",20),U(),G(33,22),g(34,Hd,2,0,"th",15)(35,Ud,3,2,"td",20),U(),re(36,Xd,3,1,"ng-container",23,ne),S(38,"async"),G(39,24),g(40,Zd,1,0,"th",25)(41,Qd,1,0,"td",20),U(),g(42,Kd,1,0,"tr",26),S(43,"async"),g(44,Jd,1,2,"tr",27),S(45,"async"),o(),b(46,"mat-paginator",28),S(47,"async"),o(),g(48,eu,5,1,"ng-template",null,2,gi),o()}if(e&2){let n,r=le(14);p(6),C("formGroup",a.filterForm),p(),x((n=T(8,14,a.breadcrumb$))?7:-1,n),p(3),C("formControl",a.filterForm.controls.filter),p(),C("options",a.typeOptions),p(),C("options",a.sourceOptions),p(),C("columns",a.columns),p(2),x(T(16,16,a.dataSource.loading$)?15:-1),p(2),C("dataSource",a.dataSource),p(19),oe(T(38,18,a.aliasColumns$)),p(6),C("matHeaderRowDef",T(43,20,r.displayedColumns$)),p(2),C("matRowDefColumns",T(45,22,r.displayedColumns$)),p(2),C("pageSize",a.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",T(47,24,a.dataSource.totalSize$))}},dependencies:[et,Je,Y,ee,$o,Oi,De,de,be,Gt,Se,Pe,Ie,Lt,wt,nn,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,pn,cn,jt,qt,Zt,Ko,dn,Dt,el,un,Zi,Jt,Nt],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0})}};var ar=class extends zt{constructor(e,a){super();this.yamcs=e;this.synchronizer=a;this.binaryPreview=16;this.items$=new $([]);this.totalSize$=new $(0);this.loading$=new $(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0);let a=[];for(let n of e)a.push({name:n.qualifiedName,parameter:n});this.items$.next(a),this.startSubscription(e||[])}refreshTable(){let e=this.items$.value;for(let a of e)a.pval=this.latestValues.get(a.name);this.items$.next([...e])}startSubscription(e){let a=e.map(n=>({name:n.qualifiedName}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),this.loading$.next(!1)}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var au=t=>({c:t}),wl=t=>({maxBytes:t});function nu(t,i){t&1&&b(0,"ya-dots")}function ru(t,i){t&1&&(l(0,"th",20),s(1,"Name"),o())}function ou(t,i){if(t&1&&(l(0,"td",21)(1,"a",22),s(2),o()()),t&2){let e=i.$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Z(3,au,a.yamcs.context)),p(),L(" ",e.name," ")}}function lu(t,i){t&1&&(l(0,"th",23),s(1,"Raw value"),o())}function su(t,i){if(t&1&&(l(0,"td",21),s(1),S(2,"value"),o()),t&2){let e=i.$implicit,a=h(2);p(),L(" ",it(2,1,e.pval==null?null:e.pval.rawValue,Z(4,wl,a.dataSource.binaryPreview))||"-"," ")}}function cu(t,i){t&1&&(l(0,"th",23),s(1,"Value"),o())}function pu(t,i){if(t&1&&(l(0,"span"),s(1),S(2,"parameterTypeForPath"),S(3,"units"),o()),t&2){let e,a=h(2).$implicit;p(),L(" ",T(3,3,(e=T(2,1,a.parameter))==null?null:e.unitSet)," ")}}function mu(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function du(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function uu(t,i){if(t&1&&(l(0,"ya-expirable",24),s(1),S(2,"value"),g(3,pu,4,5,"span")(4,mu,2,0,"span")(5,du,2,0,"span"),o()),t&2){let e=h().$implicit,a=h(2);C("pval",e.pval),p(),L(" ",it(2,5,e.pval==null?null:e.pval.engValue,Z(8,wl,a.dataSource.binaryPreview))||"-"," "),p(2),x(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function hu(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function fu(t,i){if(t&1&&(l(0,"td",21),g(1,uu,6,10,"ya-expirable",24)(2,hu,2,0,"span"),o()),t&2){let e=i.$implicit;me("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),p(),x(e.pval?1:-1),p(),x(e.pval?-1:2)}}function _u(t,i){t&1&&(l(0,"th",20),s(1,"Type"),o())}function gu(t,i){t&1&&(l(0,"span",25),s(1),o()),t&2&&(p(),L(" ",i," "))}function vu(t,i){t&1&&s(0," - ")}function yu(t,i){if(t&1&&(l(0,"td",21),g(1,gu,2,1,"span",25),S(2,"parameterTypeForPath"),g(3,vu,1,0),o()),t&2){let e,a=i.$implicit;p(),x((e=(e=T(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function Cu(t,i){t&1&&(l(0,"th",20),s(1,"Data source"),o())}function xu(t,i){if(t&1&&(l(0,"td",21),s(1),S(2,"titlecase"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function bu(t,i){t&1&&(l(0,"th",23),s(1,"Description"),o())}function Su(t,i){if(t&1&&(l(0,"td",21),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.parameter.shortDescription||"-"," ")}}function wu(t,i){t&1&&b(0,"th",26)}function Tu(t,i){t&1&&b(0,"td",21)}function Du(t,i){t&1&&b(0,"tr",27)}function Pu(t,i){t&1&&b(0,"tr",28)}function Eu(t,i){if(t&1&&(l(0,"div",2),b(1,"ya-column-chooser",3,0),g(3,nu,1,0,"ya-dots"),S(4,"async"),o(),l(5,"table",4),G(6,5),g(7,ru,2,0,"th",6)(8,ou,3,5,"td",7),U(),G(9,8),g(10,lu,2,0,"th",9)(11,su,3,6,"td",10),U(),G(12,11),g(13,cu,2,0,"th",9)(14,fu,3,4,"td",12),U(),G(15,13),g(16,_u,2,0,"th",6)(17,yu,4,3,"td",7),U(),G(18,14),g(19,Cu,2,0,"th",6)(20,xu,3,3,"td",7),U(),G(21,15),g(22,bu,2,0,"th",9)(23,Su,2,1,"td",7),U(),G(24,16),g(25,wu,1,0,"th",17)(26,Tu,1,0,"td",7),U(),g(27,Du,1,0,"tr",18),S(28,"async"),g(29,Pu,1,0,"tr",19),S(30,"async"),o()),t&2){let e=le(2),a=h();p(),C("columns",a.columns),p(2),x(T(4,5,a.dataSource.loading$)?3:-1),p(2),C("dataSource",a.dataSource),p(22),C("matHeaderRowDef",T(28,7,e.displayedColumns$)),p(2),C("matRowDefColumns",T(30,9,e.displayedColumns$))}}var nr=class t{constructor(i,e,a){this.yamcs=e;this.synchronizer=a;this.plist$=new $(null);this.columns=eo;this.dataSource=new ar(this.yamcs,this.synchronizer),i.paramMap.subscribe(n=>{let r=n.get("list");this.changeList(r)})}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.dataSource.loadParameters(e.match||[])})}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(w(Te),w(X),w(yt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&_e(jt,5),e&2){let n;he(n=fe())&&(a.columnChooser=n.first)}},standalone:!0,features:[F],decls:3,vars:3,consts:[["columnChooser",""],[1,"panel-content"],[1,"filter-bar"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"wrap200"],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(l(0,"div",1),g(1,Eu,31,11),S(2,"async"),o()),e&2){let n;p(),x((n=T(2,1,a.plist$))?1:-1,n)}},dependencies:[Y,ee,Oi,Ie,Lt,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,jt,qt,Zt,Zi,Jt,Nt],encapsulation:2,changeDetection:0})}};var rr=t=>({c:t});function ku(t,i){if(t&1&&(l(0,"ya-page-button",5),s(1," Edit list "),o()),t&2){let e=h(2);C("queryParams",Z(1,rr,e.yamcs.context))}}function Au(t,i){if(t&1&&(l(0,"a",8,3),s(2," Historical Data "),o()),t&2){let e=le(1),a=h(2);C("active",e.isActive)("queryParams",Z(2,rr,a.yamcs.context))}}function Mu(t,i){if(t&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",4),s(3),g(4,ku,2,3,"ya-page-button",5),o(),l(5,"nav",6,0)(7,"a",7,1),s(9," Realtime "),o(),g(10,Au,3,4,"a",8),o(),l(11,"div",9)(12,"mat-tab-nav-panel",null,2),b(14,"router-outlet"),o()()()),t&2){let e=le(8),a=le(13),n=h();p(2),C("queryParams",Z(8,rr,n.yamcs.context)),p(),L(" ",i.name," \xA0\xA0\xA0 "),p(),x(n.mayManageParameterLists()?4:-1),p(),C("mat-stretch-tabs",!1)("tabPanel",a),p(2),C("active",e.isActive)("queryParams",Z(10,rr,n.yamcs.context)),p(3),x(n.config.tmArchive?10:-1)}}var or=class t{constructor(i,e,a,n,r){this.yamcs=e;this.authService=a;this.title=n;this.plist$=new $(null);this.config=r.getConfig(),i.paramMap.subscribe(c=>{let d=c.get("list");this.changeList(d)})}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.title.setTitle(e.name)})}static{this.\u0275fac=function(e){return new(e||t)(w(Te),w(X),w(Ct),w(nt),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["routerLink","..","icon","arrow_back",3,"queryParams"],["routerLink","edit","icon","edit",3,"queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","realtime","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"]],template:function(e,a){if(e&1&&(g(0,Mu,15,12,"app-instance-page"),S(1,"async")),e&2){let n;x((n=T(1,1,a.plist$))?0:-1,n)}},dependencies:[et,Je,Y,ee,oi,Ie,Qa,rn,ln,on,lt,Kt],encapsulation:2,changeDetection:0})}};function Ru(t,i){t&1&&(l(0,"th",16),s(1,"Severity"),o())}function Iu(t,i){if(t&1&&(l(0,"td",17),b(1,"app-alarm-level",18),o()),t&2){let e=i.$implicit;p(),C("level",e.severity)("grayscale",!0)}}function Lu(t,i){t&1&&(l(0,"th",16),s(1,"Start"),o())}function Ou(t,i){if(t&1&&(l(0,"td",17),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),q(T(2,1,e.triggerTime)||"-")}}function Vu(t,i){t&1&&(l(0,"th",16),s(1,"Stop"),o())}function Nu(t,i){if(t&1&&(l(0,"td",17),s(1),S(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",T(2,1,e.updateTime)||"-"," ")}}function Fu(t,i){t&1&&(l(0,"th",16),s(1,"Trip value"),o())}function Bu(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function $u(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function Hu(t,i){if(t&1&&(s(0),S(1,"value"),g(2,Bu,2,0,"span")(3,$u,2,0,"span")),t&2){let e=i;L(" ",T(1,3,e.triggerValue.engValue)," "),p(2),x(e.triggerValue.rangeCondition==="LOW"?2:-1),p(),x(e.triggerValue.rangeCondition==="HIGH"?3:-1)}}function Yu(t,i){if(t&1&&(l(0,"td",19),g(1,Hu,4,5),o()),t&2){let e,a=i.$implicit;p(),x((e=a.parameterDetail)?1:-1,e)}}function Gu(t,i){t&1&&(l(0,"th",16),s(1,"Duration"),o())}function Uu(t,i){if(t&1&&(s(0),S(1,"duration")),t&2){let e=h().$implicit,a=h(2);L(" ",T(1,1,a.durationFor(e))||"-"," ")}}function zu(t,i){if(t&1&&(l(0,"mat-icon",20),s(1,"comment"),o()),t&2){let e=h(2).$implicit;C("matTooltip",e.clearInfo==null?null:e.clearInfo.clearMessage)}}function Wu(t,i){if(t&1&&(s(0),g(1,zu,2,1,"mat-icon",20)),t&2){let e=h().$implicit;L(" (cleared by ",e.clearInfo==null?null:e.clearInfo.clearedBy,") "),p(),x(e.clearInfo!=null&&e.clearInfo.clearMessage?1:-1)}}function ju(t,i){if(t&1&&(l(0,"td",17),g(1,Uu,2,3)(2,Wu,2,2),o()),t&2){let e=i.$implicit;p(),x(e.updateTime?1:-1),p(),x(e.clearInfo!=null&&e.clearInfo.clearedBy?2:-1)}}function qu(t,i){t&1&&(l(0,"th",21),s(1,"Violations"),o())}function Xu(t,i){if(t&1&&(s(0),S(1,"number"),S(2,"number")),t&2){let e=h().$implicit;Ht(" ",T(1,2,e.violations)," (",it(2,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function Zu(t,i){t&1&&s(0," - ")}function Qu(t,i){if(t&1&&(l(0,"td",22),g(1,Xu,3,7)(2,Zu,1,0),o()),t&2){let e=i.$implicit;p(),x(e.violations?1:2)}}function Ku(t,i){t&1&&b(0,"th",23)}function Ju(t,i){if(t&1){let e=N();l(0,"td",17)(1,"ya-text-action",24),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showChart(n))}),s(2," SHOW CHART "),o(),l(3,"ya-text-action",25),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showData(n))}),s(4," SHOW DATA "),o()()}}function e0(t,i){t&1&&b(0,"tr",26)}function t0(t,i){t&1&&b(0,"tr",27)}function i0(t,i){if(t&1&&(l(0,"table",0),G(1,1),g(2,Ru,2,0,"th",2)(3,Iu,2,2,"td",3),U(),G(4,4),g(5,Lu,2,0,"th",2)(6,Ou,3,3,"td",3),U(),G(7,5),g(8,Vu,2,0,"th",2)(9,Nu,3,3,"td",3),U(),G(10,6),g(11,Fu,2,0,"th",2)(12,Yu,2,1,"td",7),U(),G(13,8),g(14,Gu,2,0,"th",2)(15,ju,3,2,"td",3),U(),G(16,9),g(17,qu,2,0,"th",10)(18,Qu,3,1,"td",11),U(),G(19,12),g(20,Ku,1,0,"th",13)(21,Ju,5,0,"td",3),U(),g(22,e0,1,0,"tr",14)(23,t0,1,0,"tr",15),o()),t&2){let e=h();C("dataSource",e.dataSource),p(22),C("matHeaderRowDef",e.displayedColumns),p(),C("matRowDefColumns",e.displayedColumns)}}var lr=class t{constructor(i,e){this.router=i;this.yamcs=e;this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(i){if(i.updateTime)return B.toDate(i.updateTime).getTime()-B.toDate(i.triggerTime).getTime()}showChart(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=Wr(B.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}showData(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=Wr(B.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}static{this.\u0275fac=function(e){return new(e||t)(w(Re),w(X))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},standalone:!0,features:[F],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],["mat-cell","",1,"wrap200"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&g(0,i0,24,3,"table",0),e&2&&x(a.dataSource?0:-1)},dependencies:[ei,Y,Bo,wt,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,Yi,Qt,Le,il,Nt],encapsulation:2,changeDetection:0})}};var sr=class extends zt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.alarms$=new $([]);this.loading$=new $(!1)}connect(e){return this.alarms$}isEmpty(){return this.alarms$.value.length===0}loadAlarms(e){return this.loading$.next(!0),this.loadPage(bt(tt({},e),{limit:this.pageSize+1})).then(a=>{this.loading$.next(!1),this.alarms$.next(a)})}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}loadMoreData(e){this.offscreenRecord&&this.loadPage(bt(tt({},e),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(a=>{let n=this.alarms$.getValue().concat(a);this.alarms$.next(n)})}disconnect(){this.alarms$.complete(),this.loading$.complete()}};function a0(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",6)(1,"ya-date-time-input",7),l(2,"ya-button",8),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h();p(2),C("disabled",e.filter.invalid)}}function n0(t,i){if(t&1){let e=N();l(0,"ya-button",9),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function r0(t,i){t&1&&b(0,"ya-dots")}function o0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last month"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),q(T(7,1,e.validStop))}}function l0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last year"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),q(T(7,1,e.validStop))}}function s0(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function c0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),S(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),S(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h();p(3),q(T(4,2,e.validStart)),p(4),q(T(8,4,e.validStop))}}function p0(t,i){t&1&&(l(0,"ya-empty-message"),s(1," No records found matching current filter in the selected time range. "),o())}function m0(t,i){if(t&1){let e=N();l(0,"mat-toolbar"),b(1,"span",10),l(2,"ya-button",8),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),s(3,"Load more"),o(),b(4,"span",10),o()}if(t&2){let e=h();p(2),C("disabled",!e.dataSource.hasMore())}}var cr="P1M",pr=class t{constructor(i){this.yamcs=i;this.qualifiedName=Rt.required({alias:"parameter"});this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}];this.filter=new rt({interval:new te(cr),customStart:new te(null),customStop:new te(null)})}ngOnInit(){let i=this.qualifiedName();this.dataSource=new sr(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,cr),this.appliedInterval=cr,this.loadData(),this.filter.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(B.toISOString(a)),this.filter.get("customStop").setValue(B.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}jumpToNow(){let i=this.filter.value.interval;i==="NO_LIMIT"?this.filter.get("interval").setValue(cr):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filter.value.customStart),this.validStop=B.toDate(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(i)}loadMoreData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.dataSource.loadMoreData(i)}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(w(X))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[F],decls:17,vars:13,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[1,"table-status"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],[2,"flex","1 1 auto"]],template:function(e,a){if(e&1&&(l(0,"div",0)(1,"form",1)(2,"div",2),b(3,"ya-select",3),g(4,a0,4,1)(5,n0,2,0,"ya-button")(6,r0,1,0,"ya-dots"),S(7,"async"),o()(),l(8,"div",4),g(9,o0,9,3,"span")(10,l0,9,3,"span")(11,s0,4,0,"span")(12,c0,10,6,"span"),o(),b(13,"app-parameter-alarms-table",5),g(14,p0,2,0,"ya-empty-message")(15,m0,5,1,"mat-toolbar"),S(16,"async"),o()),e&2){let n;p(),C("formGroup",a.filter),p(2),C("options",a.intervalOptions),p(),x(a.filter.value.interval==="CUSTOM"?4:-1),p(),x(a.filter.value.interval!=="CUSTOM"?5:-1),p(),x(T(7,9,a.dataSource.loading$)?6:-1),p(3),x((n=a.appliedInterval)==="P1M"?9:n==="P1Y"?10:n==="NO_LIMIT"?11:n==="CUSTOM"?12:-1),p(4),C("dataSource",a.dataSource),p(),x(a.dataSource.isEmpty()?14:-1),p(),x(!T(16,11,a.dataSource.loading$)&&!a.dataSource.isEmpty()?15:-1)}},dependencies:[lr,Y,ee,De,de,be,Se,Pe,Gi,ge,vt,qt,Xt,Dt,Le],styles:[".table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}"],changeDetection:0})}};var Tl=function(t,i,e,a,n,r){var c=function(d){return d==="logscale"?!1:a(d)};return ai(t,i,e,c,n,r)},ai=function(t,i,e,a,n,r){var c=a("pixelsPerLabel"),d=[],m,u,v,f;if(r)for(m=0;m<r.length;m++)d.push({v:r[m]});else{if(a("logscale")){f=Math.floor(e/c);var y=Pa(t,mr,1),_=Pa(i,mr,-1);y==-1&&(y=0),_==-1&&(_=mr.length-1);var D=null;if(_-y>=f/4){for(var P=_;P>=y;P--){var R=mr[P],I=Math.log(R/t)/Math.log(i/t)*e,O={v:R};D===null?D={tickValue:R,pixel_coord:I}:Math.abs(I-D.pixel_coord)>=c?D={tickValue:R,pixel_coord:I}:O.label="",d.push(O)}d.reverse()}}if(d.length===0){var H=a("labelsKMG2"),z,K;H?(z=[1,2,4,8,16,32,64,128,256],K=16):(z=[1,2,5,10,20,50,100],K=10);var Ae=Math.ceil(e/c),W=Math.abs(i-t)/Ae,J=Math.floor(Math.log(W)/Math.log(K)),ue=Math.pow(K,J),j,pe,mt,Ve;for(u=0;u<z.length&&(j=ue*z[u],pe=Math.floor(t/j)*j,mt=Math.ceil(i/j)*j,f=Math.abs(mt-pe)/j,Ve=e/f,!(Ve>c));u++);for(pe>mt&&(j*=-1),m=0;m<=f;m++)v=pe+m*j,d.push({v})}}var Pt=a("axisLabelFormatter");for(m=0;m<d.length;m++)d[m].label===void 0&&(d[m].label=Pt.call(n,d[m].v,0,a,n));return d},Ci=function(t,i,e,a,n,r){var c=d0(t,i,e,a);return c>=0?to(t,i,c,a,n):[]},se={MILLISECONDLY:0,TWO_MILLISECONDLY:1,FIVE_MILLISECONDLY:2,TEN_MILLISECONDLY:3,FIFTY_MILLISECONDLY:4,HUNDRED_MILLISECONDLY:5,FIVE_HUNDRED_MILLISECONDLY:6,SECONDLY:7,TWO_SECONDLY:8,FIVE_SECONDLY:9,TEN_SECONDLY:10,THIRTY_SECONDLY:11,MINUTELY:12,TWO_MINUTELY:13,FIVE_MINUTELY:14,TEN_MINUTELY:15,THIRTY_MINUTELY:16,HOURLY:17,TWO_HOURLY:18,SIX_HOURLY:19,DAILY:20,TWO_DAILY:21,WEEKLY:22,MONTHLY:23,QUARTERLY:24,BIANNUAL:25,ANNUAL:26,DECADAL:27,CENTENNIAL:28,NUM_GRANULARITIES:29},ce={DATEFIELD_Y:0,DATEFIELD_M:1,DATEFIELD_D:2,DATEFIELD_HH:3,DATEFIELD_MM:4,DATEFIELD_SS:5,DATEFIELD_MS:6,NUM_DATEFIELDS:7},ve=[];ve[se.MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:1,spacing:1};ve[se.TWO_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:2,spacing:2};ve[se.FIVE_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:5,spacing:5};ve[se.TEN_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:10,spacing:10};ve[se.FIFTY_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:50,spacing:50};ve[se.HUNDRED_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:100,spacing:100};ve[se.FIVE_HUNDRED_MILLISECONDLY]={datefield:ce.DATEFIELD_MS,step:500,spacing:500};ve[se.SECONDLY]={datefield:ce.DATEFIELD_SS,step:1,spacing:1e3*1};ve[se.TWO_SECONDLY]={datefield:ce.DATEFIELD_SS,step:2,spacing:1e3*2};ve[se.FIVE_SECONDLY]={datefield:ce.DATEFIELD_SS,step:5,spacing:1e3*5};ve[se.TEN_SECONDLY]={datefield:ce.DATEFIELD_SS,step:10,spacing:1e3*10};ve[se.THIRTY_SECONDLY]={datefield:ce.DATEFIELD_SS,step:30,spacing:1e3*30};ve[se.MINUTELY]={datefield:ce.DATEFIELD_MM,step:1,spacing:1e3*60};ve[se.TWO_MINUTELY]={datefield:ce.DATEFIELD_MM,step:2,spacing:1e3*60*2};ve[se.FIVE_MINUTELY]={datefield:ce.DATEFIELD_MM,step:5,spacing:1e3*60*5};ve[se.TEN_MINUTELY]={datefield:ce.DATEFIELD_MM,step:10,spacing:1e3*60*10};ve[se.THIRTY_MINUTELY]={datefield:ce.DATEFIELD_MM,step:30,spacing:1e3*60*30};ve[se.HOURLY]={datefield:ce.DATEFIELD_HH,step:1,spacing:1e3*3600};ve[se.TWO_HOURLY]={datefield:ce.DATEFIELD_HH,step:2,spacing:1e3*3600*2};ve[se.SIX_HOURLY]={datefield:ce.DATEFIELD_HH,step:6,spacing:1e3*3600*6};ve[se.DAILY]={datefield:ce.DATEFIELD_D,step:1,spacing:1e3*86400};ve[se.TWO_DAILY]={datefield:ce.DATEFIELD_D,step:2,spacing:1e3*86400*2};ve[se.WEEKLY]={datefield:ce.DATEFIELD_D,step:7,spacing:1e3*604800};ve[se.MONTHLY]={datefield:ce.DATEFIELD_M,step:1,spacing:1e3*7200*365.2425};ve[se.QUARTERLY]={datefield:ce.DATEFIELD_M,step:3,spacing:1e3*21600*365.2425};ve[se.BIANNUAL]={datefield:ce.DATEFIELD_M,step:6,spacing:1e3*43200*365.2425};ve[se.ANNUAL]={datefield:ce.DATEFIELD_Y,step:1,spacing:1e3*86400*365.2425};ve[se.DECADAL]={datefield:ce.DATEFIELD_Y,step:10,spacing:1e3*864e3*365.2425};ve[se.CENTENNIAL]={datefield:ce.DATEFIELD_Y,step:100,spacing:1e3*864e4*365.2425};var mr=function(){for(var t=[],i=-39;i<=39;i++)for(var e=Math.pow(10,i),a=1;a<=9;a++){var n=e*a;t.push(n)}return t}(),d0=function(t,i,e,a){for(var n=a("pixelsPerLabel"),r=0;r<se.NUM_GRANULARITIES;r++){var c=u0(t,i,r);if(e/c>=n)return r}return-1},u0=function(t,i,e){var a=ve[e].spacing;return Math.round(1*(i-t)/a)},to=function(t,i,e,a,n){var r=a("axisLabelFormatter"),c=a("labelsUTC"),d=c?ur:dr,m=ve[e].datefield,u=ve[e].step,v=ve[e].spacing,f=new Date(t),y=[];y[ce.DATEFIELD_Y]=d.getFullYear(f),y[ce.DATEFIELD_M]=d.getMonth(f),y[ce.DATEFIELD_D]=d.getDate(f),y[ce.DATEFIELD_HH]=d.getHours(f),y[ce.DATEFIELD_MM]=d.getMinutes(f),y[ce.DATEFIELD_SS]=d.getSeconds(f),y[ce.DATEFIELD_MS]=d.getMilliseconds(f);var _=y[m]%u;e==se.WEEKLY&&(_=d.getDay(f)),y[m]-=_;for(var D=m+1;D<ce.NUM_DATEFIELDS;D++)y[D]=D===ce.DATEFIELD_D?1:0;var P=[],R=d.makeDate.apply(null,y),I=R.getTime();if(e<=se.HOURLY)for(I<t&&(I+=v,R=new Date(I));I<=i;)P.push({v:I,label:r.call(n,R,e,a,n)}),I+=v,R=new Date(I);else for(I<t&&(y[m]+=u,R=d.makeDate.apply(null,y),I=R.getTime());I<=i;)(e>=se.DAILY||d.getHours(R)%u===0)&&P.push({v:I,label:r.call(n,R,e,a,n)}),y[m]+=u,R=d.makeDate.apply(null,y),I=R.getTime();return P};var bi=10,h0=Math.log(bi),we=function(t){return Math.log(t)/h0},ka=function(t,i,e){var a=we(t),n=we(i),r=a+e*(n-a),c=Math.pow(bi,r);return c};var Ml=[7,3],Rl=[7,2,2,2],ia=1,aa=2,na=function(t){return t.getContext("2d")},Si=function(i,e,a){i.addEventListener(e,a,!1)};function Et(t,i,e){t.removeEventListener(i,e,!1)}function ni(t){return t=t||window.event,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.cancel=!0,t.returnValue=!1,!1}function Il(t,i,e){var a,n,r;if(i===0)a=e,n=e,r=e;else{var c=Math.floor(t*6),d=t*6-c,m=e*(1-i),u=e*(1-i*d),v=e*(1-i*(1-d));switch(c){case 1:a=u,n=e,r=m;break;case 2:a=m,n=e,r=v;break;case 3:a=m,n=u,r=e;break;case 4:a=v,n=m,r=e;break;case 5:a=e,n=m,r=u;break;case 6:case 0:a=e,n=v,r=m;break}}return a=Math.floor(255*a+.5),n=Math.floor(255*n+.5),r=Math.floor(255*r+.5),"rgb("+a+","+n+","+r+")"}function ui(t){var i=t.getBoundingClientRect(),e=window,a=document.documentElement;return{x:i.left+(e.pageXOffset||a.scrollLeft),y:i.top+(e.pageYOffset||a.scrollTop)}}function ra(t){return!t.pageX||t.pageX<0?0:t.pageX}function oa(t){return!t.pageY||t.pageY<0?0:t.pageY}function la(t,i){return ra(t)-i.px}function sa(t,i){return oa(t)-i.py}function Ll(t){return!!t&&!isNaN(t)}function ca(t,i){return!(!t||t.yval===null||t.x===null||t.x===void 0||t.y===null||t.y===void 0||isNaN(t.x)||!i&&isNaN(t.y))}function oo(t,i){var e=Math.min(Math.max(1,i||2),21);return Math.abs(t)<.001&&t!==0?t.toExponential(e-1):t.toPrecision(e)}function xi(t){return t<10?"0"+t:""+t}var dr={getFullYear:t=>t.getFullYear(),getMonth:t=>t.getMonth(),getDate:t=>t.getDate(),getHours:t=>t.getHours(),getMinutes:t=>t.getMinutes(),getSeconds:t=>t.getSeconds(),getMilliseconds:t=>t.getMilliseconds(),getDay:t=>t.getDay(),makeDate:function(t,i,e,a,n,r,c){return new Date(t,i,e,a,n,r,c)}},ur={getFullYear:t=>t.getUTCFullYear(),getMonth:t=>t.getUTCMonth(),getDate:t=>t.getUTCDate(),getHours:t=>t.getUTCHours(),getMinutes:t=>t.getUTCMinutes(),getSeconds:t=>t.getUTCSeconds(),getMilliseconds:t=>t.getUTCMilliseconds(),getDay:t=>t.getUTCDay(),makeDate:function(t,i,e,a,n,r,c){return new Date(Date.UTC(t,i,e,a,n,r,c))}};function ro(t,i,e,a){var n=xi(t)+":"+xi(i);if(e&&(n+=":"+xi(e),a)){var r=""+a;n+="."+("000"+r).substring(r.length)}return n}function lo(t,i){var e=i?ur:dr,a=new Date(t),n=e.getFullYear(a),r=e.getMonth(a),c=e.getDate(a),d=e.getHours(a),m=e.getMinutes(a),u=e.getSeconds(a),v=e.getMilliseconds(a),f=""+n,y=xi(r+1),_=xi(c),D=d*3600+m*60+u+.001*v,P=f+"/"+y+"/"+_;return D&&(P+=" "+ro(d,m,u,v)),P}function ao(t,i){var e=Math.pow(10,i);return Math.round(t*e)/e}function Pa(t,i,e,a,n){if((a==null||n===null||n===void 0)&&(a=0,n=i.length-1),a>n)return-1;e==null&&(e=0);var r=function(u){return u>=0&&u<i.length},c=parseInt((a+n)/2,10),d=i[c],m;return d==t?c:d>t?e>0&&(m=c-1,r(m)&&i[m]<t)?c:Pa(t,i,e,a,c-1):d<t?e<0&&(m=c+1,r(m)&&i[m]>t)?c:Pa(t,i,e,c+1,n):-1}function so(t){var i,e;if((t.search("-")==-1||t.search("T")!=-1||t.search("Z")!=-1)&&(e=no(t),e&&!isNaN(e)))return e;if(t.search("-")!=-1){for(i=t.replace("-","/","g");i.search("-")!=-1;)i=i.replace("-","/");e=no(i)}else e=no(t);return(!e||isNaN(e))&&console.error("Couldn't parse "+t+" as a date"),e}function no(t){return new Date(t).getTime()}function xt(t,i){if(typeof i<"u"&&i!==null)for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}var f0=typeof Node<"u"&&Node!==null&&typeof Node=="object"?function(i){return i instanceof Node}:function(i){return typeof i=="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"};function fr(t,i){if(typeof i<"u"&&i!==null){for(var e in i)if(i.hasOwnProperty(e)){let a=i[e];a===null?t[e]=null:wi(a)?t[e]=a.slice():f0(a)?t[e]=a:typeof a=="object"?((typeof t[e]!="object"||t[e]===null)&&(t[e]={}),fr(t[e],a)):t[e]=a}}return t}function Ol(t){if(t===null)return"null";let i=typeof t;return(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4?"array":i}function wi(t){let i=typeof t;return t!==null&&(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4}function co(t){return t!==null&&typeof t=="object"&&typeof t.getTime=="function"}function po(t){for(var i=[],e=0;e<t.length;e++)wi(t[e])?i.push(po(t[e])):i.push(t[e]);return i}function pa(){return document.createElement("canvas")}function Aa(t){try{var i=window.devicePixelRatio,e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i!==void 0?i/e:1}catch{return 1}}function Vl(t,i,e,a){i=i||0,e=e||t.length,this.hasNext=!0,this.peek=null,this.start_=i,this.array_=t,this.predicate_=a,this.end_=Math.min(t.length,i+e),this.nextIdx_=i-1,this.next()}Vl.prototype.next=function(){if(!this.hasNext)return null;for(var t=this.peek,i=this.nextIdx_+1,e=!1;i<this.end_;){if(!this.predicate_||this.predicate_(this.array_,i)){this.peek=this.array_[i],e=!0;break}i++}return this.nextIdx_=i,e||(this.hasNext=!1,this.peek=null),t};function _r(t,i,e,a){return new Vl(t,i,e,a)}var _0=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function mo(t,i,e,a){var n=0,r,c=new Date().getTime();if(t(n),i==1){a();return}var d=i-1;(function m(){n>=i||_0.call(window,function(){var u=new Date().getTime(),v=u-c;r=n,n=Math.floor(v/e);var f=n-r,y=n+f>d;y||n>=d?(t(d),a()):(f!==0&&t(n),m())})})()}var Dl={annotationClickHandler:!0,annotationDblClickHandler:!0,annotationMouseOutHandler:!0,annotationMouseOverHandler:!0,axisLineColor:!0,axisLineWidth:!0,clickCallback:!0,drawCallback:!0,drawHighlightPointCallback:!0,drawPoints:!0,drawPointCallback:!0,drawGrid:!0,fillAlpha:!0,gridLineColor:!0,gridLineWidth:!0,hideOverlayOnMouseOut:!0,highlightCallback:!0,highlightCircleSize:!0,interactionModel:!0,labelsDiv:!0,labelsKMB:!0,labelsKMG2:!0,labelsSeparateLines:!0,labelsShowZeroValues:!0,legend:!0,panEdgeFraction:!0,pixelsPerYLabel:!0,pointClickCallback:!0,pointSize:!0,rangeSelectorPlotFillColor:!0,rangeSelectorPlotFillGradientColor:!0,rangeSelectorPlotStrokeColor:!0,rangeSelectorBackgroundStrokeColor:!0,rangeSelectorBackgroundLineWidth:!0,rangeSelectorPlotLineWidth:!0,rangeSelectorForegroundStrokeColor:!0,rangeSelectorForegroundLineWidth:!0,rangeSelectorAlpha:!0,showLabelsOnHighlight:!0,showRoller:!0,strokeWidth:!0,underlayCallback:!0,unhighlightCallback:!0,zoomCallback:!0};function Nl(t,i){var e={};if(t)for(var a=1;a<t.length;a++)e[t[a]]=!0;var n=function(m){for(var u in m)if(m.hasOwnProperty(u)&&!Dl[u])return!0;return!1};for(var r in i)if(i.hasOwnProperty(r)){if(r=="highlightSeriesOpts"||e[r]&&!i.series){if(n(i[r]))return!0}else if(r=="series"||r=="axes"){var c=i[r];for(var d in c)if(c.hasOwnProperty(d)&&n(c[d]))return!0}else if(!Dl[r])return!0}return!1}var Ma={DEFAULT:function(t,i,e,a,n,r,c){e.beginPath(),e.fillStyle=r,e.arc(a,n,c,0,2*Math.PI,!1),e.fill()}};function uo(t){for(var i=0;i<t.length;i++){var e=t.charAt(i);if(e==="\r")return i+1<t.length&&t.charAt(i+1)===`
`?`\r
`:e;if(e===`
`)return i+1<t.length&&t.charAt(i+1)==="\r"?`
\r`:e}return null}function ho(t,i){if(i===null||t===null)return!1;for(var e=t;e&&e!==i;)e=e.parentNode;return e===i}function Pl(t,i){return i<0?1/Math.pow(t,-i):Math.pow(t,i)}var g0=/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})?$/,v0=/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*([01](?:\.\d+)?))?\)$/;function El(t){var i,e,a,n,r=null;if(i=g0.exec(t))e=parseInt(i[1],16),a=parseInt(i[2],16),n=parseInt(i[3],16),i[4]&&(r=parseInt(i[4],16));else if(i=v0.exec(t))e=parseInt(i[1],10),a=parseInt(i[2],10),n=parseInt(i[3],10),i[4]&&(r=parseFloat(i[4]));else return null;return r!==null?{r:e,g:a,b:n,a:r}:{r:e,g:a,b:n}}function ma(t){var i=El(t);if(i)return i;var e=document.createElement("div");e.style.backgroundColor=t,e.style.visibility="hidden",document.body.appendChild(e);var a=window.getComputedStyle(e,null).backgroundColor;return document.body.removeChild(e),El(a)}function Fl(t){try{var i=t||document.createElement("canvas");i.getContext("2d")}catch{return!1}return!0}function ri(t,i,e){var a=parseFloat(t);if(!isNaN(a))return a;if(/^ *$/.test(t))return null;if(/^ *nan *$/i.test(t))return NaN;var n="Unable to parse '"+t+"' as a number";return e!==void 0&&i!==void 0&&(n+=" on line "+(1+(i||0))+" ('"+e+"') of CSV."),console.error(n),null}var y0=["k","M","G","T","P","E","Z","Y"],Bl=["m","\xB5","n","p","f","a","z","y"],C0=["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],x0=["p-10","p-20","p-30","p-40","p-50","p-60","p-70","p-80"],b0=["K","M","G","T","P","E","Z","Y"],S0=Bl;function gr(t,i){var e=i("sigFigs");if(e!==null)return oo(t,e);if(t===0)return"0";var a=i("digitsAfterDecimal"),n=i("maxNumberWidth"),r=i("labelsKMB"),c=i("labelsKMG2"),d,m=Math.abs(t);if(r||c){var u,v=[],f=[];r&&(u=1e3,v=y0,f=Bl),c&&(u=1024,v=C0,f=x0,r&&(v=b0,f=S0));var y,_;if(m>=u){for(_=v.length;_>0;)if(y=Pl(u,_),--_,m>=y)return m/y>=Math.pow(10,n)?d=t.toExponential(a):d=ao(t/y,a)+v[_],d}else if(m<1){for(_=0;_<f.length&&(++_,y=Pl(u,_),!(m*y>=1)););return m*y<Math.pow(10,-a)?d=t.toExponential(a):d=ao(t*y,a)+f[_-1],d}}return m>=Math.pow(10,n)||m<Math.pow(10,-a)?d=t.toExponential(a):d=""+ao(t,a),d}function Ra(t,i,e){return gr.call(this,t,e)}var kl=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ti(t,i,e){var a=e("labelsUTC"),n=a?ur:dr,r=n.getFullYear(t),c=n.getMonth(t),d=n.getDate(t),m=n.getHours(t),u=n.getMinutes(t),v=n.getSeconds(t),f=n.getMilliseconds(t);if(i>=se.DECADAL)return""+r;if(i>=se.MONTHLY)return kl[c]+"&#160;"+r;var y=m*3600+u*60+v+.001*f;if(y===0||i>=se.DAILY)return xi(d)+"&#160;"+kl[c];if(i<se.SECONDLY){var _=""+f;return xi(v)+"."+("000"+_).substring(_.length)}else return i>se.MINUTELY?ro(m,u,v,0):ro(m,u,v,f)}function da(t,i){return lo(t,i("labelsUTC"))}var hr=[],Al=!1;function Ea(t){return typeof t=="function"&&t(),!0}function $l(t){if(typeof document<"u"){let i=function(){if(!Al){Al=!0,t.onDOMready=Ea,document.removeEventListener("DOMContentLoaded",i,!1),window.removeEventListener("load",i,!1);for(let a=0;a<hr.length;++a)hr[a]();hr=null}};t.onDOMready=function(a){if(document.readyState==="complete")return t.onDOMready=Ea,Ea(a);let n=function(c){return typeof c=="function"&&hr.push(c),!1};return t.onDOMready=n,document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1),document.readyState==="complete"?(i(),t.onDOMready=Ea,Ea(a)):n(a)}}}var pt=function(t){this.dygraph_=t,this.points=[],this.setNames=[],this.annotations=[],this.yAxes_=null,this.xTicks_=null,this.yTicks_=null};pt.prototype.addDataset=function(t,i){this.points.push(i),this.setNames.push(t)};pt.prototype.getPlotArea=function(){return this.area_};pt.prototype.computePlotArea=function(){var t={x:0,y:0};t.w=this.dygraph_.width_-t.x-this.dygraph_.getOption("rightGap"),t.h=this.dygraph_.height_;var i={chart_div:this.dygraph_.graphDiv,reserveSpaceLeft:function(e){var a={x:t.x,y:t.y,w:e,h:t.h};return t.x+=e,t.w-=e,a},reserveSpaceRight:function(e){var a={x:t.x+t.w-e,y:t.y,w:e,h:t.h};return t.w-=e,a},reserveSpaceTop:function(e){var a={x:t.x,y:t.y,w:t.w,h:e};return t.y+=e,t.h-=e,a},reserveSpaceBottom:function(e){var a={x:t.x,y:t.y+t.h-e,w:t.w,h:e};return t.h-=e,a},chartRect:function(){return{x:t.x,y:t.y,w:t.w,h:t.h}}};this.dygraph_.cascadeEvents_("layout",i),this.area_=t};pt.prototype.setAnnotations=function(t){this.annotations=[];for(var i=this.dygraph_.getOption("xValueParser")||function(n){return n},e=0;e<t.length;e++){var a={};if(!t[e].xval&&t[e].x===void 0){console.error("Annotations must have an 'x' property");return}if(t[e].icon&&!(t[e].hasOwnProperty("width")&&t[e].hasOwnProperty("height"))){console.error("Must set width and height when setting annotation.icon property");return}xt(a,t[e]),a.xval||(a.xval=i(a.x)),this.annotations.push(a)}};pt.prototype.setXTicks=function(t){this.xTicks_=t};pt.prototype.setYAxes=function(t){this.yAxes_=t};pt.prototype.evaluate=function(){this._xAxis={},this._evaluateLimits(),this._evaluateLineCharts(),this._evaluateLineTicks(),this._evaluateAnnotations()};pt.prototype._evaluateLimits=function(){var t=this.dygraph_.xAxisRange();this._xAxis.minval=t[0],this._xAxis.maxval=t[1];var i=t[1]-t[0];this._xAxis.scale=i!==0?1/i:1,this.dygraph_.getOptionForAxis("logscale","x")&&(this._xAxis.xlogrange=we(this._xAxis.maxval)-we(this._xAxis.minval),this._xAxis.xlogscale=this._xAxis.xlogrange!==0?1/this._xAxis.xlogrange:1);for(var e=0;e<this.yAxes_.length;e++){var a=this.yAxes_[e];a.minyval=a.computedValueRange[0],a.maxyval=a.computedValueRange[1],a.yrange=a.maxyval-a.minyval,a.yscale=a.yrange!==0?1/a.yrange:1,(this.dygraph_.getOption("logscale")||a.logscale)&&(a.ylogrange=we(a.maxyval)-we(a.minyval),a.ylogscale=a.ylogrange!==0?1/a.ylogrange:1,(!isFinite(a.ylogrange)||isNaN(a.ylogrange))&&console.error("axis "+e+" of graph at "+a.g+" can't be displayed in log scale for range ["+a.minyval+" - "+a.maxyval+"]"))}};pt.calcXNormal_=function(t,i,e){return e?(we(t)-we(i.minval))*i.xlogscale:(t-i.minval)*i.scale};pt.calcYNormal_=function(t,i,e){if(e){var a=1-(we(i)-we(t.minyval))*t.ylogscale;return isFinite(a)?a:NaN}else return 1-(i-t.minyval)*t.yscale};pt.prototype._evaluateLineCharts=function(){for(var t=this.dygraph_.getOption("stackedGraph"),i=this.dygraph_.getOptionForAxis("logscale","x"),e=0;e<this.points.length;e++){for(var a=this.points[e],n=this.setNames[e],r=this.dygraph_.getOption("connectSeparatedPoints",n),c=this.dygraph_.axisPropertiesForSeries(n),d=this.dygraph_.attributes_.getForSeries("logscale",n),m=0;m<a.length;m++){var u=a[m];u.x=pt.calcXNormal_(u.xval,this._xAxis,i);var v=u.yval;t&&(u.y_stacked=pt.calcYNormal_(c,u.yval_stacked,d),v!==null&&!isNaN(v)&&(v=u.yval_stacked)),v===null&&(v=NaN,r||(u.yval=NaN)),u.y=pt.calcYNormal_(c,v,d)}this.dygraph_.dataHandler_.onLineEvaluated(a,c,d)}};pt.prototype._evaluateLineTicks=function(){var t,i,e,a,n,r;for(this.xticks=[],t=0;t<this.xTicks_.length;t++)i=this.xTicks_[t],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentXCoord(n),a>=0&&a<1&&this.xticks.push({pos:a,label:e,has_tick:r});for(this.yticks=[],t=0;t<this.yAxes_.length;t++)for(var c=this.yAxes_[t],d=0;d<c.ticks.length;d++)i=c.ticks[d],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentYCoord(n,t),a>0&&a<=1&&this.yticks.push({axis:t,pos:a,label:e,has_tick:r})};pt.prototype._evaluateAnnotations=function(){var t,i={};for(t=0;t<this.annotations.length;t++){var e=this.annotations[t];i[e.xval+","+e.series]=e}if(this.annotated_points=[],!(!this.annotations||!this.annotations.length))for(var a=0;a<this.points.length;a++){var n=this.points[a];for(t=0;t<n.length;t++){var r=n[t],c=r.xval+","+r.name;c in i&&(r.annotation=i[c],this.annotated_points.push(r),delete i[c])}}};pt.prototype.removeAllDatasets=function(){delete this.points,delete this.setNames,delete this.setPointsLengths,delete this.setPointsOffsets,this.points=[],this.setNames=[],this.setPointsLengths=[],this.setPointsOffsets=[]};var Ia=pt;var ke=function(t,i,e,a){if(this.dygraph_=t,this.layout=a,this.element=i,this.elementContext=e,this.height=t.height_,this.width=t.width_,!Fl(this.element))throw"Canvas is not supported.";this.area=a.getPlotArea();var n=this.dygraph_.canvas_ctx_;n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip(),n=this.dygraph_.hidden_ctx_,n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip()};ke.prototype.clear=function(){this.elementContext.clearRect(0,0,this.width,this.height)};ke.prototype.render=function(){this._updatePoints(),this._renderLineChart()};ke._getIteratorPredicate=function(t){return t?ke._predicateThatSkipsEmptyPoints:null};ke._predicateThatSkipsEmptyPoints=function(t,i){return t[i].yval!==null};ke._drawStyledLine=function(t,i,e,a,n,r,c){var d=t.dygraph,m=d.getBooleanOption("stepPlot",t.setName);wi(a)||(a=null);var u=d.getBooleanOption("drawGapEdgePoints",t.setName),v=t.points,f=t.setName,y=_r(v,0,v.length,ke._getIteratorPredicate(d.getBooleanOption("connectSeparatedPoints",f))),_=a&&a.length>=2,D=t.drawingContext;D.save(),_&&D.setLineDash&&D.setLineDash(a);var P=ke._drawSeries(t,y,e,c,n,u,m,i);ke._drawPointsOnLine(t,P,r,i,c),_&&D.setLineDash&&D.setLineDash([]),D.restore()};ke._drawSeries=function(t,i,e,a,n,r,c,d){var m=null,u=null,v=null,f,y,_=[],D=!0,P=t.drawingContext;P.beginPath(),P.strokeStyle=d,P.lineWidth=e;for(var R=i.array_,I=i.end_,O=i.predicate_,H=i.start_;H<I;H++){if(y=R[H],O){for(;H<I&&!O(R,H);)H++;if(H==I)break;y=R[H]}if(y.canvasy===null||y.canvasy!=y.canvasy)c&&m!==null&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),m=u=null;else{if(f=!1,r||m===null){i.nextIdx_=H,i.next(),v=i.hasNext?i.peek.canvasy:null;var z=v===null||v!=v;f=m===null&&z,r&&(!D&&m===null||i.hasNext&&z)&&(f=!0)}m!==null?e&&(c&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),P.lineTo(y.canvasx,y.canvasy)):P.moveTo(y.canvasx,y.canvasy),(n||f)&&_.push([y.canvasx,y.canvasy,y.idx]),m=y.canvasx,u=y.canvasy}D=!1}return P.stroke(),_};ke._drawPointsOnLine=function(t,i,e,a,n){for(var r=t.drawingContext,c=0;c<i.length;c++){var d=i[c];r.save(),e.call(t.dygraph,t.dygraph,t.setName,r,d[0],d[1],a,n,d[2]),r.restore()}};ke.prototype._updatePoints=function(){for(var t=this.layout.points,i=t.length;i--;)for(var e=t[i],a=e.length;a--;){var n=e[a];n.canvasx=this.area.w*n.x+this.area.x,n.canvasy=this.area.h*n.y+this.area.y}};ke.prototype._renderLineChart=function(t,i){var e=i||this.elementContext,a,n=this.layout.points,r=this.layout.setNames,c;this.colors=this.dygraph_.colorsMap_;var d=this.dygraph_.getOption("plotter"),m=d;wi(m)||(m=[m]);var u={};for(a=0;a<r.length;a++){c=r[a];var v=this.dygraph_.getOption("plotter",c);v!=d&&(u[c]=v)}for(a=0;a<m.length;a++)for(var f=m[a],y=a==m.length-1,_=0;_<n.length;_++)if(c=r[_],!(t&&c!=t)){var D=n[_],P=f;if(c in u)if(y)P=u[c];else continue;var R=this.colors[c],I=this.dygraph_.getOption("strokeWidth",c);e.save(),e.strokeStyle=R,e.lineWidth=I,P({points:D,setName:c,drawingContext:e,color:R,strokeWidth:I,dygraph:this.dygraph_,axis:this.dygraph_.axisPropertiesForSeries(c),plotArea:this.area,seriesIndex:_,seriesCount:n.length,singleSeriesName:t,allSeriesPoints:n}),e.restore()}};ke._Plotters={linePlotter:function(t){ke._linePlotter(t)},fillPlotter:function(t){ke._fillPlotter(t)},errorPlotter:function(t){ke._errorPlotter(t)}};ke._linePlotter=function(t){var i=t.dygraph,e=t.setName,a=t.strokeWidth,n=i.getNumericOption("strokeBorderWidth",e),r=i.getOption("drawPointCallback",e)||Ma.DEFAULT,c=i.getOption("strokePattern",e),d=i.getBooleanOption("drawPoints",e),m=i.getNumericOption("pointSize",e);n&&a&&ke._drawStyledLine(t,i.getOption("strokeBorderColor",e),a+2*n,c,d,r,m),ke._drawStyledLine(t,t.color,a,c,d,r,m)};ke._errorPlotter=function(t){var i=t.dygraph,e=t.setName,a=i.getBooleanOption("errorBars")||i.getBooleanOption("customBars");if(a){var n=i.getBooleanOption("fillGraph",e);n&&console.warn("Can't use fillGraph option with customBars or errorBars option");var r=t.drawingContext,c=t.color,d=i.getNumericOption("fillAlpha",e),m=i.getBooleanOption("stepPlot",e),u=t.points,v=_r(u,0,u.length,ke._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",e))),f,y=NaN,_=NaN,D=[-1,-1],P=ma(c),R="rgba("+P.r+","+P.g+","+P.b+","+d+")";r.fillStyle=R,r.beginPath();for(var I=function(H){return H==null||isNaN(H)};v.hasNext;){var O=v.next();if(!m&&I(O.y)||m&&!isNaN(_)&&I(_)){y=NaN;continue}f=[O.y_bottom,O.y_top],m&&(_=O.y),isNaN(f[0])&&(f[0]=O.y),isNaN(f[1])&&(f[1]=O.y),f[0]=t.plotArea.h*f[0]+t.plotArea.y,f[1]=t.plotArea.h*f[1]+t.plotArea.y,isNaN(y)||(m?(r.moveTo(y,D[0]),r.lineTo(O.canvasx,D[0]),r.lineTo(O.canvasx,D[1])):(r.moveTo(y,D[0]),r.lineTo(O.canvasx,f[0]),r.lineTo(O.canvasx,f[1])),r.lineTo(y,D[1]),r.closePath()),D=f,y=O.canvasx}r.fill()}};ke._fastCanvasProxy=function(t){var i=[],e=null,a=null,n=1,r=2,c=0,d=function(v){if(!(i.length<=1)){for(var f=i.length-1;f>0;f--){var y=i[f];if(y[0]==r){var _=i[f-1];_[1]==y[1]&&_[2]==y[2]&&i.splice(f,1)}}for(var f=0;f<i.length-1;){var y=i[f];y[0]==r&&i[f+1][0]==r?i.splice(f,1):f++}if(i.length>2&&!v){var D=0;i[0][0]==r&&D++;for(var P=null,R=null,f=D;f<i.length;f++){var y=i[f];if(y[0]==n)if(P===null&&R===null)P=f,R=f;else{var I=y[2];I<i[P][2]?P=f:I>i[R][2]&&(R=f)}}var O=i[P],H=i[R];i.splice(D,i.length-D),P<R?(i.push(O),i.push(H)):(P>R&&i.push(H),i.push(O))}}},m=function(v){d(v);for(var f=0,y=i.length;f<y;f++){var _=i[f];_[0]==n?t.lineTo(_[1],_[2]):_[0]==r&&t.moveTo(_[1],_[2])}i.length&&(a=i[i.length-1][1]),c+=i.length,i=[]},u=function(v,f,y){var _=Math.round(f);if(e===null||_!=e){var D=e-a>1,P=_-e>1,R=D||P;m(R),e=_}i.push([v,f,y])};return{moveTo:function(v,f){u(r,v,f)},lineTo:function(v,f){u(n,v,f)},stroke:function(){m(!0),t.stroke()},fill:function(){m(!0),t.fill()},beginPath:function(){m(!0),t.beginPath()},closePath:function(){m(!0),t.closePath()},_count:function(){return c}}};ke._fillPlotter=function(t){if(!t.singleSeriesName&&t.seriesIndex===0){for(var i=t.dygraph,e=i.getLabels().slice(1),a=e.length;a>=0;a--)i.visibility()[a]||e.splice(a,1);var n=function(){for(var $t=0;$t<e.length;$t++)if(i.getBooleanOption("fillGraph",e[$t]))return!0;return!1}();if(n)for(var r=t.plotArea,c=t.allSeriesPoints,d=c.length,m=i.getBooleanOption("stackedGraph"),u=i.getColors(),v={},f,y,_=function($t,Xl,Zl,Eo){if($t.lineTo(Xl,Zl),m)for(var Gr=Eo.length-1;Gr>=0;Gr--){var ko=Eo[Gr];$t.lineTo(ko[0],ko[1])}},D=d-1;D>=0;D--){var P=t.drawingContext,R=e[D];if(i.getBooleanOption("fillGraph",R)){var I=i.getNumericOption("fillAlpha",R),O=i.getBooleanOption("stepPlot",R),H=u[D],z=i.axisPropertiesForSeries(R),K=1+z.minyval*z.yscale;K<0?K=0:K>1&&(K=1),K=r.h*K+r.y;var Ae=c[D],W=_r(Ae,0,Ae.length,ke._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",R))),J=NaN,ue=[-1,-1],j,pe=ma(H),mt="rgba("+pe.r+","+pe.g+","+pe.b+","+I+")";P.fillStyle=mt,P.beginPath();var Ve,Pt=!0;(Ae.length>2*i.width_||qe.FORCE_FAST_PROXY)&&(P=ke._fastCanvasProxy(P));for(var Xe=[],xe;W.hasNext;){if(xe=W.next(),!Ll(xe.y)&&!O){_(P,J,ue[1],Xe),Xe=[],J=NaN,xe.y_stacked!==null&&!isNaN(xe.y_stacked)&&(v[xe.canvasx]=r.h*xe.y_stacked+r.y);continue}if(m){if(!Pt&&Ve==xe.xval)continue;Pt=!1,Ve=xe.xval,f=v[xe.canvasx];var Ri;f===void 0?Ri=K:y?Ri=f[0]:Ri=f,j=[xe.canvasy,Ri],O?ue[0]===-1?v[xe.canvasx]=[xe.canvasy,K]:v[xe.canvasx]=[xe.canvasy,ue[0]]:v[xe.canvasx]=xe.canvasy}else isNaN(xe.canvasy)&&O?j=[r.y+r.h,K]:j=[xe.canvasy,K];isNaN(J)?(P.moveTo(xe.canvasx,j[1]),P.lineTo(xe.canvasx,j[0])):(O&&P.lineTo(xe.canvasx,ue[0]),P.lineTo(xe.canvasx,j[0]),m&&(Xe.push([J,ue[1]]),y&&f?Xe.push([xe.canvasx,f[1]]):Xe.push([xe.canvasx,j[1]]))),ue=j,J=xe.canvasx}y=O,j&&xe&&(_(P,xe.canvasx,j[1],Xe),Xe=[]),P.fill()}}}};var Di=ke;var w0=100,ye={};ye.maybeTreatMouseOpAsClick=function(t,i,e){e.dragEndX=la(t,e),e.dragEndY=sa(t,e);var a=Math.abs(e.dragEndX-e.dragStartX),n=Math.abs(e.dragEndY-e.dragStartY);a<2&&n<2&&i.lastx_!==void 0&&i.lastx_!==null&&ye.treatMouseOpAsClick(i,t,e),e.regionWidth=a,e.regionHeight=n};ye.startPan=function(t,i,e){var a,n;e.isPanning=!0;var r=i.xAxisRange();if(i.getOptionForAxis("logscale","x")?(e.initialLeftmostDate=we(r[0]),e.dateRange=we(r[1])-we(r[0])):(e.initialLeftmostDate=r[0],e.dateRange=r[1]-r[0]),e.xUnitsPerPixel=e.dateRange/(i.plotter_.area.w-1),i.getNumericOption("panEdgeFraction")){var c=i.width_*i.getNumericOption("panEdgeFraction"),d=i.xAxisExtremes(),m=i.toDomXCoord(d[0])-c,u=i.toDomXCoord(d[1])+c,v=i.toDataXCoord(m),f=i.toDataXCoord(u);e.boundedDates=[v,f];var y=[],_=i.height_*i.getNumericOption("panEdgeFraction");for(a=0;a<i.axes_.length;a++){n=i.axes_[a];var D=n.extremeRange,P=i.toDomYCoord(D[0],a)+_,R=i.toDomYCoord(D[1],a)-_,I=i.toDataYCoord(P,a),O=i.toDataYCoord(R,a);y[a]=[I,O]}e.boundedValues=y}else e.boundedDates=null,e.boundedValues=null;for(e.is2DPan=!1,e.axes=[],a=0;a<i.axes_.length;a++){n=i.axes_[a];var H={},z=i.yAxisRange(a),K=i.attributes_.getForAxis("logscale",a);K?(H.initialTopValue=we(z[1]),H.dragValueRange=we(z[1])-we(z[0])):(H.initialTopValue=z[1],H.dragValueRange=z[1]-z[0]),H.unitsPerPixel=H.dragValueRange/(i.plotter_.area.h-1),e.axes.push(H),n.valueRange&&(e.is2DPan=!0)}};ye.movePan=function(t,i,e){e.dragEndX=la(t,e),e.dragEndY=sa(t,e);var a=e.initialLeftmostDate-(e.dragEndX-e.dragStartX)*e.xUnitsPerPixel;e.boundedDates&&(a=Math.max(a,e.boundedDates[0]));var n=a+e.dateRange;if(e.boundedDates&&n>e.boundedDates[1]&&(a=a-(n-e.boundedDates[1]),n=a+e.dateRange),i.getOptionForAxis("logscale","x")?i.dateWindow_=[Math.pow(bi,a),Math.pow(bi,n)]:i.dateWindow_=[a,n],e.is2DPan)for(var r=e.dragEndY-e.dragStartY,c=0;c<i.axes_.length;c++){var d=i.axes_[c],m=e.axes[c],u=r*m.unitsPerPixel,v=e.boundedValues?e.boundedValues[c]:null,f=m.initialTopValue+u;v&&(f=Math.min(f,v[1]));var y=f-m.dragValueRange;v&&y<v[0]&&(f=f-(y-v[0]),y=f-m.dragValueRange),i.attributes_.getForAxis("logscale",c)?d.valueRange=[Math.pow(bi,y),Math.pow(bi,f)]:d.valueRange=[y,f]}i.drawGraph_(!1)};ye.endPan=ye.maybeTreatMouseOpAsClick;ye.startZoom=function(t,i,e){e.isZooming=!0,e.zoomMoved=!1};ye.moveZoom=function(t,i,e){e.zoomMoved=!0,e.dragEndX=la(t,e),e.dragEndY=sa(t,e);var a=Math.abs(e.dragStartX-e.dragEndX),n=Math.abs(e.dragStartY-e.dragEndY);e.dragDirection=a<n/2?aa:ia,i.drawZoomRect_(e.dragDirection,e.dragStartX,e.dragEndX,e.dragStartY,e.dragEndY,e.prevDragDirection,e.prevEndX,e.prevEndY),e.prevEndX=e.dragEndX,e.prevEndY=e.dragEndY,e.prevDragDirection=e.dragDirection};ye.treatMouseOpAsClick=function(t,i,e){for(var a=t.getFunctionOption("clickCallback"),n=t.getFunctionOption("pointClickCallback"),r=null,c=-1,d=Number.MAX_VALUE,m=0;m<t.selPoints_.length;m++){var u=t.selPoints_[m],v=Math.pow(u.canvasx-e.dragEndX,2)+Math.pow(u.canvasy-e.dragEndY,2);!isNaN(v)&&(c==-1||v<d)&&(d=v,c=m)}var f=t.getNumericOption("highlightCircleSize")+2;if(d<=f*f&&(r=t.selPoints_[c]),r){var _={cancelable:!0,point:r,canvasx:e.dragEndX,canvasy:e.dragEndY},y=t.cascadeEvents_("pointClick",_);if(y)return;n&&n.call(t,i,r)}var _={cancelable:!0,xval:t.lastx_,pts:t.selPoints_,canvasx:e.dragEndX,canvasy:e.dragEndY};t.cascadeEvents_("click",_)||a&&a.call(t,i,t.lastx_,t.selPoints_)};ye.endZoom=function(t,i,e){i.clearZoomRect_(),e.isZooming=!1,ye.maybeTreatMouseOpAsClick(t,i,e);var a=i.getArea();if(e.regionWidth>=10&&e.dragDirection==ia){var n=Math.min(e.dragStartX,e.dragEndX),r=Math.max(e.dragStartX,e.dragEndX);n=Math.max(n,a.x),r=Math.min(r,a.x+a.w),n<r&&i.doZoomX_(n,r),e.cancelNextDblclick=!0}else if(e.regionHeight>=10&&e.dragDirection==aa){var c=Math.min(e.dragStartY,e.dragEndY),d=Math.max(e.dragStartY,e.dragEndY);c=Math.max(c,a.y),d=Math.min(d,a.y+a.h),c<d&&i.doZoomY_(c,d),e.cancelNextDblclick=!0}e.dragStartX=null,e.dragStartY=null};ye.startTouch=function(t,i,e){t.preventDefault(),t.touches.length>1&&(e.startTimeForDoubleTapMs=null);for(var a=[],n=0;n<t.touches.length;n++){var r=t.touches[n],c=r.target.getBoundingClientRect();a.push({pageX:r.pageX,pageY:r.pageY,dataX:i.toDataXCoord(r.clientX-c.left),dataY:i.toDataYCoord(r.clientY-c.top)})}if(e.initialTouches=a,a.length==1)e.initialPinchCenter=a[0],e.touchDirections={x:!0,y:!0};else if(a.length>=2){e.initialPinchCenter={pageX:.5*(a[0].pageX+a[1].pageX),pageY:.5*(a[0].pageY+a[1].pageY),dataX:.5*(a[0].dataX+a[1].dataX),dataY:.5*(a[0].dataY+a[1].dataY)};var d=180/Math.PI*Math.atan2(e.initialPinchCenter.pageY-a[0].pageY,a[0].pageX-e.initialPinchCenter.pageX);d=Math.abs(d),d>90&&(d=90-d),e.touchDirections={x:d<90-45/2,y:d>45/2}}e.initialRange={x:i.xAxisRange(),y:i.yAxisRange()}};ye.moveTouch=function(t,i,e){e.startTimeForDoubleTapMs=null;var a,n=[];for(a=0;a<t.touches.length;a++){var r=t.touches[a];n.push({pageX:r.pageX,pageY:r.pageY})}var c=e.initialTouches,d,m=e.initialPinchCenter;n.length==1?d=n[0]:d={pageX:.5*(n[0].pageX+n[1].pageX),pageY:.5*(n[0].pageY+n[1].pageY)};var u={pageX:d.pageX-m.pageX,pageY:d.pageY-m.pageY},v=e.initialRange.x[1]-e.initialRange.x[0],f=e.initialRange.y[0]-e.initialRange.y[1];u.dataX=u.pageX/i.plotter_.area.w*v,u.dataY=u.pageY/i.plotter_.area.h*f;var y,_;if(n.length==1)y=1,_=1;else if(n.length>=2){var D=c[1].pageX-m.pageX;y=(n[1].pageX-d.pageX)/D;var P=c[1].pageY-m.pageY;_=(n[1].pageY-d.pageY)/P}y=Math.min(8,Math.max(.125,y)),_=Math.min(8,Math.max(.125,_));var R=!1;if(e.touchDirections.x){var I=m.dataX-u.dataX/y;i.dateWindow_=[I+(e.initialRange.x[0]-m.dataX)/y,I+(e.initialRange.x[1]-m.dataX)/y],R=!0}if(e.touchDirections.y)for(a=0;a<1;a++){var O=i.axes_[a],H=i.attributes_.getForAxis("logscale",a);if(!H){var I=m.dataY-u.dataY/_;O.valueRange=[I+(e.initialRange.y[0]-m.dataY)/_,I+(e.initialRange.y[1]-m.dataY)/_],R=!0}}if(i.drawGraph_(!1),R&&n.length>1&&i.getFunctionOption("zoomCallback")){var z=i.xAxisRange();i.getFunctionOption("zoomCallback").call(i,z[0],z[1],i.yAxisRanges())}};ye.endTouch=function(t,i,e){if(t.touches.length!==0)ye.startTouch(t,i,e);else if(t.changedTouches.length==1){var a=new Date().getTime(),n=t.changedTouches[0];e.startTimeForDoubleTapMs&&a-e.startTimeForDoubleTapMs<500&&e.doubleTapX&&Math.abs(e.doubleTapX-n.screenX)<50&&e.doubleTapY&&Math.abs(e.doubleTapY-n.screenY)<50?i.resetZoom():(e.startTimeForDoubleTapMs=a,e.doubleTapX=n.screenX,e.doubleTapY=n.screenY)}};var Hl=function(t,i,e){return t<i?i-t:t>e?t-e:0},T0=function(t,i){var e=ui(i.canvas_),a={left:e.x,right:e.x+i.canvas_.offsetWidth,top:e.y,bottom:e.y+i.canvas_.offsetHeight},n={x:ra(t),y:oa(t)},r=Hl(n.x,a.left,a.right),c=Hl(n.y,a.top,a.bottom);return Math.max(r,c)};ye.defaultModel={mousedown:function(t,i,e){if(!(t.button&&t.button==2)){e.initializeMouseDown(t,i,e),t.altKey||t.shiftKey?ye.startPan(t,i,e):ye.startZoom(t,i,e);var a=function(r){if(e.isZooming){var c=T0(r,i);c<w0?ye.moveZoom(r,i,e):e.dragEndX!==null&&(e.dragEndX=null,e.dragEndY=null,i.clearZoomRect_())}else e.isPanning&&ye.movePan(r,i,e)},n=function(r){e.isZooming?e.dragEndX!==null?ye.endZoom(r,i,e):ye.maybeTreatMouseOpAsClick(r,i,e):e.isPanning&&ye.endPan(r,i,e),Et(document,"mousemove",a),Et(document,"mouseup",n),e.destroy()};i.addAndTrackEvent(document,"mousemove",a),i.addAndTrackEvent(document,"mouseup",n)}},willDestroyContextMyself:!0,touchstart:function(t,i,e){ye.startTouch(t,i,e)},touchmove:function(t,i,e){ye.moveTouch(t,i,e)},touchend:function(t,i,e){ye.endTouch(t,i,e)},dblclick:function(t,i,e){if(e.cancelNextDblclick){e.cancelNextDblclick=!1;return}var a={canvasx:e.dragEndX,canvasy:e.dragEndY,cancelable:!0};i.cascadeEvents_("dblclick",a)||t.altKey||t.shiftKey||i.resetZoom()}};ye.nonInteractiveModel_={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e)},mouseup:ye.maybeTreatMouseOpAsClick};ye.dragIsPanInteractionModel={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e),ye.startPan(t,i,e)},mousemove:function(t,i,e){e.isPanning&&ye.movePan(t,i,e)},mouseup:function(t,i,e){e.isPanning&&ye.endPan(t,i,e)}};var kt=ye;var D0={highlightCircleSize:3,highlightSeriesOpts:null,highlightSeriesBackgroundAlpha:.5,highlightSeriesBackgroundColor:"rgb(255, 255, 255)",labelsSeparateLines:!1,labelsShowZeroValues:!0,labelsKMB:!1,labelsKMG2:!1,showLabelsOnHighlight:!0,digitsAfterDecimal:2,maxNumberWidth:6,sigFigs:null,strokeWidth:1,strokeBorderWidth:0,strokeBorderColor:"white",axisTickSize:3,axisLabelFontSize:14,rightGap:5,showRoller:!1,xValueParser:void 0,delimiter:",",sigma:2,errorBars:!1,fractions:!1,wilsonInterval:!0,customBars:!1,fillGraph:!1,fillAlpha:.15,connectSeparatedPoints:!1,stackedGraph:!1,stackedGraphNaNFill:"all",hideOverlayOnMouseOut:!0,resizable:"no",legend:"onmouseover",legendFollowOffsetX:50,legendFollowOffsetY:-50,stepPlot:!1,xRangePad:0,yRangePad:null,drawAxesAtZero:!1,titleHeight:28,xLabelHeight:18,yLabelWidth:18,axisLineColor:"black",axisLineWidth:.3,gridLineWidth:.3,axisLabelWidth:50,gridLineColor:"rgb(128,128,128)",interactionModel:kt.defaultModel,animatedZooms:!1,animateBackgroundFade:!0,showRangeSelector:!1,rangeSelectorHeight:40,rangeSelectorPlotStrokeColor:"#808FAB",rangeSelectorPlotFillGradientColor:"white",rangeSelectorPlotFillColor:"#A7B1C4",rangeSelectorBackgroundStrokeColor:"gray",rangeSelectorBackgroundLineWidth:1,rangeSelectorPlotLineWidth:1.5,rangeSelectorForegroundStrokeColor:"black",rangeSelectorForegroundLineWidth:1,rangeSelectorAlpha:.6,showInRangeSelector:null,plotter:[Di._fillPlotter,Di._errorPlotter,Di._linePlotter],plugins:[],axes:{x:{pixelsPerLabel:70,axisLabelWidth:60,axisLabelFormatter:Ti,valueFormatter:da,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:Ci},y:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:gr,axisLabelFormatter:Ra,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:ai},y2:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:gr,axisLabelFormatter:Ra,drawAxis:!0,drawGrid:!1,independentTicks:!1,ticker:ai}}},ua=D0;var dt=function(t){this.dygraph_=t,this.yAxes_=[],this.xAxis_={},this.series_={},this.global_=this.dygraph_.attrs_,this.user_=this.dygraph_.user_attrs_||{},this.labels_=[],this.highlightSeries_=this.get("highlightSeriesOpts")||{},this.reparseSeries()};dt.AXIS_STRING_MAPPINGS_={y:0,Y:0,y1:0,Y1:0,y2:1,Y2:1};dt.axisToIndex_=function(t){if(typeof t=="string"){if(dt.AXIS_STRING_MAPPINGS_.hasOwnProperty(t))return dt.AXIS_STRING_MAPPINGS_[t];throw"Unknown axis : "+t}if(typeof t=="number"){if(t===0||t===1)return t;throw"Dygraphs only supports two y-axes, indexed from 0-1."}if(t)throw"Unknown axis : "+t;return 0};dt.prototype.reparseSeries=function(){var t=this.get("labels");if(t){this.labels_=t.slice(1),this.yAxes_=[{series:[],options:{}}],this.xAxis_={options:{}},this.series_={};for(var i=this.user_.series||{},e=0;e<this.labels_.length;e++){var a=this.labels_[e],n=i[a]||{},r=dt.axisToIndex_(n.axis);this.series_[a]={idx:e,yAxis:r,options:n},this.yAxes_[r]?this.yAxes_[r].series.push(a):this.yAxes_[r]={series:[a],options:{}}}var c=this.user_.axes||{};xt(this.yAxes_[0].options,c.y||{}),this.yAxes_.length>1&&xt(this.yAxes_[1].options,c.y2||{}),xt(this.xAxis_.options,c.x||{}),typeof process<"u"}};dt.prototype.get=function(t){var i=this.getGlobalUser_(t);return i!==null?i:this.getGlobalDefault_(t)};dt.prototype.getGlobalUser_=function(t){return this.user_.hasOwnProperty(t)?this.user_[t]:null};dt.prototype.getGlobalDefault_=function(t){return this.global_.hasOwnProperty(t)?this.global_[t]:ua.hasOwnProperty(t)?ua[t]:null};dt.prototype.getForAxis=function(t,i){var e,a;if(typeof i=="number")e=i,a=e===0?"y":"y2";else{if(i=="y1"&&(i="y"),i=="y")e=0;else if(i=="y2")e=1;else if(i=="x")e=-1;else throw"Unknown axis "+i;a=i}var n=e==-1?this.xAxis_:this.yAxes_[e];if(n){var r=n.options;if(r.hasOwnProperty(t))return r[t]}if(!(i==="x"&&t==="logscale")){var c=this.getGlobalUser_(t);if(c!==null)return c}var d=ua.axes[a];return d.hasOwnProperty(t)?d[t]:this.getGlobalDefault_(t)};dt.prototype.getForSeries=function(t,i){if(i===this.dygraph_.getHighlightSeries()&&this.highlightSeries_.hasOwnProperty(t))return this.highlightSeries_[t];if(!this.series_.hasOwnProperty(i))throw"Unknown series: "+i;var e=this.series_[i],a=e.options;return a.hasOwnProperty(t)?a[t]:this.getForAxis(t,e.yAxis)};dt.prototype.numAxes=function(){return this.yAxes_.length};dt.prototype.axisForSeries=function(t){return this.series_[t].yAxis};dt.prototype.axisOptions=function(t){return this.yAxes_[t].options};dt.prototype.seriesForAxis=function(t){return this.yAxes_[t].series};dt.prototype.seriesNames=function(){return this.labels_};var Yl=dt;function fo(){this.tarps=[]}fo.prototype.cover=function(){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++){var e=t[i],a=ui(e),n=a.x,r=a.y,c=e.offsetWidth,d=e.offsetHeight,m=document.createElement("div");m.style.position="absolute",m.style.left=n+"px",m.style.top=r+"px",m.style.width=c+"px",m.style.height=d+"px",m.style.zIndex=999,document.body.appendChild(m),this.tarps.push(m)}};fo.prototype.uncover=function(){for(var t=0;t<this.tarps.length;t++)this.tarps[t].parentNode.removeChild(this.tarps[t]);this.tarps=[]};var vr=fo;var Gl=function(){},Ft=Gl;Ft.X=0;Ft.Y=1;Ft.EXTRAS=2;Ft.prototype.extractSeries=function(t,i,e){};Ft.prototype.seriesToPoints=function(t,i,e){for(var a=[],n=0;n<t.length;++n){var r=t[n],c=r[1],d=c===null?null:Ft.parseFloat(c),m={x:NaN,y:NaN,xval:Ft.parseFloat(r[0]),yval:d,name:i,idx:n+e,canvasx:NaN,canvasy:NaN};a.push(m)}return this.onPointsCreated_(t,a),a};Ft.prototype.onPointsCreated_=function(t,i){};Ft.prototype.rollingAverage=function(t,i,e,a){};Ft.prototype.getExtremeYValues=function(t,i,e){};Ft.prototype.onLineEvaluated=function(t,i,e){};Ft.parseFloat=function(t){return t===null?NaN:t};var Pi=Gl;var La=function(){};La.prototype=new Pi;La.prototype.extractSeries=function(t,i,e){var a=[];let n=e.get("labels")[i],r=e.getForSeries("logscale",n);for(var c=0;c<t.length;c++){var d=t[c][0],m=t[c][i];r&&m<=0&&(m=null),a.push([d,m])}return a};La.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,c,d,m,u;if(i==1)return t;for(r=0;r<t.length;r++){for(m=0,u=0,c=Math.max(0,r-i+1);c<r+1;c++)d=t[c][1],!(d===null||isNaN(d))&&(u++,m+=t[c][1]);u?n[r]=[t[r][0],m/u]:n[r]=[t[r][0],null]}return n};La.prototype.getExtremeYValues=function(i,e,a){for(var n=null,r=null,c,d=0,m=i.length-1,u=d;u<=m;u++)c=i[u][1],!(c===null||isNaN(c))&&((r===null||c>r)&&(r=c),(n===null||c<n)&&(n=c));return[n,r]};var Oa=La;var Ei=function(){Pi.call(this)};Ei.prototype=new Pi;Ei.prototype.extractSeries=function(t,i,e){};Ei.prototype.rollingAverage=function(t,i,e,a){};Ei.prototype.onPointsCreated_=function(t,i){for(var e=0;e<t.length;++e){var a=t[e],n=i[e];n.y_top=NaN,n.y_bottom=NaN,n.yval_minus=Pi.parseFloat(a[2][0]),n.yval_plus=Pi.parseFloat(a[2][1])}};Ei.prototype.getExtremeYValues=function(t,i,e){for(var a=null,n=null,r,c=0,d=t.length-1,m=c;m<=d;m++)if(r=t[m][1],!(r===null||isNaN(r))){var u=t[m][2][0],v=t[m][2][1];u>r&&(u=r),v<r&&(v=r),(n===null||v>n)&&(n=v),(a===null||u<a)&&(a=u)}return[a,n]};Ei.prototype.onLineEvaluated=function(t,i,e){for(var a,n=0;n<t.length;n++)a=t[n],a.y_top=Ia.calcYNormal_(i,a.yval_minus,e),a.y_bottom=Ia.calcYNormal_(i,a.yval_plus,e)};var hi=Ei;var yr=function(){};yr.prototype=new hi;yr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d;let m=e.get("labels")[i],u=e.getForSeries("logscale",m),v=e.getForSeries("sigma",m);for(var f=0;f<t.length;f++)n=t[f][0],d=t[f][i],u&&d!==null&&(d[0]<=0||d[0]-v*d[1]<=0)&&(d=null),d!==null?(r=d[0],r!==null&&!isNaN(r)?(c=v*d[1],a.push([n,r,[r-c,r+c,d[1]]])):a.push([n,r,[r,r,r]])):a.push([n,null,[null,null,null]]);return a};yr.prototype.rollingAverage=function(t,i,e,d){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[d],c=e.getForSeries("sigma",r);var d,m,u,v,f,y,_,D,P;for(d=0;d<t.length;d++){for(f=0,D=0,y=0,m=Math.max(0,d-i+1);m<d+1;m++)u=t[m][1],!(u===null||isNaN(u))&&(y++,f+=u,D+=Math.pow(t[m][2][2],2));y?(_=Math.sqrt(D)/y,P=f/y,n[d]=[t[d][0],P,[P-c*_,P+c*_]]):(v=i==1?t[d][1]:null,n[d]=[t[d][0],v,[v,v]])}return n};var _o=yr;var Cr=function(){};Cr.prototype=new hi;Cr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c;let d=e.get("labels")[i],m=e.getForSeries("logscale",d);for(var u=0;u<t.length;u++)n=t[u][0],c=t[u][i],m&&c!==null&&(c[0]<=0||c[1]<=0||c[2]<=0)&&(c=null),c!==null?(r=c[1],r!==null&&!isNaN(r)?a.push([n,r,[c[0],c[2]]]):a.push([n,r,[r,r]])):a.push([n,null,[null,null]]);return a};Cr.prototype.rollingAverage=function(t,i,e,v){i=Math.min(i,t.length);var n=[],r,c,d,m,u,v,f;for(c=0,m=0,d=0,u=0,v=0;v<t.length;v++){if(r=t[v][1],f=t[v][2],n[v]=t[v],r!==null&&!isNaN(r)&&(c+=f[0],m+=r,d+=f[1],u+=1),v-i>=0){var y=t[v-i];y[1]!==null&&!isNaN(y[1])&&(c-=y[2][0],m-=y[1],d-=y[2][1],u-=1)}u?n[v]=[t[v][0],1*m/u,[1*c/u,1*d/u]]:n[v]=[t[v][0],null,[null,null]]}return n};var go=Cr;var xr=function(){};xr.prototype=new Oa;xr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d,m,u,v=100;let f=e.get("labels")[i],y=e.getForSeries("logscale",f);for(var _=0;_<t.length;_++)n=t[_][0],c=t[_][i],y&&c!==null&&(c[0]<=0||c[1]<=0)&&(c=null),c!==null?(d=c[0],m=c[1],d!==null&&!isNaN(d)?(u=m?d/m:0,r=v*u,a.push([n,r,[d,m]])):a.push([n,d,[d,m]])):a.push([n,null,[null,null]]);return a};xr.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,c=0,d=0,m=100;for(r=0;r<t.length;r++){c+=t[r][2][0],d+=t[r][2][1],r-i>=0&&(c-=t[r-i][2][0],d-=t[r-i][2][1]);var u=t[r][0],v=d?c/d:0;n[r]=[u,m*v]}return n};var vo=xr;var br=function(){};br.prototype=new hi;br.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d,m,u,v,f,y=100;let _=e.get("labels")[i],D=e.getForSeries("logscale",_),P=e.getForSeries("sigma",_);for(var R=0;R<t.length;R++)n=t[R][0],c=t[R][i],D&&c!==null&&(c[0]<=0||c[1]<=0)&&(c=null),c!==null?(d=c[0],m=c[1],d!==null&&!isNaN(d)?(u=m?d/m:0,v=m?P*Math.sqrt(u*(1-u)/m):1,f=y*v,r=y*u,a.push([n,r,[r-f,r+f,d,m]])):a.push([n,d,[d,d,d,m]])):a.push([n,null,[null,null,null,null]]);return a};br.prototype.rollingAverage=function(t,i,e,v){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[v],c=e.getForSeries("sigma",r),d=e.getForSeries("wilsonInterval",r);var m,u,v,f,y=0,_=0,D=100;for(v=0;v<t.length;v++){y+=t[v][2][2],_+=t[v][2][3],v-i>=0&&(y-=t[v-i][2][2],_-=t[v-i][2][3]);var P=t[v][0],R=_?y/_:0;if(d)if(_){var I=R<0?0:R,O=_,H=c*Math.sqrt(I*(1-I)/O+c*c/(4*O*O)),z=1+c*c/_;m=(I+c*c/(2*_)-H)/z,u=(I+c*c/(2*_)+H)/z,n[v]=[P,I*D,[m*D,u*D]]}else n[v]=[P,0,[0,0]];else f=_?c*Math.sqrt(R*(1-R)/_):1,n[v]=[P,D*R,[D*(R-f),D*(R+f)]]}return n};var yo=br;var ki=function(){this.annotations_=[]};ki.prototype.toString=function(){return"Annotations Plugin"};ki.prototype.activate=function(t){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}};ki.prototype.detachLabels=function(){for(var t=0;t<this.annotations_.length;t++){var i=this.annotations_[t];i.parentNode&&i.parentNode.removeChild(i),this.annotations_[t]=null}this.annotations_=[]};ki.prototype.clearChart=function(t){this.detachLabels()};ki.prototype.didDrawChart=function(t){var i=t.dygraph,e=i.layout_.annotated_points;if(!(!e||e.length===0))for(var a=t.canvas.parentNode,n=function(z,K,Ae){return function(W){var J=Ae.annotation;J.hasOwnProperty(z)?J[z](J,Ae,i,W):i.getOption(K)&&i.getOption(K)(J,Ae,i,W)}},r=t.dygraph.getArea(),c={},d=0;d<e.length;d++){var m=e[d];if(!(m.canvasx<r.x||m.canvasx>r.x+r.w||m.canvasy<r.y||m.canvasy>r.y+r.h)){var u=m.annotation,v=6;u.hasOwnProperty("tickHeight")&&(v=u.tickHeight);var f=document.createElement("div");f.style.fontSize=i.getOption("axisLabelFontSize")+"px";var y="dygraph-annotation";u.hasOwnProperty("icon")||(y+=" dygraphDefaultAnnotation dygraph-default-annotation"),u.hasOwnProperty("cssClass")&&(y+=" "+u.cssClass),f.className=y;var _=u.hasOwnProperty("width")?u.width:16,D=u.hasOwnProperty("height")?u.height:16;if(u.hasOwnProperty("icon")){var P=document.createElement("img");P.src=u.icon,P.width=_,P.height=D,f.appendChild(P)}else m.annotation.hasOwnProperty("shortText")&&f.appendChild(document.createTextNode(m.annotation.shortText));var R=m.canvasx-_/2;f.style.left=R+"px";var I=0;if(u.attachAtBottom){var O=r.y+r.h-D-v;c[R]?O-=c[R]:c[R]=0,c[R]+=v+D,I=O}else I=m.canvasy-D-v;f.style.top=I+"px",f.style.width=_+"px",f.style.height=D+"px",f.title=m.annotation.text,f.style.color=i.colorsMap_[m.name],f.style.borderColor=i.colorsMap_[m.name],u.div=f,i.addAndTrackEvent(f,"click",n("clickHandler","annotationClickHandler",m,this)),i.addAndTrackEvent(f,"mouseover",n("mouseOverHandler","annotationMouseOverHandler",m,this)),i.addAndTrackEvent(f,"mouseout",n("mouseOutHandler","annotationMouseOutHandler",m,this)),i.addAndTrackEvent(f,"dblclick",n("dblClickHandler","annotationDblClickHandler",m,this)),a.appendChild(f),this.annotations_.push(f);var H=t.drawingContext;if(H.save(),H.strokeStyle=u.hasOwnProperty("tickColor")?u.tickColor:i.colorsMap_[m.name],H.lineWidth=u.hasOwnProperty("tickWidth")?u.tickWidth:i.getOption("strokeWidth"),H.beginPath(),!u.attachAtBottom)H.moveTo(m.canvasx,m.canvasy),H.lineTo(m.canvasx,m.canvasy-2-v);else{var O=I+D;H.moveTo(m.canvasx,O),H.lineTo(m.canvasx,O+v)}H.closePath(),H.stroke(),H.restore()}}};ki.prototype.destroy=function(){this.detachLabels()};var Co=ki;var Ai=function(){this.xlabels_=[],this.ylabels_=[]};Ai.prototype.toString=function(){return"Axes Plugin"};Ai.prototype.activate=function(t){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}};Ai.prototype.layout=function(t){var i=t.dygraph;if(i.getOptionForAxis("drawAxis","y")){var e=i.getOptionForAxis("axisLabelWidth","y")+2*i.getOptionForAxis("axisTickSize","y");t.reserveSpaceLeft(e)}if(i.getOptionForAxis("drawAxis","x")){var a;i.getOption("xAxisHeight")?a=i.getOption("xAxisHeight"):a=i.getOptionForAxis("axisLabelFontSize","x")+2*i.getOptionForAxis("axisTickSize","x"),t.reserveSpaceBottom(a)}if(i.numAxes()==2){if(i.getOptionForAxis("drawAxis","y2")){var e=i.getOptionForAxis("axisLabelWidth","y2")+2*i.getOptionForAxis("axisTickSize","y2");t.reserveSpaceRight(e)}}else i.numAxes()>2&&i.error("Only two y-axes are supported at this time. (Trying to use "+i.numAxes()+")")};Ai.prototype.detachLabels=function(){function t(i){for(var e=0;e<i.length;e++){var a=i[e];a.parentNode&&a.parentNode.removeChild(a)}}t(this.xlabels_),t(this.ylabels_),this.xlabels_=[],this.ylabels_=[]};Ai.prototype.clearChart=function(t){this.detachLabels()};Ai.prototype.willDrawChart=function(t){var i=t.dygraph;if(!i.getOptionForAxis("drawAxis","x")&&!i.getOptionForAxis("drawAxis","y")&&!i.getOptionForAxis("drawAxis","y2"))return;function e(j){return Math.round(j)+.5}function a(j){return Math.round(j)-.5}var n=t.drawingContext,r=t.canvas.parentNode,c=i.width_,d=i.height_,m,u,v,f,y,_=function(j){return{position:"absolute",fontSize:i.getOptionForAxis("axisLabelFontSize",j)+"px",width:i.getOptionForAxis("axisLabelWidth",j)+"px"}},D={x:_("x"),y:_("y"),y2:_("y2")},P=function(j,pe,mt){var Ve=document.createElement("div"),Pt=D[mt=="y2"?"y2":pe];xt(Ve.style,Pt);var Xe=document.createElement("div");return Xe.className="dygraph-axis-label dygraph-axis-label-"+pe+(mt?" dygraph-axis-label-"+mt:""),Xe.innerHTML=j,Ve.appendChild(Xe),Ve};n.save();var R=i.layout_,I=t.dygraph.plotter_.area,O=function(j){return function(pe){return i.getOptionForAxis(pe,j)}};let H=this;if(i.getOptionForAxis("drawAxis","y")||i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")){if(R.yticks&&R.yticks.length>0){var z=i.numAxes(),K=[O("y"),O("y2")];R.yticks.forEach(function(j){if(j.label!==void 0){u=I.x;var pe=1,mt="y1",Ve=K[0];if(j.axis==1&&(u=I.x+I.w,pe=-1,mt="y2",Ve=K[1]),!!Ve("drawAxis")){var Pt=Ve("axisLabelFontSize");v=I.y+j.pos*I.h,m=P(j.label,"y",z==2?mt:null);var Xe=v-Pt/2;Xe<0&&(Xe=0),Xe+Pt+3>d?m.style.bottom="0":m.style.top=Math.min(Xe,d-2*Pt)+"px",j.axis===0?(m.style.left=I.x-Ve("axisLabelWidth")-Ve("axisTickSize")+"px",m.style.textAlign="right"):j.axis==1&&(m.style.left=I.x+I.w+Ve("axisTickSize")+"px",m.style.textAlign="left"),m.style.width=Ve("axisLabelWidth")+"px",r.appendChild(m),H.ylabels_.push(m)}}})}var Ae;if(i.getOption("drawAxesAtZero")){var W=i.toPercentXCoord(0);(W>1||W<0||isNaN(W))&&(W=0),Ae=e(I.x+W*I.w)}else Ae=e(I.x);n.strokeStyle=i.getOptionForAxis("axisLineColor","y"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y"),n.beginPath(),n.moveTo(Ae,a(I.y)),n.lineTo(Ae,a(I.y+I.h)),n.closePath(),n.stroke(),i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")&&(n.strokeStyle=i.getOptionForAxis("axisLineColor","y2"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y2"),n.beginPath(),n.moveTo(a(I.x+I.w),a(I.y)),n.lineTo(a(I.x+I.w),a(I.y+I.h)),n.closePath(),n.stroke())}if(i.getOptionForAxis("drawAxis","x")){if(R.xticks){var J=O("x");R.xticks.forEach(function(j){if(j.label!==void 0){u=I.x+j.pos*I.w,v=I.y+I.h,m=P(j.label,"x"),m.style.textAlign="center",m.style.top=v+J("axisTickSize")+"px";var pe=u-J("axisLabelWidth")/2;pe+J("axisLabelWidth")>c&&(pe=c-J("axisLabelWidth"),m.style.textAlign="right"),pe<0&&(pe=0,m.style.textAlign="left"),m.style.left=pe+"px",m.style.width=J("axisLabelWidth")+"px",r.appendChild(m),H.xlabels_.push(m)}})}n.strokeStyle=i.getOptionForAxis("axisLineColor","x"),n.lineWidth=i.getOptionForAxis("axisLineWidth","x"),n.beginPath();var ue;if(i.getOption("drawAxesAtZero")){var W=i.toPercentYCoord(0,0);(W>1||W<0)&&(W=1),ue=a(I.y+W*I.h)}else ue=a(I.y+I.h);n.moveTo(e(I.x),ue),n.lineTo(e(I.x+I.w),ue),n.closePath(),n.stroke()}n.restore()};var xo=Ai;var fi=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};fi.prototype.toString=function(){return"ChartLabels Plugin"};fi.prototype.activate=function(t){return{layout:this.layout,didDrawChart:this.didDrawChart}};var Ul=function(t){var i=document.createElement("div");return i.style.position="absolute",i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.width=t.w+"px",i.style.height=t.h+"px",i};fi.prototype.detachLabels_=function(){for(var t=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],i=0;i<t.length;i++){var e=t[i];e&&e.parentNode&&e.parentNode.removeChild(e)}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var zl=function(t,i,e,a,n){var r=document.createElement("div");r.style.position="absolute",e==1?r.style.left="0px":r.style.left=i.x+"px",r.style.top=i.y+"px",r.style.width=i.w+"px",r.style.height=i.h+"px",r.style.fontSize=t.getOption("yLabelWidth")-2+"px";var c=document.createElement("div");c.style.position="absolute",c.style.width=i.h+"px",c.style.height=i.w+"px",c.style.top=i.h/2-i.w/2+"px",c.style.left=i.w/2-i.h/2+"px",c.className="dygraph-label-rotate-"+(e==1?"right":"left");var d=document.createElement("div");return d.className=a,d.innerHTML=n,c.appendChild(d),r.appendChild(c),r};fi.prototype.layout=function(t){this.detachLabels_();var i=t.dygraph,e=t.chart_div;if(i.getOption("title")){var a=t.reserveSpaceTop(i.getOption("titleHeight"));this.title_div_=Ul(a),this.title_div_.style.fontSize=i.getOption("titleHeight")-8+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-title",n.innerHTML=i.getOption("title"),this.title_div_.appendChild(n),e.appendChild(this.title_div_)}if(i.getOption("xlabel")){var r=t.reserveSpaceBottom(i.getOption("xLabelHeight"));this.xlabel_div_=Ul(r),this.xlabel_div_.style.fontSize=i.getOption("xLabelHeight")-2+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-xlabel",n.innerHTML=i.getOption("xlabel"),this.xlabel_div_.appendChild(n),e.appendChild(this.xlabel_div_)}if(i.getOption("ylabel")){var c=t.reserveSpaceLeft(0);this.ylabel_div_=zl(i,c,1,"dygraph-label dygraph-ylabel",i.getOption("ylabel")),e.appendChild(this.ylabel_div_)}if(i.getOption("y2label")&&i.numAxes()==2){var d=t.reserveSpaceRight(0);this.y2label_div_=zl(i,d,2,"dygraph-label dygraph-y2label",i.getOption("y2label")),e.appendChild(this.y2label_div_)}};fi.prototype.didDrawChart=function(t){var i=t.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=i.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=i.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=i.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=i.getOption("y2label"))};fi.prototype.clearChart=function(){};fi.prototype.destroy=function(){this.detachLabels_()};var bo=fi;var Va=function(){};Va.prototype.toString=function(){return"Gridline Plugin"};Va.prototype.activate=function(t){return{willDrawChart:this.willDrawChart}};Va.prototype.willDrawChart=function(t){var i=t.dygraph,e=t.drawingContext,a=i.layout_,n=t.dygraph.plotter_.area;function r(I){return Math.round(I)+.5}function c(I){return Math.round(I)-.5}var d,m,u,v;if(i.getOptionForAxis("drawGrid","y")){for(var f=["y","y2"],y=[],_=[],D=[],P=[],R=[],u=0;u<f.length;u++)D[u]=i.getOptionForAxis("drawGrid",f[u]),D[u]&&(y[u]=i.getOptionForAxis("gridLineColor",f[u]),_[u]=i.getOptionForAxis("gridLineWidth",f[u]),R[u]=i.getOptionForAxis("gridLinePattern",f[u]),P[u]=R[u]&&R[u].length>=2);v=a.yticks,e.save(),v.forEach(I=>{if(I.has_tick){var O=I.axis;D[O]&&(e.save(),P[O]&&e.setLineDash&&e.setLineDash(R[O]),e.strokeStyle=y[O],e.lineWidth=_[O],d=r(n.x),m=c(n.y+I.pos*n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d+n.w,m),e.stroke(),e.restore())}}),e.restore()}if(i.getOptionForAxis("drawGrid","x")){v=a.xticks,e.save();var R=i.getOptionForAxis("gridLinePattern","x"),P=R&&R.length>=2;P&&e.setLineDash&&e.setLineDash(R),e.strokeStyle=i.getOptionForAxis("gridLineColor","x"),e.lineWidth=i.getOptionForAxis("gridLineWidth","x"),v.forEach(H=>{H.has_tick&&(d=r(n.x+H.pos*n.w),m=c(n.y+n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d,n.y),e.stroke())}),P&&e.setLineDash&&e.setLineDash([]),e.restore()}};Va.prototype.destroy=function(){};var So=Va;var At=function(){this.legend_div_=null,this.is_generated_div_=!1};At.prototype.toString=function(){return"Legend Plugin"};At.prototype.activate=function(t){var i,e=t.getOption("labelsDiv");return e&&e!==null?typeof e=="string"||e instanceof String?i=document.getElementById(e):i=e:(i=document.createElement("div"),i.className="dygraph-legend",t.graphDiv.appendChild(i),this.is_generated_div_=!0),this.legend_div_=i,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var P0=function(t){var i=document.createElement("span");i.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),t.appendChild(i);var e=i.offsetWidth;return t.removeChild(i),e},E0=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&#34;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};At.prototype.select=function(t){var i=t.selectedX,e=t.selectedPoints,a=t.selectedRow,n=t.dygraph.getOption("legend");if(n==="never"){this.legend_div_.style.display="none";return}var r=At.generateLegendHTML(t.dygraph,i,e,this.one_em_width_,a);if(r instanceof Node&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(r)):this.legend_div_.innerHTML=r,this.legend_div_.style.display="",n==="follow"){var c=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth,m=t.dygraph.getOptionForAxis("axisLabelWidth","y"),u=t.dygraph.getHighlightSeries(),v;u?(v=e.find(P=>P.name===u),v||(v=e[0])):v=e[0];let _=t.dygraph.getNumericOption("legendFollowOffsetX"),D=t.dygraph.getNumericOption("legendFollowOffsetY");var f=v.x*c.w+_,y=v.y*c.h+D;f+d+1>c.w&&(f=f-2*_-d-(m-c.x)),this.legend_div_.style.left=m+f+"px",this.legend_div_.style.top=y+"px"}else if(n==="onmouseover"&&this.is_generated_div_){var c=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth;this.legend_div_.style.left=c.x+c.w-d-1+"px",this.legend_div_.style.top=c.y+"px"}};At.prototype.deselect=function(t){var i=t.dygraph.getOption("legend");i!=="always"&&(this.legend_div_.style.display="none");var e=P0(this.legend_div_);this.one_em_width_=e;var a=At.generateLegendHTML(t.dygraph,void 0,void 0,e,null);a instanceof Node&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(a)):this.legend_div_.innerHTML=a};At.prototype.didDrawChart=function(t){this.deselect(t)};At.prototype.predraw=function(t){if(this.is_generated_div_){t.dygraph.graphDiv.appendChild(this.legend_div_);var i=t.dygraph.plotter_.area,e=this.legend_div_.offsetWidth;this.legend_div_.style.left=i.x+i.w-e-1+"px",this.legend_div_.style.top=i.y+"px"}};At.prototype.destroy=function(){this.legend_div_=null};At.generateLegendHTML=function(t,i,e,a,n){var r={dygraph:t,x:i,i:n,series:[]},c={},d=t.getLabels();if(d)for(var m=1;m<d.length;m++){var u=t.getPropertiesForSeries(d[m]),v=t.getOption("strokePattern",d[m]),f={dashHTML:k0(v,u.color,a),label:d[m],labelHTML:E0(d[m]),isVisible:u.visible,color:u.color};r.series.push(f),c[d[m]]=f}if(typeof i<"u"){var y=t.optionsViewForAxis_("x"),_=y("valueFormatter");r.xHTML=_.call(t,i,y,d[0],t,n,0);for(var D=[],P=t.numAxes(),m=0;m<P;m++)D[m]=t.optionsViewForAxis_("y"+(m?1+m:""));var R=t.getOption("labelsShowZeroValues"),I=t.getHighlightSeries();for(m=0;m<e.length;m++){var O=e[m],f=c[O.name];if(f.y=O.yval,O.yval===0&&!R||isNaN(O.canvasy)){f.isVisible=!1;continue}var u=t.getPropertiesForSeries(O.name),H=D[u.axis-1],z=H("valueFormatter"),K=z.call(t,O.yval,H,O.name,t,n,d.indexOf(O.name));xt(f,{yHTML:K}),O.name==I&&(f.isHighlighted=!0)}}var Ae=t.getOption("legendFormatter")||At.defaultFormatter;return Ae.call(t,r)};At.defaultFormatter=function(t){var i=t.dygraph;if(i.getOption("showLabelsOnHighlight")!==!0)return"";var e=i.getOption("labelsSeparateLines"),a;if(typeof t.x>"u"){if(i.getOption("legend")!="always")return"";a="";for(var n=0;n<t.series.length;n++){var r=t.series[n];r.isVisible&&(a!==""&&(a+=e?"<br />":" "),a+=`<span style='font-weight: bold; color: ${r.color};'>${r.dashHTML} ${r.labelHTML}</span>`)}return a}a=t.xHTML+":";for(var n=0;n<t.series.length;n++){var r=t.series[n];if(!(!r.y&&!r.yHTML)&&r.isVisible){e&&(a+="<br>");var c=r.isHighlighted?' class="highlight"':"";a+=`<span${c}> <b><span style='color: ${r.color};'>${r.labelHTML}</span></b>:&#160;${r.yHTML}</span>`}}return a};function k0(t,i,e){if(!t||t.length<=1)return`<div class="dygraph-legend-line" style="border-bottom-color: ${i};"></div>`;var a,n,r,c,d=0,m=0,u=[],v;for(a=0;a<=t.length;a++)d+=t[a%t.length];if(v=Math.floor(e/(d-t[0])),v>1){for(a=0;a<t.length;a++)u[a]=t[a]/e;m=u.length}else{for(v=1,a=0;a<t.length;a++)u[a]=t[a]/d;m=u.length+1}var f="";for(n=0;n<v;n++)for(a=0;a<m;a+=2)r=u[a%u.length],a<t.length?c=u[(a+1)%u.length]:c=0,f+=`<div class="dygraph-legend-dash" style="margin-right: ${c}em; padding-left: ${r}em;"></div>`;return f}var wo=At;var Oe=function(){this.hasTouchInterface_=typeof TouchEvent<"u",this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};Oe.prototype.toString=function(){return"RangeSelector Plugin"};Oe.prototype.activate=function(t){return this.dygraph_=t,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}};Oe.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null};Oe.prototype.getOption_=function(t,i){return this.dygraph_.getOption(t,i)};Oe.prototype.setDefaultOption_=function(t,i){this.dygraph_.attrs_[t]=i};Oe.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()};Oe.prototype.addToGraph_=function(){var t=this.graphDiv_=this.dygraph_.graphDiv;t.appendChild(this.bgcanvas_),t.appendChild(this.fgcanvas_),t.appendChild(this.leftZoomHandle_),t.appendChild(this.rightZoomHandle_)};Oe.prototype.removeFromGraph_=function(){var t=this.graphDiv_;t.removeChild(this.bgcanvas_),t.removeChild(this.fgcanvas_),t.removeChild(this.leftZoomHandle_),t.removeChild(this.rightZoomHandle_),this.graphDiv_=null};Oe.prototype.reserveSpace_=function(t){this.getOption_("showRangeSelector")&&t.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)};Oe.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())};Oe.prototype.renderInteractiveLayer_=function(){!this.updateVisibility_()||this.isChangingRange_||(this.placeZoomHandles_(),this.drawInteractiveLayer_())};Oe.prototype.updateVisibility_=function(){var t=this.getOption_("showRangeSelector");if(t)this.interfaceCreated_?(!this.graphDiv_||!this.graphDiv_.parentNode)&&this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var i=this.dygraph_;setTimeout(function(){i.width_=0,i.resize()},1)}return t};Oe.prototype.resize_=function(){function t(n,r,c,d){var m=d||Aa(r);n.style.top=c.y+"px",n.style.left=c.x+"px",n.width=c.w*m,n.height=c.h*m,n.style.width=c.w+"px",n.style.height=c.h+"px",m!=1&&r.scale(m,m)}var i=this.dygraph_.layout_.getPlotArea(),e=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(e=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:i.x,y:i.y+i.h+e+4,w:i.w,h:this.getOption_("rangeSelectorHeight")};var a=this.dygraph_.getNumericOption("pixelRatio");t(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_,a),t(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_,a)};Oe.prototype.createCanvases_=function(){this.bgcanvas_=pa(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=na(this.bgcanvas_),this.fgcanvas_=pa(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=na(this.fgcanvas_)};Oe.prototype.createZoomHandles_=function(){var t=new Image;t.className="dygraph-rangesel-zoomhandle",t.style.position="absolute",t.style.zIndex=10,t.style.visibility="hidden",t.style.cursor="col-resize",t.width=9,t.height=16,t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII=",this.isMobileDevice_&&(t.width*=2,t.height*=2),this.leftZoomHandle_=t,this.rightZoomHandle_=t.cloneNode(!1)};Oe.prototype.initInteraction_=function(){var t=this,i=document,e=0,a=null,n=!1,r=!1,c=!this.isMobileDevice_,d=new vr,m,u,v,f,y,_,D,P,R,I,O,H,z,K;m=function(W){var J=t.dygraph_.xAxisExtremes(),ue=(J[1]-J[0])/t.canvasRect_.w,j=J[0]+(W.leftHandlePos-t.canvasRect_.x)*ue,pe=J[0]+(W.rightHandlePos-t.canvasRect_.x)*ue;return[j,pe]},u=function(W){return ni(W),n=!0,e=W.clientX,a=W.target?W.target:W.srcElement,(W.type==="mousedown"||W.type==="dragstart")&&(Si(i,"mousemove",v),Si(i,"mouseup",f)),t.fgcanvas_.style.cursor="col-resize",d.cover(),!0},v=function(W){if(!n)return!1;ni(W);var J=W.clientX-e;if(Math.abs(J)<4)return!0;e=W.clientX;var ue=t.getZoomHandleStatus_(),j;a==t.leftZoomHandle_?(j=ue.leftHandlePos+J,j=Math.min(j,ue.rightHandlePos-a.width-3),j=Math.max(j,t.canvasRect_.x)):(j=ue.rightHandlePos+J,j=Math.min(j,t.canvasRect_.x+t.canvasRect_.w),j=Math.max(j,ue.leftHandlePos+a.width+3));var pe=a.width/2;return a.style.left=j-pe+"px",t.drawInteractiveLayer_(),c&&y(),!0},f=function(W){return n?(n=!1,d.uncover(),Et(i,"mousemove",v),Et(i,"mouseup",f),t.fgcanvas_.style.cursor="default",c||y(),!0):!1},y=function(){try{var W=t.getZoomHandleStatus_();if(t.isChangingRange_=!0,!W.isZoomed)t.dygraph_.resetZoom();else{var J=m(W);t.dygraph_.doZoomXDates_(J[0],J[1])}}finally{t.isChangingRange_=!1}},_=function(W){var J=t.leftZoomHandle_.getBoundingClientRect(),ue=J.left+J.width/2;J=t.rightZoomHandle_.getBoundingClientRect();var j=J.left+J.width/2;return W.clientX>ue&&W.clientX<j},D=function(W){return!r&&_(W)&&t.getZoomHandleStatus_().isZoomed?(ni(W),r=!0,e=W.clientX,W.type==="mousedown"&&(Si(i,"mousemove",P),Si(i,"mouseup",R)),!0):!1},P=function(W){if(!r)return!1;ni(W);var J=W.clientX-e;if(Math.abs(J)<4)return!0;e=W.clientX;var ue=t.getZoomHandleStatus_(),j=ue.leftHandlePos,pe=ue.rightHandlePos,mt=pe-j;j+J<=t.canvasRect_.x?(j=t.canvasRect_.x,pe=j+mt):pe+J>=t.canvasRect_.x+t.canvasRect_.w?(pe=t.canvasRect_.x+t.canvasRect_.w,j=pe-mt):(j+=J,pe+=J);var Ve=t.leftZoomHandle_.width/2;return t.leftZoomHandle_.style.left=j-Ve+"px",t.rightZoomHandle_.style.left=pe-Ve+"px",t.drawInteractiveLayer_(),c&&I(),!0},R=function(W){return r?(r=!1,Et(i,"mousemove",P),Et(i,"mouseup",R),c||I(),!0):!1},I=function(){try{t.isChangingRange_=!0,t.dygraph_.dateWindow_=m(t.getZoomHandleStatus_()),t.dygraph_.drawGraph_(!1)}finally{t.isChangingRange_=!1}},O=function(W){if(!(n||r)){var J=_(W)?"move":"default";J!=t.fgcanvas_.style.cursor&&(t.fgcanvas_.style.cursor=J)}},H=function(W){W.type=="touchstart"&&W.targetTouches.length==1?u(W.targetTouches[0])&&ni(W):W.type=="touchmove"&&W.targetTouches.length==1?v(W.targetTouches[0])&&ni(W):f(W)},z=function(W){W.type=="touchstart"&&W.targetTouches.length==1?D(W.targetTouches[0])&&ni(W):W.type=="touchmove"&&W.targetTouches.length==1?P(W.targetTouches[0])&&ni(W):R(W)},K=function(W,J){for(var ue=["touchstart","touchend","touchmove","touchcancel"],j=0;j<ue.length;j++)t.dygraph_.addAndTrackEvent(W,ue[j],J)},this.setDefaultOption_("interactionModel",kt.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);var Ae=window.opera?"mousedown":"dragstart";this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,Ae,u),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,Ae,u),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",D),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",O),this.hasTouchInterface_&&(K(this.leftZoomHandle_,H),K(this.rightZoomHandle_,H),K(this.fgcanvas_,z))};Oe.prototype.drawStaticLayer_=function(){var t=this.bgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(e){console.warn(e)}var i=.5;this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorBackgroundLineWidth"),t.strokeStyle=this.getOption_("rangeSelectorBackgroundStrokeColor"),t.beginPath(),t.moveTo(i,i),t.lineTo(i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,i),t.stroke()};Oe.prototype.drawMiniPlot_=function(){var t=this.getOption_("rangeSelectorPlotFillColor"),i=this.getOption_("rangeSelectorPlotFillGradientColor"),e=this.getOption_("rangeSelectorPlotStrokeColor");if(!(!t&&!e)){var a=this.getOption_("stepPlot"),n=this.computeCombinedSeriesAndLimits_(),r=n.yMax-n.yMin,c=this.bgcanvas_ctx_,d=.5,m=this.dygraph_.xAxisExtremes(),u=Math.max(m[1]-m[0],1e-30),v=(this.canvasRect_.w-d)/u,f=(this.canvasRect_.h-d)/r,y=this.canvasRect_.w-d,_=this.canvasRect_.h-d,D=null,P=null;c.beginPath(),c.moveTo(d,_);for(var R=0;R<n.data.length;R++){var I=n.data[R],O=I[0]!==null?(I[0]-m[0])*v:NaN,H=I[1]!==null?_-(I[1]-n.yMin)*f:NaN;!a&&D!==null&&Math.round(O)==Math.round(D)||(isFinite(O)&&isFinite(H)?(D===null?c.lineTo(O,_):a&&c.lineTo(O,P),c.lineTo(O,H),D=O,P=H):(D!==null&&(a?(c.lineTo(O,P),c.lineTo(O,_)):c.lineTo(D,_)),D=P=null))}if(c.lineTo(y,_),c.closePath(),t){var z=this.bgcanvas_ctx_.createLinearGradient(0,0,0,_);i&&z.addColorStop(0,i),z.addColorStop(1,t),this.bgcanvas_ctx_.fillStyle=z,c.fill()}e&&(this.bgcanvas_ctx_.strokeStyle=e,this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorPlotLineWidth"),c.stroke())}};Oe.prototype.computeCombinedSeriesAndLimits_=function(){var t=this.dygraph_,i=this.getOption_("logscale"),e,a=t.numColumns(),n=t.getLabels(),r=new Array(a),c=!1,d=t.visibility(),m=[];for(e=1;e<a;e++){var u=this.getOption_("showInRangeSelector",n[e]);m.push(u),u!==null&&(c=!0)}if(c)for(e=1;e<a;e++)r[e]=m[e-1];else for(e=1;e<a;e++)r[e]=d[e-1];var v=[],f=t.dataHandler_,y=t.attributes_;for(e=1;e<t.numColumns();e++)if(r[e]){var _=f.extractSeries(t.rawData_,e,y);t.rollPeriod()>1&&(_=f.rollingAverage(_,t.rollPeriod(),y,e)),v.push(_)}var D=[];for(e=0;e<v[0].length;e++){for(var P=0,R=0,I=0;I<v.length;I++){var O=v[I][e][1];O===null||isNaN(O)||(R++,P+=O)}D.push([v[0][e][0],P/R])}var H=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(e=0;e<D.length;e++){var K=D[e][1];K!==null&&isFinite(K)&&(!i||K>0)&&(H=Math.min(H,K),z=Math.max(z,K))}var Ae=.25;if(i)for(z=we(z),z+=z*Ae,H=we(H),e=0;e<D.length;e++)D[e][1]=we(D[e][1]);else{var W,J=z-H;J<=Number.MIN_VALUE?W=z*Ae:W=J*Ae,z+=W,H-=W}return{data:D,yMin:H,yMax:z}};Oe.prototype.placeZoomHandles_=function(){var t=this.dygraph_.xAxisExtremes(),i=this.dygraph_.xAxisRange(),e=t[1]-t[0],a=Math.max(0,(i[0]-t[0])/e),n=Math.max(0,(t[1]-i[1])/e),r=this.canvasRect_.x+this.canvasRect_.w*a,c=this.canvasRect_.x+this.canvasRect_.w*(1-n),d=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),m=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=r-m+"px",this.leftZoomHandle_.style.top=d+"px",this.rightZoomHandle_.style.left=c-m+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"};Oe.prototype.drawInteractiveLayer_=function(){var t=this.fgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var i=1,e=this.canvasRect_.w-i,a=this.canvasRect_.h-i,n=this.getZoomHandleStatus_();if(t.strokeStyle=this.getOption_("rangeSelectorForegroundStrokeColor"),t.lineWidth=this.getOption_("rangeSelectorForegroundLineWidth"),!n.isZoomed)t.beginPath(),t.moveTo(i,i),t.lineTo(i,a),t.lineTo(e,a),t.lineTo(e,i),t.stroke();else{var r=Math.max(i,n.leftHandlePos-this.canvasRect_.x),c=Math.min(e,n.rightHandlePos-this.canvasRect_.x);let d=this.getOption_("rangeSelectorVeilColour");t.fillStyle=d||"rgba(240, 240, 240, "+this.getOption_("rangeSelectorAlpha").toString()+")",t.fillRect(0,0,r,this.canvasRect_.h),t.fillRect(c,0,this.canvasRect_.w-c,this.canvasRect_.h),t.beginPath(),t.moveTo(i,i),t.lineTo(r,i),t.lineTo(r,a),t.lineTo(c,a),t.lineTo(c,i),t.lineTo(e,i),t.stroke()}};Oe.prototype.getZoomHandleStatus_=function(){var t=this.leftZoomHandle_.width/2,i=parseFloat(this.leftZoomHandle_.style.left)+t,e=parseFloat(this.rightZoomHandle_.style.left)+t;return{leftHandlePos:i,rightHandlePos:e,isZoomed:i-1>this.canvasRect_.x||e+1<this.canvasRect_.x+this.canvasRect_.w}};var To=Oe;var Sr=function(t){this.container=t};Sr.prototype.draw=function(t,i){this.container.innerHTML="",typeof this.date_graph<"u"&&this.date_graph.destroy(),this.date_graph=new qe(this.container,t,i)};Sr.prototype.setSelection=function(t){var i=!1;t.length&&(i=t[0].row),this.date_graph.setSelection(i)};Sr.prototype.getSelection=function(){var t=[],i=this.date_graph.getSelection();if(i<0)return t;for(var e=this.date_graph.layout_.points,a=0;a<e.length;++a)t.push({row:i,column:a+1});return t};var Wl=Sr;var M=function(i,e,a){this.__init__(i,e,a)};M.NAME="Dygraph";M.VERSION="2.2.1";var Do={};M._require=function(i){return i in Do?Do[i]:M._require._b(i)};M._require._b=null;M._require.add=function(i,e){Do[i]=e};M.DEFAULT_ROLL_PERIOD=1;M.DEFAULT_WIDTH=480;M.DEFAULT_HEIGHT=320;M.ANIMATION_STEPS=12;M.ANIMATION_DURATION=200;M.Plotters=Di._Plotters;M.addedAnnotationCSS=!1;M.prototype.__init__=function(t,i,e){if(this.is_initial_draw_=!0,this.readyFns_=[],e==null&&(e={}),e=M.copyUserAttrs_(e),typeof t=="string"&&(t=document.getElementById(t)),!t)throw new Error("Constructing dygraph with a non-existent div!");this.maindiv_=t,this.file_=i,this.rollPeriod_=e.rollPeriod||M.DEFAULT_ROLL_PERIOD,this.previousVerticalX_=-1,this.fractions_=e.fractions||!1,this.dateWindow_=e.dateWindow||null,this.annotations_=[],t.innerHTML="";let a=window.getComputedStyle(t,null);(a.paddingLeft!=="0px"||a.paddingRight!=="0px"||a.paddingTop!=="0px"||a.paddingBottom!=="0px")&&console.error("Main div contains padding; graph will misbehave"),t.style.width===""&&e.width&&(t.style.width=e.width+"px"),t.style.height===""&&e.height&&(t.style.height=e.height+"px"),t.style.height===""&&t.clientHeight===0&&(t.style.height=M.DEFAULT_HEIGHT+"px",t.style.width===""&&(t.style.width=M.DEFAULT_WIDTH+"px")),this.width_=t.clientWidth||e.width||0,this.height_=t.clientHeight||e.height||0,e.stackedGraph&&(e.fillGraph=!0),this.user_attrs_={},xt(this.user_attrs_,e),this.attrs_={},fr(this.attrs_,ua),this.boundaryIds_=[],this.setIndexByName_={},this.datasetIndex_=[],this.registeredEvents_=[],this.eventListeners_={},this.attributes_=new Yl(this),this.createInterface_(),this.plugins_=[];for(var n=M.PLUGINS.concat(this.getOption("plugins")),r=0;r<n.length;r++){var c=n[r],d;typeof c.activate<"u"?d=c:d=new c;var m={plugin:d,events:{},options:{},pluginOptions:{}},u=d.activate(this);for(var v in u)u.hasOwnProperty(v)&&(m.events[v]=u[v]);this.plugins_.push(m)}for(var r=0;r<this.plugins_.length;r++){var f=this.plugins_[r];for(var v in f.events)if(f.events.hasOwnProperty(v)){var y=f.events[v],_=[f.plugin,y];v in this.eventListeners_?this.eventListeners_[v].push(_):this.eventListeners_[v]=[_]}}this.createDragInterface_(),this.start_()};M.prototype.cascadeEvents_=function(t,i){if(!(t in this.eventListeners_))return!1;var e={dygraph:this,cancelable:!1,defaultPrevented:!1,preventDefault:function(){if(!e.cancelable)throw"Cannot call preventDefault on non-cancelable event.";e.defaultPrevented=!0},propagationStopped:!1,stopPropagation:function(){e.propagationStopped=!0}};xt(e,i);var a=this.eventListeners_[t];if(a)for(var n=a.length-1;n>=0;n--){var r=a[n][0],c=a[n][1];if(c.call(r,e),e.propagationStopped)break}return e.defaultPrevented};M.prototype.getPluginInstance_=function(t){for(var i=0;i<this.plugins_.length;i++){var e=this.plugins_[i];if(e.plugin instanceof t)return e.plugin}return null};M.prototype.isZoomed=function(t){let i=!!this.dateWindow_;if(t==="x")return i;let e=this.axes_.map(a=>!!a.valueRange).indexOf(!0)>=0;if(t==null)return i||e;if(t==="y")return e;throw new Error(`axis parameter is [${t}] must be null, 'x' or 'y'.`)};M.prototype.toString=function(){var t=this.maindiv_,i=t&&t.id?t.id:t;return"[Dygraph "+i+"]"};M.prototype.attr_=function(t,i){return typeof process<"u",i?this.attributes_.getForSeries(t,i):this.attributes_.get(t)};M.prototype.getOption=function(t,i){return this.attr_(t,i)};M.prototype.getNumericOption=function(t,i){return this.getOption(t,i)};M.prototype.getStringOption=function(t,i){return this.getOption(t,i)};M.prototype.getBooleanOption=function(t,i){return this.getOption(t,i)};M.prototype.getFunctionOption=function(t,i){return this.getOption(t,i)};M.prototype.getOptionForAxis=function(t,i){return this.attributes_.getForAxis(t,i)};M.prototype.optionsViewForAxis_=function(t){var i=this;return function(e){var a=i.user_attrs_.axes;return a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t==="x"&&e==="logscale"?!1:typeof i.user_attrs_[e]<"u"?i.user_attrs_[e]:(a=i.attrs_.axes,a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t=="y"&&i.axes_[0].hasOwnProperty(e)?i.axes_[0][e]:t=="y2"&&i.axes_[1].hasOwnProperty(e)?i.axes_[1][e]:i.attr_(e))}};M.prototype.rollPeriod=function(){return this.rollPeriod_};M.prototype.xAxisRange=function(){return this.dateWindow_?this.dateWindow_:this.xAxisExtremes()};M.prototype.xAxisExtremes=function(){var t=this.getNumericOption("xRangePad")/this.plotter_.area.w;if(this.numRows()===0)return[0-t,1+t];var i=this.rawData_[0][0],e=this.rawData_[this.rawData_.length-1][0];if(t){var a=e-i;i-=a*t,e+=a*t}return[i,e]};M.prototype.yAxisExtremes=function(){let t=this.gatherDatasets_(this.rolledSeries_,null),{extremes:i}=t,e=this.axes_;this.computeYAxisRanges_(i);let a=this.axes_;return this.axes_=e,a.map(n=>n.extremeRange)};M.prototype.yAxisRange=function(t){if(typeof t>"u"&&(t=0),t<0||t>=this.axes_.length)return null;var i=this.axes_[t];return[i.computedValueRange[0],i.computedValueRange[1]]};M.prototype.yAxisRanges=function(){for(var t=[],i=0;i<this.axes_.length;i++)t.push(this.yAxisRange(i));return t};M.prototype.toDomCoords=function(t,i,e){return[this.toDomXCoord(t),this.toDomYCoord(i,e)]};M.prototype.toDomXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();return i.x+(t-e[0])/(e[1]-e[0])*i.w};M.prototype.toDomYCoord=function(t,i){var e=this.toPercentYCoord(t,i);if(e===null)return null;var a=this.plotter_.area;return a.y+e*a.h};M.prototype.toDataCoords=function(t,i,e){return[this.toDataXCoord(t),this.toDataYCoord(i,e)]};M.prototype.toDataXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();if(this.attributes_.getForAxis("logscale","x")){var a=(t-i.x)/i.w;return ka(e[0],e[1],a)}else return e[0]+(t-i.x)/i.w*(e[1]-e[0])};M.prototype.toDataYCoord=function(t,i){if(t===null)return null;var e=this.plotter_.area,a=this.yAxisRange(i);if(typeof i>"u"&&(i=0),this.attributes_.getForAxis("logscale",i)){var n=(t-e.y)/e.h;return ka(a[1],a[0],n)}else return a[0]+(e.y+e.h-t)/e.h*(a[1]-a[0])};M.prototype.toPercentYCoord=function(t,i){if(t===null)return null;typeof i>"u"&&(i=0);var e=this.yAxisRange(i),a,n=this.attributes_.getForAxis("logscale",i);if(n){var r=we(e[0]),c=we(e[1]);a=(c-we(t))/(c-r)}else a=(e[1]-t)/(e[1]-e[0]);return a};M.prototype.toPercentXCoord=function(t){if(t===null)return null;var i=this.xAxisRange(),e,a=this.attributes_.getForAxis("logscale","x");if(a===!0){var n=we(i[0]),r=we(i[1]);e=(we(t)-n)/(r-n)}else e=(t-i[0])/(i[1]-i[0]);return e};M.prototype.numColumns=function(){return this.rawData_?this.rawData_[0]?this.rawData_[0].length:this.attr_("labels").length:0};M.prototype.numRows=function(){return this.rawData_?this.rawData_.length:0};M.prototype.getValue=function(t,i){return t<0||t>=this.rawData_.length||i<0||i>=this.rawData_[t].length?null:this.rawData_[t][i]};M.prototype.createInterface_=function(){var t=this.maindiv_;this.graphDiv=document.createElement("div"),this.graphDiv.style.textAlign="left",this.graphDiv.style.position="relative",t.appendChild(this.graphDiv),this.canvas_=pa(),this.canvas_.style.position="absolute",this.canvas_.style.top=0,this.canvas_.style.left=0,this.hidden_=this.createPlotKitCanvas_(this.canvas_),this.canvas_ctx_=na(this.canvas_),this.hidden_ctx_=na(this.hidden_),this.resizeElements_(),this.graphDiv.appendChild(this.hidden_),this.graphDiv.appendChild(this.canvas_),this.mouseEventElement_=this.createMouseEventElement_(),this.layout_=new Ia(this);var i=this;if(this.mouseMoveHandler_=function(a){i.mouseMove_(a)},this.mouseOutHandler_=function(a){var n=a.target||a.fromElement,r=a.relatedTarget||a.toElement;ho(n,i.graphDiv)&&!ho(r,i.graphDiv)&&i.mouseOut_(a)},this.addAndTrackEvent(window,"mouseout",this.mouseOutHandler_),this.addAndTrackEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),!this.resizeHandler_){this.resizeHandler_=function(a){i.resize()},this.addAndTrackEvent(window,"resize",this.resizeHandler_),this.resizeObserver_=null;var e=this.getStringOption("resizable");if(typeof ResizeObserver>"u"&&e!=="no"&&(console.error("ResizeObserver unavailable; ignoring resizable property"),e="no"),e==="horizontal"||e==="vertical"||e==="both"?t.style.resize=e:e!=="passive"&&(e="no"),e!=="no"){let a=window.getComputedStyle(t).overflow;window.getComputedStyle(t).overflow==="visible"&&(t.style.overflow="hidden"),this.resizeObserver_=new ResizeObserver(this.resizeHandler_),this.resizeObserver_.observe(t)}}};M.prototype.resizeElements_=function(){this.graphDiv.style.width=this.width_+"px",this.graphDiv.style.height=this.height_+"px";var t=this.getNumericOption("pixelRatio"),i=t||Aa(this.canvas_ctx_);this.canvas_.width=this.width_*i,this.canvas_.height=this.height_*i,this.canvas_.style.width=this.width_+"px",this.canvas_.style.height=this.height_+"px",i!==1&&this.canvas_ctx_.scale(i,i);var e=t||Aa(this.hidden_ctx_);this.hidden_.width=this.width_*e,this.hidden_.height=this.height_*e,this.hidden_.style.width=this.width_+"px",this.hidden_.style.height=this.height_+"px",e!==1&&this.hidden_ctx_.scale(e,e)};M.prototype.destroy=function(){this.canvas_ctx_.restore(),this.hidden_ctx_.restore();for(var t=this.plugins_.length-1;t>=0;t--){var i=this.plugins_.pop();i.plugin.destroy&&i.plugin.destroy()}var e=function(n){for(;n.hasChildNodes();)e(n.firstChild),n.removeChild(n.firstChild)};this.removeTrackedEvents_(),Et(window,"mouseout",this.mouseOutHandler_),Et(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),Et(window,"resize",this.resizeHandler_),this.resizeHandler_=null,e(this.maindiv_);var a=function(r){for(var c in r)typeof r[c]=="object"&&(r[c]=null)};a(this.layout_),a(this.plotter_),a(this)};M.prototype.createPlotKitCanvas_=function(t){var i=pa();return i.style.position="absolute",i.style.top=t.style.top,i.style.left=t.style.left,i.width=this.width_,i.height=this.height_,i.style.width=this.width_+"px",i.style.height=this.height_+"px",i};M.prototype.createMouseEventElement_=function(){return this.canvas_};M.prototype.setColors_=function(){var t=this.getLabels(),i=t.length-1;this.colors_=[],this.colorsMap_={};for(var e=this.getNumericOption("colorSaturation")||1,a=this.getNumericOption("colorValue")||.5,n=Math.ceil(i/2),r=this.getOption("colors"),c=this.visibility(),d=0;d<i;d++)if(c[d]){var m=t[d+1],u=this.attributes_.getForSeries("color",m);if(!u)if(r)u=r[d%r.length];else{var v=d%2?n+(d+1)/2:Math.ceil((d+1)/2),f=1*v/(1+i);u=Il(f,e,a)}this.colors_.push(u),this.colorsMap_[m]=u}};M.prototype.getColors=function(){return this.colors_};M.prototype.getPropertiesForSeries=function(t){for(var i=-1,e=this.getLabels(),a=1;a<e.length;a++)if(e[a]==t){i=a;break}return i==-1?null:{name:t,column:i,visible:this.visibility()[i-1],color:this.colorsMap_[t],axis:1+this.attributes_.axisForSeries(t)}};M.prototype.createRollInterface_=function(){var t=this.roller_;t||(this.roller_=t=document.createElement("input"),t.type="text",t.style.display="none",t.className="dygraph-roller",this.graphDiv.appendChild(t));var i=this.getBooleanOption("showRoller")?"block":"none",e=this.getArea(),a={top:e.y+e.h-25+"px",left:e.x+1+"px",display:i};t.size="2",t.value=this.rollPeriod_,xt(t.style,a);let n=this;t.onchange=function(){return n.adjustRoll(t.value)}};M.prototype.createDragInterface_=function(){var t={isZooming:!1,isPanning:!1,is2DPan:!1,dragStartX:null,dragStartY:null,dragEndX:null,dragEndY:null,dragDirection:null,prevEndX:null,prevEndY:null,prevDragDirection:null,cancelNextDblclick:!1,initialLeftmostDate:null,xUnitsPerPixel:null,dateRange:null,px:0,py:0,boundedDates:null,boundedValues:null,tarp:new vr,initializeMouseDown:function(c,d,m){c.preventDefault?c.preventDefault():(c.returnValue=!1,c.cancelBubble=!0);var u=ui(d.canvas_);m.px=u.x,m.py=u.y,m.dragStartX=la(c,m),m.dragStartY=sa(c,m),m.cancelNextDblclick=!1,m.tarp.cover()},destroy:function(){var c=this;if((c.isZooming||c.isPanning)&&(c.isZooming=!1,c.dragStartX=null,c.dragStartY=null),c.isPanning){c.isPanning=!1,c.draggingDate=null,c.dateRange=null;for(var d=0;d<e.axes_.length;d++)delete e.axes_[d].draggingValue,delete e.axes_[d].dragValueRange}c.tarp.uncover()}},i=this.getOption("interactionModel"),e=this,a=function(c){return function(d){c(d,e,t)}};for(var n in i)i.hasOwnProperty(n)&&this.addAndTrackEvent(this.mouseEventElement_,n,a(i[n]));if(!i.willDestroyContextMyself){var r=function(c){t.destroy()};this.addAndTrackEvent(document,"mouseup",r)}};M.prototype.drawZoomRect_=function(t,i,e,a,n,r,c,d){var m=this.canvas_ctx_;r==ia?m.clearRect(Math.min(i,c),this.layout_.getPlotArea().y,Math.abs(i-c),this.layout_.getPlotArea().h):r==aa&&m.clearRect(this.layout_.getPlotArea().x,Math.min(a,d),this.layout_.getPlotArea().w,Math.abs(a-d)),t==ia?e&&i&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(Math.min(i,e),this.layout_.getPlotArea().y,Math.abs(e-i),this.layout_.getPlotArea().h)):t==aa&&n&&a&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(this.layout_.getPlotArea().x,Math.min(a,n),this.layout_.getPlotArea().w,Math.abs(n-a)))};M.prototype.clearZoomRect_=function(){this.currentZoomRectArgs_=null,this.canvas_ctx_.clearRect(0,0,this.width_,this.height_)};M.prototype.doZoomX_=function(t,i){this.currentZoomRectArgs_=null;var e=this.toDataXCoord(t),a=this.toDataXCoord(i);this.doZoomXDates_(e,a)};M.prototype.doZoomXDates_=function(t,i){var e=this.xAxisRange(),a=[t,i];let n=this.getFunctionOption("zoomCallback"),r=this;this.doAnimatedZoom(e,a,null,null,function(){n&&n.call(r,t,i,r.yAxisRanges())})};M.prototype.doZoomY_=function(t,i){this.currentZoomRectArgs_=null;for(var e=this.yAxisRanges(),a=[],n=0;n<this.axes_.length;n++){var r=this.toDataYCoord(t,n),c=this.toDataYCoord(i,n);a.push([c,r])}let d=this.getFunctionOption("zoomCallback"),m=this;this.doAnimatedZoom(null,null,e,a,function(){if(d){let[v,f]=m.xAxisRange();d.call(m,v,f,m.yAxisRanges())}})};M.zoomAnimationFunction=function(t,i){var e=1.5;return(1-Math.pow(e,-t))/(1-Math.pow(e,-i))};M.prototype.resetZoom=function(){let t=this.isZoomed("x"),i=this.isZoomed("y"),e=t||i;if(this.clearSelection(),!e)return;let[a,n]=this.xAxisExtremes(),r=this.getBooleanOption("animatedZooms"),c=this.getFunctionOption("zoomCallback");if(!r){this.dateWindow_=null,this.axes_.forEach(y=>{y.valueRange&&delete y.valueRange}),this.drawGraph_(),c&&c.call(this,a,n,this.yAxisRanges());return}var d=null,m=null,u=null,v=null;t&&(d=this.xAxisRange(),m=[a,n]),i&&(u=this.yAxisRanges(),v=this.yAxisExtremes());let f=this;this.doAnimatedZoom(d,m,u,v,function(){f.dateWindow_=null,f.axes_.forEach(_=>{_.valueRange&&delete _.valueRange}),c&&c.call(f,a,n,f.yAxisRanges())})};M.prototype.doAnimatedZoom=function(t,i,e,a,n){var r=this.getBooleanOption("animatedZooms")?M.ANIMATION_STEPS:1,c=[],d=[],m,u;if(t!==null&&i!==null)for(m=1;m<=r;m++)u=M.zoomAnimationFunction(m,r),c[m-1]=[t[0]*(1-u)+u*i[0],t[1]*(1-u)+u*i[1]];if(e!==null&&a!==null)for(m=1;m<=r;m++){u=M.zoomAnimationFunction(m,r);for(var v=[],f=0;f<this.axes_.length;f++)v.push([e[f][0]*(1-u)+u*a[f][0],e[f][1]*(1-u)+u*a[f][1]]);d[m-1]=v}let y=this;mo(function(_){if(d.length)for(var D=0;D<y.axes_.length;D++){var P=d[_][D];y.axes_[D].valueRange=[P[0],P[1]]}c.length&&(y.dateWindow_=c[_]),y.drawGraph_()},r,M.ANIMATION_DURATION/r,n)};M.prototype.getArea=function(){return this.plotter_.area};M.prototype.eventToDomCoords=function(t){if(t.offsetX&&t.offsetY)return[t.offsetX,t.offsetY];var i=ui(this.mouseEventElement_),e=ra(t)-i.x,a=oa(t)-i.y;return[e,a]};M.prototype.findClosestRow=function(t){for(var i=1/0,e=-1,a=this.layout_.points,n=0;n<a.length;n++)for(var r=a[n],c=r.length,d=0;d<c;d++){var m=r[d];if(ca(m,!0)){var u=Math.abs(m.canvasx-t);u<i&&(i=u,e=m.idx)}}return e};M.prototype.findClosestPoint=function(t,i){for(var e=1/0,a,n,r,c,d,m,u,v=this.layout_.points.length-1;v>=0;--v)for(var f=this.layout_.points[v],y=0;y<f.length;++y)c=f[y],ca(c)&&(n=c.canvasx-t,r=c.canvasy-i,a=n*n+r*r,a<e&&(e=a,d=c,m=v,u=c.idx));var _=this.layout_.setNames[m];return{row:u,seriesName:_,point:d}};M.prototype.findStackedPoint=function(t,i){for(var e=this.findClosestRow(t),a,n,r=0;r<this.layout_.points.length;++r){var c=this.getLeftBoundary_(r),d=e-c,m=this.layout_.points[r];if(!(d>=m.length)){var u=m[d];if(ca(u)){var v=u.canvasy;if(t>u.canvasx&&d+1<m.length){var f=m[d+1];if(ca(f)){var y=f.canvasx-u.canvasx;if(y>0){var _=(t-u.canvasx)/y;v+=_*(f.canvasy-u.canvasy)}}}else if(t<u.canvasx&&d>0){var D=m[d-1];if(ca(D)){var y=u.canvasx-D.canvasx;if(y>0){var _=(u.canvasx-t)/y;v+=_*(D.canvasy-u.canvasy)}}}(r===0||v<i)&&(a=u,n=r)}}}var P=this.layout_.setNames[n];return{row:e,seriesName:P,point:a}};M.prototype.mouseMove_=function(t){var i=this.layout_.points;if(i!=null){var e=this.eventToDomCoords(t),a=e[0],n=e[1],r=this.getOption("highlightSeriesOpts"),c=!1;if(r&&!this.isSeriesLocked()){var d;this.getBooleanOption("stackedGraph")?d=this.findStackedPoint(a,n):d=this.findClosestPoint(a,n),c=this.setSelection(d.row,d.seriesName)}else{var m=this.findClosestRow(a);c=this.setSelection(m)}var u=this.getFunctionOption("highlightCallback");u&&c&&u.call(this,t,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}};M.prototype.getLeftBoundary_=function(t){if(this.boundaryIds_[t])return this.boundaryIds_[t][0];for(var i=0;i<this.boundaryIds_.length;i++)if(this.boundaryIds_[i]!==void 0)return this.boundaryIds_[i][0];return 0};M.prototype.animateSelection_=function(t){var i=10,e=30;this.fadeLevel===void 0&&(this.fadeLevel=0),this.animateId===void 0&&(this.animateId=0);var a=this.fadeLevel,n=t<0?a:i-a;if(n<=0){this.fadeLevel&&this.updateSelection_(1);return}var r=++this.animateId,c=this,d=function(){c.fadeLevel!==0&&t<0&&(c.fadeLevel=0,c.clearSelection())};mo(function(m){c.animateId==r&&(c.fadeLevel+=t,c.fadeLevel===0?c.clearSelection():c.updateSelection_(c.fadeLevel/i))},n,e,d)};M.prototype.updateSelection_=function(t){this.cascadeEvents_("select",{selectedRow:this.lastRow_===-1?void 0:this.lastRow_,selectedX:this.lastx_===null?void 0:this.lastx_,selectedPoints:this.selPoints_});var i,e=this.canvas_ctx_;if(this.getOption("highlightSeriesOpts")){e.clearRect(0,0,this.width_,this.height_);var a=1-this.getNumericOption("highlightSeriesBackgroundAlpha"),n=ma(this.getOption("highlightSeriesBackgroundColor"));if(a){var r=this.getBooleanOption("animateBackgroundFade");if(r){if(t===void 0){this.animateSelection_(1);return}a*=t}e.fillStyle="rgba("+n.r+","+n.g+","+n.b+","+a+")",e.fillRect(0,0,this.width_,this.height_)}this.plotter_._renderLineChart(this.highlightSet_,e)}else if(this.previousVerticalX_>=0){var c=0,d=this.attr_("labels");for(i=1;i<d.length;i++){var m=this.getNumericOption("highlightCircleSize",d[i]);m>c&&(c=m)}var u=this.previousVerticalX_;e.clearRect(u-c-1,0,2*c+2,this.height_)}if(this.selPoints_.length>0){var v=this.selPoints_[0].canvasx;for(e.save(),i=0;i<this.selPoints_.length;i++){var f=this.selPoints_[i];if(!isNaN(f.canvasy)){var y=this.getNumericOption("highlightCircleSize",f.name),_=this.getFunctionOption("drawHighlightPointCallback",f.name),D=this.plotter_.colors[f.name];_||(_=Ma.DEFAULT),e.lineWidth=this.getNumericOption("strokeWidth",f.name),e.strokeStyle=D,e.fillStyle=D,_.call(this,this,f.name,e,v,f.canvasy,D,y,f.idx)}}e.restore(),this.previousVerticalX_=v}};M.prototype.setSelection=function(i,e,a,n){this.selPoints_=[];var r=!1;if(i!==!1&&i>=0){i!=this.lastRow_&&(r=!0),this.lastRow_=i;for(var c=0;c<this.layout_.points.length;++c){var d=this.layout_.points[c],m=i-this.getLeftBoundary_(c);if(m>=0&&m<d.length&&d[m].idx==i){var u=d[m];u.yval!==null&&this.selPoints_.push(u)}else for(var v=0;v<d.length;++v){var u=d[v];if(u.idx==i){u.yval!==null&&this.selPoints_.push(u);break}}}}else this.lastRow_>=0&&(r=!0),this.lastRow_=-1;if(this.selPoints_.length?this.lastx_=this.selPoints_[0].xval:this.lastx_=null,e!==void 0&&(this.highlightSet_!==e&&(r=!0),this.highlightSet_=e),a!==void 0&&(this.lockedSet_=a),r&&(this.updateSelection_(void 0),n)){var f=this.getFunctionOption("highlightCallback");if(f){var y={};f.call(this,y,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}}return r};M.prototype.mouseOut_=function(t){this.getFunctionOption("unhighlightCallback")&&this.getFunctionOption("unhighlightCallback").call(this,t),this.getBooleanOption("hideOverlayOnMouseOut")&&!this.lockedSet_&&this.clearSelection()};M.prototype.clearSelection=function(){if(this.cascadeEvents_("deselect",{}),this.lockedSet_=!1,this.fadeLevel){this.animateSelection_(-1);return}this.canvas_ctx_.clearRect(0,0,this.width_,this.height_),this.fadeLevel=0,this.selPoints_=[],this.lastx_=null,this.lastRow_=-1,this.highlightSet_=null};M.prototype.getSelection=function(){if(!this.selPoints_||this.selPoints_.length<1)return-1;for(var t=0;t<this.layout_.points.length;t++)for(var i=this.layout_.points[t],e=0;e<i.length;e++)if(i[e].x==this.selPoints_[0].x)return i[e].idx;return-1};M.prototype.getHighlightSeries=function(){return this.highlightSet_};M.prototype.isSeriesLocked=function(){return this.lockedSet_};M.prototype.loadedEvent_=function(t){this.rawData_=this.parseCSV_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_()};M.prototype.addXTicks_=function(){var t;this.dateWindow_?t=[this.dateWindow_[0],this.dateWindow_[1]]:t=this.xAxisExtremes();var i=this.optionsViewForAxis_("x"),e=i("ticker")(t[0],t[1],this.plotter_.area.w,i,this);this.layout_.setXTicks(e)};M.prototype.getHandlerClass_=function(){var t;return this.attr_("dataHandler")?t=this.attr_("dataHandler"):this.fractions_?this.getBooleanOption("errorBars")?t=yo:t=vo:this.getBooleanOption("customBars")?t=go:this.getBooleanOption("errorBars")?t=_o:t=Oa,t};M.prototype.predraw_=function(){var t=new Date;this.dataHandler_=new(this.getHandlerClass_()),this.layout_.computePlotArea(),this.computeYAxes_(),this.is_initial_draw_||(this.canvas_ctx_.restore(),this.hidden_ctx_.restore()),this.canvas_ctx_.save(),this.hidden_ctx_.save(),this.plotter_=new Di(this,this.hidden_,this.hidden_ctx_,this.layout_),this.createRollInterface_(),this.cascadeEvents_("predraw"),this.rolledSeries_=[null];for(var i=1;i<this.numColumns();i++){var e=this.dataHandler_.extractSeries(this.rawData_,i,this.attributes_);this.rollPeriod_>1&&(e=this.dataHandler_.rollingAverage(e,this.rollPeriod_,this.attributes_,i)),this.rolledSeries_.push(e)}this.drawGraph_();var a=new Date;this.drawingTimeMs_=a-t};M.PointType=void 0;M.stackPoints_=function(t,i,e,a){for(var n=null,r=null,c=null,d=-1,m=function(D){if(!(d>=D)){for(var P=D;P<t.length;++P)if(c=null,!isNaN(t[P].yval)&&t[P].yval!==null){d=P,c=t[P];break}}},u=0;u<t.length;++u){var v=t[u],f=v.xval;i[f]===void 0&&(i[f]=0);var y=v.yval;isNaN(y)||y===null?a=="none"?y=0:(m(u),r&&c&&a!="none"?y=r.yval+(c.yval-r.yval)*((f-r.xval)/(c.xval-r.xval)):r&&a=="all"?y=r.yval:c&&a=="all"?y=c.yval:y=0):r=v;var _=i[f];n!=f&&(_+=y,i[f]=_),n=f,v.yval_stacked=_,_>e[1]&&(e[1]=_),_<e[0]&&(e[0]=_)}};M.prototype.gatherDatasets_=function(t,i){var e=[],a=[],n=[],r={},c,d,m,u,v,f=t.length-1,y;for(c=f;c>=1;c--)if(this.visibility()[c-1]){if(i){y=t[c];var _=i[0],D=i[1];for(m=null,u=null,d=0;d<y.length;d++)y[d][0]>=_&&m===null&&(m=d),y[d][0]<=D&&(u=d);m===null&&(m=0);for(var P=m,R=!0;R&&P>0;)P--,R=y[P][1]===null;u===null&&(u=y.length-1);var I=u;for(R=!0;R&&I<y.length-1;)I++,R=y[I][1]===null;P!==m&&(m=P),I!==u&&(u=I),e[c-1]=[m,u],y=y.slice(m,u+1)}else y=t[c],e[c-1]=[0,y.length-1];var O=this.attr_("labels")[c],H=this.dataHandler_.getExtremeYValues(y,i,this.getBooleanOption("stepPlot",O)),z=this.dataHandler_.seriesToPoints(y,O,e[c-1][0]);this.getBooleanOption("stackedGraph")&&(v=this.attributes_.axisForSeries(O),n[v]===void 0&&(n[v]=[]),M.stackPoints_(z,n[v],H,this.getBooleanOption("stackedGraphNaNFill"))),r[O]=H,a[c]=z}return{points:a,extremes:r,boundaryIds:e}};M.prototype.drawGraph_=function(){var t=new Date,i=this.is_initial_draw_;this.is_initial_draw_=!1,this.layout_.removeAllDatasets(),this.setColors_(),this.attrs_.pointSize=.5*this.getNumericOption("highlightCircleSize");var e=this.gatherDatasets_(this.rolledSeries_,this.dateWindow_),a=e.points,n=e.extremes;this.boundaryIds_=e.boundaryIds,this.setIndexByName_={};for(var r=this.attr_("labels"),c=0,d=1;d<a.length;d++)this.visibility()[d-1]&&(this.layout_.addDataset(r[d],a[d]),this.datasetIndex_[d]=c++);for(var d=0;d<r.length;d++)this.setIndexByName_[r[d]]=d;if(this.computeYAxisRanges_(n),this.layout_.setYAxes(this.axes_),this.addXTicks_(),this.layout_.evaluate(),this.renderGraph_(i),this.getStringOption("timingName")){var m=new Date;console.log(this.getStringOption("timingName")+" - drawGraph: "+(m-t)+"ms")}};M.prototype.renderGraph_=function(t){this.cascadeEvents_("clearChart"),this.plotter_.clear();let i=this.getFunctionOption("underlayCallback");i&&i.call(this,this.hidden_ctx_,this.layout_.getPlotArea(),this,this);var e={canvas:this.hidden_,drawingContext:this.hidden_ctx_};this.cascadeEvents_("willDrawChart",e),this.plotter_.render(),this.cascadeEvents_("didDrawChart",e),this.lastRow_=-1,this.canvas_.getContext("2d").clearRect(0,0,this.width_,this.height_);let a=this.getFunctionOption("drawCallback");if(a!==null&&a.call(this,this,t),t)for(this.readyFired_=!0;this.readyFns_.length>0;){var n=this.readyFns_.pop();n(this)}};M.prototype.computeYAxes_=function(){var t,i,e,a;for(this.axes_=[],t=0;t<this.attributes_.numAxes();t++)e={g:this},xt(e,this.attributes_.axisOptions(t)),this.axes_[t]=e;for(t=0;t<this.axes_.length;t++)if(t===0)e=this.optionsViewForAxis_("y"+(t?"2":"")),a=e("valueRange"),a&&(this.axes_[t].valueRange=a);else{var n=this.user_attrs_.axes;n&&n.y2&&(a=n.y2.valueRange,a&&(this.axes_[t].valueRange=a))}};M.prototype.numAxes=function(){return this.attributes_.numAxes()};M.prototype.axisPropertiesForSeries=function(t){return this.axes_[this.attributes_.axisForSeries(t)]};M.prototype.computeYAxisRanges_=function(t){for(var i=function($t){return isNaN(parseFloat($t))},e=this.attributes_.numAxes(),a,n,r,c,d,m=0;m<e;m++){var u=this.axes_[m],v=this.attributes_.getForAxis("logscale",m),f=this.attributes_.getForAxis("includeZero",m),y=this.attributes_.getForAxis("independentTicks",m);r=this.attributes_.seriesForAxis(m),a=!0,c=.1;let $t=this.getNumericOption("yRangePad");if($t!==null&&(a=!1,c=$t/this.plotter_.area.h),r.length===0)u.extremeRange=[0,1];else{for(var _=1/0,D=-1/0,P,R,I=0;I<r.length;I++)t.hasOwnProperty(r[I])&&(P=t[r[I]][0],P!==null&&(_=Math.min(P,_)),R=t[r[I]][1],R!==null&&(D=Math.max(R,D)));f&&!v&&(_>0&&(_=0),D<0&&(D=0)),_==1/0&&(_=0),D==-1/0&&(D=1),n=D-_,n===0&&(D!==0?n=Math.abs(D):(D=1,n=1));var O=D,H=_;a&&(v?(O=D+c*n,H=_):(O=D+c*n,H=_-c*n,H<0&&_>=0&&(H=0),O>0&&D<=0&&(O=0))),u.extremeRange=[H,O]}if(u.valueRange){var z=i(u.valueRange[0])?u.extremeRange[0]:u.valueRange[0],K=i(u.valueRange[1])?u.extremeRange[1]:u.valueRange[1];u.computedValueRange=[z,K]}else u.computedValueRange=u.extremeRange;if(!a){if(z=u.computedValueRange[0],K=u.computedValueRange[1],z===K)if(z===0)K=1;else{var Ae=Math.abs(z/10);z-=Ae,K+=Ae}if(v){var W=c/(2*c-1),J=(c-1)/(2*c-1);u.computedValueRange[0]=ka(z,K,W),u.computedValueRange[1]=ka(z,K,J)}else n=K-z,u.computedValueRange[0]=z-n*c,u.computedValueRange[1]=K+n*c}if(y){u.independentTicks=y;var ue=this.optionsViewForAxis_("y"+(m?"2":"")),j=ue("ticker");u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,ue,this),d||(d=u)}}if(d===void 0)throw'Configuration Error: At least one axis has to have the "independentTicks" option activated.';for(var m=0;m<e;m++){var u=this.axes_[m];if(!u.independentTicks){for(var ue=this.optionsViewForAxis_("y"+(m?"2":"")),j=ue("ticker"),pe=d.ticks,mt=d.computedValueRange[1]-d.computedValueRange[0],Ve=u.computedValueRange[1]-u.computedValueRange[0],Pt=[],Xe=0;Xe<pe.length;Xe++){var xe=(pe[Xe].v-d.computedValueRange[0])/mt,Ri=u.computedValueRange[0]+xe*Ve;Pt.push(Ri)}u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,ue,this,Pt)}}};M.prototype.detectTypeFromString_=function(t){var i=!1,e=t.indexOf("-");(e>0&&t[e-1]!="e"&&t[e-1]!="E"||t.indexOf("/")>=0||isNaN(parseFloat(t)))&&(i=!0),this.setXAxisOptions_(i)};M.prototype.setXAxisOptions_=function(t){t?(this.attrs_.xValueParser=so,this.attrs_.axes.x.valueFormatter=da,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti):(this.attrs_.xValueParser=function(i){return parseFloat(i)},this.attrs_.axes.x.valueFormatter=function(i){return i},this.attrs_.axes.x.ticker=ai,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter)};M.prototype.parseCSV_=function(t){var i=[],e=uo(t),a=t.split(e||`
`),n,r,c=this.getStringOption("delimiter");a[0].indexOf(c)==-1&&a[0].indexOf("	")>=0&&(c="	");var d=0;"labels"in this.user_attrs_||(d=1,this.attrs_.labels=a[0].split(c),this.attributes_.reparseSeries());for(var m=0,u,v=!1,f=this.attr_("labels").length,y=!1,_=d;_<a.length;_++){var D=a[_];if(m=_,D.length!==0&&D[0]!="#"){var P=D.split(c);if(!(P.length<2)){var R=[];if(v||(this.detectTypeFromString_(P[0]),u=this.getFunctionOption("xValueParser"),v=!0),R[0]=u(P[0],this),this.fractions_)for(r=1;r<P.length;r++)n=P[r].split("/"),n.length!=2?(console.error(`Expected fractional "num/den" values in CSV data but found a value '`+P[r]+"' on line "+(1+_)+" ('"+D+"') which is not of this form."),R[r]=[0,0]):R[r]=[ri(n[0],_,D),ri(n[1],_,D)];else if(this.getBooleanOption("errorBars"))for(P.length%2!=1&&console.error("Expected alternating (value, stdev.) pairs in CSV data but line "+(1+_)+" has an odd number of values ("+(P.length-1)+"): '"+D+"'"),r=1;r<P.length;r+=2)R[(r+1)/2]=[ri(P[r],_,D),ri(P[r+1],_,D)];else if(this.getBooleanOption("customBars"))for(r=1;r<P.length;r++){var I=P[r];/^ *$/.test(I)?R[r]=[null,null,null]:(n=I.split(";"),n.length==3?R[r]=[ri(n[0],_,D),ri(n[1],_,D),ri(n[2],_,D)]:console.warn('When using customBars, values must be either blank or "low;center;high" tuples (got "'+I+'" on line '+(1+_)+")"))}else for(r=1;r<P.length;r++)R[r]=ri(P[r],_,D);if(i.length>0&&R[0]<i[i.length-1][0]&&(y=!0),R.length!=f&&console.error("Number of columns in line "+_+" ("+R.length+") does not agree with number of labels ("+f+") "+D),_===0&&this.attr_("labels")){var O=!0;for(r=0;O&&r<R.length;r++)R[r]&&(O=!1);if(O){console.warn("The dygraphs 'labels' option is set, but the first row of CSV data ('"+D+"') appears to also contain labels. Will drop the CSV labels and use the option labels.");continue}}i.push(R)}}}return y&&(console.warn("CSV is out of order; order it correctly to speed loading."),i.sort(function(H,z){return H[0]-z[0]})),i};function A0(t){let i=t[0],e=i[0];if(typeof e!="number"&&!co(e))throw new Error(`Expected number or date but got ${typeof e}: ${e}.`);for(let a=1;a<i.length;a++){let n=i[a];if(n!=null&&typeof n!="number"&&!wi(n))throw new Error(`Expected number or array but got ${typeof n}: ${n}.`)}}M.prototype.parseArray_=function(t){if(t.length===0&&(t=[[0]]),t[0].length===0)return console.error("Data set cannot contain an empty row"),null;A0(t);var i;if(this.attr_("labels")===null){for(console.warn("Using default labels. Set labels explicitly via 'labels' in the options parameter"),this.attrs_.labels=["X"],i=1;i<t[0].length;i++)this.attrs_.labels.push("Y"+i);this.attributes_.reparseSeries()}else{var e=this.attr_("labels");if(e.length!=t[0].length)return console.error("Mismatch between number of labels ("+e+") and number of columns in array ("+t[0].length+")"),null}if(co(t[0][0])){this.attrs_.axes.x.valueFormatter=da,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti;var a=po(t);for(i=0;i<t.length;i++){if(a[i].length===0)return console.error("Row "+(1+i)+" of data is empty"),null;if(a[i][0]===null||typeof a[i][0].getTime!="function"||isNaN(a[i][0].getTime()))return console.error("x value in row "+(1+i)+" is not a Date"),null;a[i][0]=a[i][0].getTime()}return a}else return this.attrs_.axes.x.valueFormatter=function(n){return n},this.attrs_.axes.x.ticker=ai,this.attrs_.axes.x.axisLabelFormatter=Ra,t};M.prototype.parseDataTable_=function(t){var i=function(z){var K=String.fromCharCode(65+z%26);for(z=Math.floor(z/26);z>0;)K=String.fromCharCode(65+(z-1)%26)+K.toLowerCase(),z=Math.floor((z-1)/26);return K},e=t.getNumberOfColumns(),a=t.getNumberOfRows(),n=t.getColumnType(0);if(n=="date"||n=="datetime")this.attrs_.xValueParser=so,this.attrs_.axes.x.valueFormatter=da,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti;else if(n=="number")this.attrs_.xValueParser=function(z){return parseFloat(z)},this.attrs_.axes.x.valueFormatter=function(z){return z},this.attrs_.axes.x.ticker=ai,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter;else throw new Error("only 'date', 'datetime' and 'number' types are supported for column 1 of DataTable input (Got '"+n+"')");var r=[],c={},d=!1,m,u;for(m=1;m<e;m++){var v=t.getColumnType(m);if(v=="number")r.push(m);else if(v=="string"&&this.getBooleanOption("displayAnnotations")){var f=r[r.length-1];c.hasOwnProperty(f)?c[f].push(m):c[f]=[m],d=!0}else throw new Error("Only 'number' is supported as a dependent type with Gviz. 'string' is only supported if displayAnnotations is true")}var y=[t.getColumnLabel(0)];for(m=0;m<r.length;m++)y.push(t.getColumnLabel(r[m])),this.getBooleanOption("errorBars")&&(m+=1);this.attrs_.labels=y,e=y.length;var _=[],D=!1,P=[];for(m=0;m<a;m++){var R=[];if(typeof t.getValue(m,0)>"u"||t.getValue(m,0)===null){console.warn("Ignoring row "+m+" of DataTable because of undefined or null first column.");continue}if(n=="date"||n=="datetime"?R.push(t.getValue(m,0).getTime()):R.push(t.getValue(m,0)),this.getBooleanOption("errorBars"))for(u=0;u<e-1;u++)R.push([t.getValue(m,1+2*u),t.getValue(m,2+2*u)]);else{for(u=0;u<r.length;u++){var I=r[u];if(R.push(t.getValue(m,I)),d&&c.hasOwnProperty(I)&&t.getValue(m,c[I][0])!==null){var O={};O.series=t.getColumnLabel(I),O.xval=R[0],O.shortText=i(P.length),O.text="";for(var H=0;H<c[I].length;H++)H&&(O.text+=`
`),O.text+=t.getValue(m,c[I][H]);P.push(O)}}for(u=0;u<R.length;u++)isFinite(R[u])||(R[u]=null)}_.length>0&&R[0]<_[_.length-1][0]&&(D=!0),_.push(R)}D&&(console.warn("DataTable is out of order; order it correctly to speed loading."),_.sort(function(z,K){return z[0]-K[0]})),this.rawData_=_,P.length>0&&this.setAnnotations(P,!0),this.attributes_.reparseSeries()};M.prototype.cascadeDataDidUpdateEvent_=function(){this.cascadeEvents_("dataDidUpdate",{})};M.prototype.start_=function(){var t=this.file_;typeof t=="function"&&(t=t());let i=Ol(t);if(i=="array")this.rawData_=this.parseArray_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="object"&&typeof t.getColumnRange=="function")this.parseDataTable_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="string"){var e=uo(t);if(e)this.loadedEvent_(t);else{var a;window.XMLHttpRequest?a=new XMLHttpRequest:a=new ActiveXObject("Microsoft.XMLHTTP");var n=this;a.onreadystatechange=function(){a.readyState==4&&(a.status===200||a.status===0)&&n.loadedEvent_(a.responseText)},a.open("GET",t,!0),a.send(null)}}else console.error("Unknown data format: "+i)};M.prototype.updateOptions=function(t,i){typeof i>"u"&&(i=!1);var e=t.file,a=M.copyUserAttrs_(t),n=this.attributes_.numAxes();"rollPeriod"in a&&(this.rollPeriod_=a.rollPeriod),"dateWindow"in a&&(this.dateWindow_=a.dateWindow);var r=Nl(this.attr_("labels"),a);fr(this.user_attrs_,a),this.attributes_.reparseSeries(),n<this.attributes_.numAxes()&&this.plotter_.clear(),e?(this.cascadeEvents_("dataWillUpdate",{}),this.file_=e,i||this.start_()):i||(r?this.predraw_():this.renderGraph_(!1))};M.copyUserAttrs_=function(t){var i={};for(var e in t)t.hasOwnProperty(e)&&e!="file"&&t.hasOwnProperty(e)&&(i[e]=t[e]);return i};M.prototype.resize=function(t,i){if(!this.resize_lock){this.resize_lock=!0,t===null!=(i===null)&&(console.warn("Dygraph.resize() should be called with zero parameters or two non-NULL parameters. Pretending it was zero."),t=i=null);var e=this.width_,a=this.height_;t?(this.maindiv_.style.width=t+"px",this.maindiv_.style.height=i+"px",this.width_=t,this.height_=i):(this.width_=this.maindiv_.clientWidth,this.height_=this.maindiv_.clientHeight),(e!=this.width_||a!=this.height_)&&(this.resizeElements_(),this.predraw_()),this.resize_lock=!1}};M.prototype.adjustRoll=function(t){this.rollPeriod_=t,this.predraw_()};M.prototype.visibility=function(){for(this.getOption("visibility")||(this.attrs_.visibility=[]);this.getOption("visibility").length<this.numColumns()-1;)this.attrs_.visibility.push(!0);return this.getOption("visibility")};M.prototype.setVisibility=function(t,i){var e=this.visibility(),a=!1;if(Array.isArray(t)||(t!==null&&typeof t=="object"?a=!0:t=[t]),a)for(var n in t)t.hasOwnProperty(n)&&(n<0||n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]);else for(var n=0;n<t.length;n++)typeof t[n]=="boolean"?n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]:t[n]<0||t[n]>=e.length?console.warn("Invalid series number in setVisibility: "+t[n]):e[t[n]]=i;this.predraw_()};M.prototype.size=function(){return{width:this.width_,height:this.height_}};M.prototype.setAnnotations=function(t,i){if(this.annotations_=t,!this.layout_){console.warn("Tried to setAnnotations before dygraph was ready. Try setting them in a ready() block. See dygraphs.com/tests/annotation.html");return}this.layout_.setAnnotations(this.annotations_),i||this.predraw_()};M.prototype.annotations=function(){return this.annotations_};M.prototype.getLabels=function(){var t=this.attr_("labels");return t?t.slice():null};M.prototype.indexFromSetName=function(t){return this.setIndexByName_[t]};M.prototype.getRowForX=function(t){for(var i=0,e=this.numRows()-1;i<=e;){var a=e+i>>1,n=this.getValue(a,0);if(n<t)i=a+1;else if(n>t)e=a-1;else if(i!=a)e=a;else return a}return null};M.prototype.ready=function(t){this.is_initial_draw_?this.readyFns_.push(t):t.call(this,this)};M.prototype.addAndTrackEvent=function(t,i,e){Si(t,i,e),this.registeredEvents_.push({elem:t,type:i,fn:e})};M.prototype.removeTrackedEvents_=function(){if(this.registeredEvents_)for(var t=0;t<this.registeredEvents_.length;t++){var i=this.registeredEvents_[t];Et(i.elem,i.type,i.fn)}this.registeredEvents_=[]};M.PLUGINS=[wo,xo,To,bo,Co,So];M.GVizChart=Wl;M.DASHED_LINE=Ml;M.DOT_DASH_LINE=Rl;M.dateAxisLabelFormatter=Ti;M.toRGB_=ma;M.findPos=ui;M.pageX=ra;M.pageY=oa;M.dateString_=lo;M.defaultInteractionModel=kt.defaultModel;M.nonInteractiveModel=M.nonInteractiveModel_=kt.nonInteractiveModel_;M.Circles=Ma;M.Plugins={Legend:wo,Axes:xo,Annotations:Co,ChartLabels:bo,Grid:So,RangeSelector:To};M.DataHandlers={DefaultHandler:Oa,BarsHandler:hi,CustomBarsHandler:go,DefaultFractionHandler:vo,ErrorBarsHandler:_o,FractionsBarsHandler:yo};M.startPan=kt.startPan;M.startZoom=kt.startZoom;M.movePan=kt.movePan;M.moveZoom=kt.moveZoom;M.endPan=kt.endPan;M.endZoom=kt.endZoom;M.numericLinearTicks=Tl;M.numericTicks=ai;M.dateTicker=Ci;M.Granularity=se;M.getDateAxis=to;M.floatFormat=oo;$l(M);var qe=M;function M0(t,i){t&1&&b(0,"div",0)}function R0(t,i){if(t&1){let e=N();l(0,"div",1),E("click",function(){let n=k(e).$implicit,r=h();return A(r.doSelect(n))}),o(),g(1,M0,1,0,"div",0)}if(t&2){let e=i.$implicit,a=i.$index,n=h();St("background-color",e),me("selected",e===n.selectedColor),p(),x((a+1)%10===0?1:-1)}}var Po=["#ff0029","#377eb8","#66a61e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#000000"],ha=class t{constructor(){this.selectedColor=Po[Math.floor(Math.random()*Po.length)];this.select=new at;this.colors=Po}doSelect(i){this.select.emit(i),this.selectedColor=i}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-color-palette"]],inputs:{selectedColor:"selectedColor"},outputs:{select:"select"},standalone:!0,features:[F],decls:3,vars:0,consts:[[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(re(0,R0,2,5,null,null,ne),b(2,"div",0)),e&2&&oe(a.colors)},dependencies:[Y],styles:[".box[_ngcontent-%COMP%]{float:left;width:20px;height:20px;box-sizing:border-box;cursor:pointer}.box[_ngcontent-%COMP%]:hover{border:1px solid black}.box.selected[_ngcontent-%COMP%]{border:2px solid black}"],changeDetection:0})}};function I0(t,i){if(t&1){let e=N();l(0,"div",2),E("click",function(){let n=k(e).$implicit,r=h();return A(r.select(n))}),o()}if(t&2){let e=i.$implicit,a=h();St("border-bottom",e+"px solid")("border-color",e===a.selectedThickness?a.color:"black"),me("selected",e===a.selectedThickness)}}var fa=class t{constructor(i){this.changeDetection=i;this.options=[1,2,3,4];this.selectedThickness=2}select(i){this.selectedThickness=i}changeColor(i){this.color=i,this.changeDetection.detectChanges()}static{this.\u0275fac=function(e){return new(e||t)(w(It))}}static{this.\u0275cmp=V({type:t,selectors:[["app-thickness"]],inputs:{selectedThickness:"selectedThickness",color:"color"},standalone:!0,features:[F],decls:3,vars:0,consts:[[1,"box",3,"selected","borderBottom","borderColor"],[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(re(0,I0,1,6,"div",0,ne),b(2,"div",1)),e&2&&oe(a.options)},dependencies:[Y],styles:[".box[_ngcontent-%COMP%]{float:left;width:30px;height:20px;box-sizing:border-box;cursor:pointer;margin-right:5px}"],changeDetection:0})}};var L0=["palette"],O0=["thickness"],wr=class t{constructor(i,e){this.dialogRef=i;this.data=e}select(){this.dialogRef.close({color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-modify-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(_e(L0,7),_e(O0,7)),e&2){let n;he(n=fe())&&(a.palette=n.first),he(n=fe())&&(a.thickness=n.first)}},standalone:!0,features:[F],decls:17,vars:3,consts:[["palette",""],["thickness",""],[3,"select","selectedColor"],[3,"selectedThickness","color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){if(e&1){let n=N();l(0,"mat-dialog-content")(1,"label"),s(2,"Color"),o(),b(3,"br"),l(4,"app-color-palette",2,0),E("select",function(c){k(n);let d=le(11);return A(d.changeColor(c))}),o(),b(6,"br"),l(7,"label"),s(8,"Thickness"),o(),b(9,"br")(10,"app-thickness",3,1),o(),l(12,"mat-dialog-actions",4)(13,"ya-button",5),s(14,"CANCEL"),o(),l(15,"ya-button",6),E("click",function(){return k(n),A(a.select())}),s(16,"OK"),o()()}e&2&&(p(4),C("selectedColor",a.data.color),p(6),C("selectedThickness",a.data.strokeWidth)("color",a.data.color))},dependencies:[ha,Y,Be,He,$e,ge,fa],encapsulation:2,changeDetection:0})}};function V0(t,i){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"span",3),s(3),S(4,"datetime"),o()()()),t&2){let e=h(2);St("left",e.timestampData.canvasx+"px"),p(),St("background-color","black"),p(2),q(it(4,5,e.timestampData.timestamp,!1))}}function N0(t,i){if(t&1&&g(0,V0,5,8,"div",0),t&2){let e=h();x(e.timestampData?0:-1)}}var Tr=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-timestamp-tracker"]],inputs:{legendData:"legendData",timestampData:"timestampData"},standalone:!0,features:[F],decls:1,vars:1,consts:[[1,"timestamp",2,"pointer-events","none",3,"left"],[1,"timestamp",2,"pointer-events","none"],[1,"box"],[1,"xvalue"]],template:function(e,a){e&1&&g(0,N0,1,1),e&2&&x(a.legendData!=null&&a.legendData.x?0:-1)},dependencies:[Y,Le],styles:[".timestamp[_ngcontent-%COMP%]{position:absolute;bottom:0;background-color:transparent}.box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:3px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative;left:-50%}.xvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700;color:#fff;white-space:nowrap}"],changeDetection:0})}};var Na=class{constructor(){this.canvas=document.createElement("canvas")}activate(i){return i.graphDiv.appendChild(this.canvas),{select:this.select,deselect:this.deselect}}select(i){let e=i.dygraph.width_,a=i.dygraph.height_;this.canvas.width=e,this.canvas.height=a,this.canvas.style.width=e+"px",this.canvas.style.height=a+"px";let n=this.canvas.getContext("2d");n.clearRect(0,0,e,a),n.strokeStyle="#e1e1e1",n.beginPath();for(let r of i.dygraph.selPoints_){let c=Math.floor(r.canvasy)+.5;n.moveTo(0,c),n.lineTo(e,c)}n.stroke(),n.closePath()}deselect(i){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}destroy(){this.canvas=null}toString(){return"Crosshair Plugin"}};var _a=class{constructor(){this.yLimits=[]}activate(i){return{willDrawChart:this.willDrawChart}}setAlarmZones(i){this.yLimits=[];for(let e of i)this.yLimits.push(e.y1IsLimit?e.y1:e.y2)}willDrawChart(i){let e=i.dygraph,a=i.drawingContext,n=e.layout_,r=i.dygraph.plotter_.area;if(e.getOptionForAxis("drawGrid","y")){let c=["y","y2"],d=[],m=[],u=[],v=[],f=[];for(let _=0;_<c.length;_++)u[_]=e.getOptionForAxis("drawGrid",c[_]),u[_]&&(d[_]=e.getOptionForAxis("gridLineColor",c[_]),m[_]=e.getOptionForAxis("gridLineWidth",c[_]),f[_]=e.getOptionForAxis("gridLinePattern",c[_]),v[_]=f[_]&&f[_].length>=2);let y=n.yticks;a.save();for(let _ of y){if(!_.has_tick||this.yLimits.indexOf(parseFloat(_.label))>=0)continue;let D=_.axis;if(u[D]){a.save(),v[D]&&a.setLineDash&&a.setLineDash(f[D]),a.strokeStyle=d[D],a.lineWidth=m[D];let P=this.halfUp(r.x),R=this.halfDown(r.y+_.pos*r.h);a.beginPath(),a.moveTo(P,R),a.lineTo(P+r.w,R),a.stroke(),a.restore()}}a.restore()}if(e.getOptionForAxis("drawGrid","x")){let c=n.xticks;a.save();let d=e.getOptionForAxis("gridLinePattern","x"),m=d&&d.length>=2;m&&a.setLineDash&&a.setLineDash(d),a.strokeStyle=e.getOptionForAxis("gridLineColor","x"),a.lineWidth=e.getOptionForAxis("gridLineWidth","x");for(let u of c){if(!u.has_tick)continue;let v=this.halfUp(r.x+u.pos*r.w),f=this.halfDown(r.y+r.h);a.beginPath(),a.moveTo(v,f),a.lineTo(v,r.y),a.closePath(),a.stroke()}m&&a.setLineDash&&a.setLineDash([]),a.restore()}}halfUp(i){return Math.round(i)+.5}halfDown(i){return Math.round(i)-.5}toString(){return"Gridline Plugin"}destroy(){}};function Dr(t){let i,e,a=[];if(t.type&&t.type.defaultAlarm){let r=t.type.defaultAlarm;if(r.staticAlarmRanges){let c=-1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.minInclusive!==void 0){let u={y1:c,y2:m.minInclusive,y1IsLimit:!1,color:jl(m.level)||"black"};a.push(u),c=u.y2,i===void 0?i=m.minInclusive:i=Math.min(i,m.minInclusive)}}c=1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.maxInclusive){let u={y1:m.maxInclusive,y2:c,y1IsLimit:!0,color:jl(m.level)||"black"};a.push(u),c=u.y1,e===void 0?e=m.maxInclusive:e=Math.max(e,m.maxInclusive)}}}}let n=[null,null];return i!==void 0&&(n[0]=i),e!==void 0&&(n[1]=e),{valueRange:n,staticAlarmZones:a}}function jl(t){switch(t){case"WATCH":return"#ffdddb";case"WARNING":return"#ffc3c1";case"DISTRESS":return"#ffaaa8";case"CRITICAL":return"#c35e5c";case"SEVERE":return"#a94442";default:console.error("Unknown level "+t)}}function F0(t,i){if(t&1&&(l(0,"span",4),s(1),o()),t&2){let e=h().$implicit;p(),q(e.yHTML)}}function B0(t,i){if(t&1){let e=N();l(0,"div",6),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.close.emit(n.label))}),l(1,"mat-icon",7),s(2,"close"),o()()}}function $0(t,i){if(t&1){let e=N();l(0,"div",2)(1,"span",3),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.select.emit(n.label))}),s(2),o(),g(3,F0,2,1,"span",4)(4,B0,3,0,"div",5),o()}if(t&2){let e=i.$implicit,a=i.$index,n=h(2);St("background-color",n.backgroundColor)("border","1px solid "+n.borderColor)("border-left","3px solid "+e.color)("padding-right",n.closable&&a!==0?"15px":"5px"),p(2),q(e.label),p(),x(e.yHTML?3:-1),p(),x(n.closable&&a!==0?4:-1)}}function H0(t,i){if(t&1&&(l(0,"div",0),re(1,$0,5,11,"div",1,ne),o()),t&2){let e=h();p(),oe(e.data.series)}}var Pr=class t{constructor(){this.closable=!1;this.select=new at;this.close=new at}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-legend"]],inputs:{data:"data",backgroundColor:"backgroundColor",borderColor:"borderColor",closable:"closable"},outputs:{select:"select",close:"close"},standalone:!0,features:[F],decls:1,vars:1,consts:[[1,"legend","no-select"],[1,"legend-box",3,"backgroundColor","border","borderLeft","paddingRight"],[1,"legend-box"],[1,"label",3,"click"],[1,"yvalue"],[1,"close-button"],[1,"close-button",3,"click"],[1,"icon12"]],template:function(e,a){e&1&&g(0,H0,3,0,"div",0),e&2&&x(a.data?0:-1)},dependencies:[wt],styles:[".legend[_ngcontent-%COMP%]{position:absolute;top:0;left:63px;background-color:transparent}.legend-box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:15px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative}.label[_ngcontent-%COMP%]{cursor:pointer}.label[_ngcontent-%COMP%]:hover{opacity:.7}.yvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700}.close-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer}"],changeDetection:0})}};var Mi=class t{constructor(){this.grid=!1;this.axis=!0;this.axisLineWidth=1;this.alarmRanges="line";this.color="#1b61b9";this.strokeWidth=2}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-series"]],inputs:{parameter:"parameter",grid:"grid",axis:"axis",axisLineWidth:"axisLineWidth",alarmRanges:"alarmRanges",color:"color",label:"label",strokeWidth:"strokeWidth"},standalone:!0,features:[F],decls:0,vars:0,template:function(e,a){},encapsulation:2})}};var Y0=["graphContainer"],Fa=class t{constructor(i,e){this.dialog=i;this.formatter=e;this.fillGraph=!1;this.xGrid=!1;this.xAxis=!0;this.xAxisLineWidth=1;this.duration="PT1H";this.height="100%";this.width="100%";this.removableSeries=!1;this.stop=new Date;this.crosshair="vertical";this.axisBackgroundColor="#fafafa";this.axisLineColor="#e1e1e1";this.gridLineColor="#f2f2f2";this.plotAreaBackgroundColor="#fff";this.highlightColor="#e1e1e1";this.onVisibleRange=new at;this.onManualRangeChange=new at;this.parameters=[];this.parameterConfig=new Map;this.disableDataReload=!1;this.legendData$=new $(null);this.timestampTrackerData$=new $(null)}ngAfterViewInit(){this.dataSource.parameters$.value.forEach(e=>{this.parameters.push(e)}),this.seriesComponents.forEach(e=>{this.parameterConfig.set(e.parameter,e)});let i=this.graphContainer.nativeElement;if(this.initDygraphs(i),this.dataSource.data$.subscribe(e=>{if(this.disableDataReload)return;let a={file:e.samples.length?e.samples:`X
`};if(this.dataSource.visibleStart&&(a.dateWindow=[this.dataSource.visibleStart.getTime(),this.dataSource.visibleStop.getTime()],this.onVisibleRange.emit([this.dataSource.visibleStart,this.dataSource.visibleStop])),e.valueRange[0]!==null&&e.valueRange[1]!==null)a.axes={y:{valueRange:e.valueRange}};else{let n=Dr(this.parameters[0]).valueRange,r=n[0];this.dataSource.minValue!==void 0&&(r=r!==null?Math.min(r,this.dataSource.minValue):this.dataSource.minValue);let c=n[1];this.dataSource.maxValue!==void 0&&(c=c!==null?Math.max(c,this.dataSource.maxValue):this.dataSource.maxValue),r===c&&r!==null&&(r=Math.min(r,0),c=Math.max(c,0)),r!==null&&c!==null&&(r=r-(c-r)*.1,c=c+(c-r)*.1),a.axes={y:{valueRange:[r,c]}}}this.dygraph.updateOptions(a)}),this.duration){let e=this.stop,a=B.subtractDuration(e,this.duration);this.dataSource.updateWindow(a,e,[null,null])}this.applyTheme()}initDygraphs(i){let e={},a=this.parameters.map(f=>this.parameterConfig.get(f.qualifiedName));a.forEach(f=>{e[f.label||f.parameter]={color:f.color,strokeWidth:f.strokeWidth}});let n=this.parameters[0],r=a[0],d=Dr(n).staticAlarmZones,m=null,u={legend:"always",fillGraph:this.fillGraph,drawGrid:!1,drawPoints:!1,showRoller:!1,customBars:!0,gridLineColor:this.gridLineColor,axisLineColor:this.axisLineColor,axisLabelFontSize:11,digitsAfterDecimal:6,labels:["Generation Time",...a.map(f=>f.label||f.parameter)],rightGap:0,labelsUTC:this.formatter.isUTC(),series:e,axes:{x:{drawAxis:this.xAxis,drawGrid:this.xGrid,axisLineWidth:this.xAxisLineWidth||1e-7},y:{axisLabelWidth:50,drawAxis:r.axis,drawGrid:r.grid,axisLineWidth:r.axisLineWidth||1e-7,valueRange:Dr(n).valueRange}},interactionModel:{mousedown:(f,y,_)=>{_.initializeMouseDown(f,y,_),f.altKey||f.shiftKey?qe.startZoom(f,y,_):qe.startPan(f,y,_)},mousemove:(f,y,_)=>{_.isPanning?(this.disableDataReload=!0,qe.movePan(f,y,_)):_.isZooming&&(this.disableDataReload=!0,qe.moveZoom(f,y,_))},mouseup:(f,y,_)=>{_.isPanning?qe.endPan(f,y,_):_.isZooming&&qe.endZoom(f,y,_);let D=y.xAxisRange(),P=new Date(D[0]),R=new Date(D[1]),I=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,I),this.onManualRangeChange.emit(),this.disableDataReload=!1},click:(f,y,_)=>{m=y,f.preventDefault(),f.stopPropagation()},mouseout:(f,y,_)=>{if(_.isPanning){let D=y.xAxisRange(),P=new Date(D[0]),R=new Date(D[1]),I=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,I)}this.disableDataReload=!1},mousewheel:(f,y,_)=>{if(m!==y)return;let P=(f.detail?f.detail*-1:f.deltaY/40)/50;f.offsetX&&f.offsetY||(f.offsetX=f.layerX-f.target.offsetLeft,f.offsetY=f.layerY-f.target.offsetTop);let R=this.offsetToPercentage(f.offsetX);this.zoom(P,R),f.preventDefault(),f.stopPropagation()}},underlayCallback:(f,y,_)=>{if(f.save(),f.globalAlpha=1,f.fillStyle=this.plotAreaBackgroundColor,f.fillRect(y.x,y.y,y.w,y.h),r.alarmRanges==="line")for(let D of d){let P=D.y1IsLimit?D.y1:D.y2,R=_.toDomCoords(0,P)[1];f.strokeStyle=D.color,f.lineWidth=1,f.beginPath(),f.moveTo(y.x,R),f.lineTo(y.x+y.w,R),f.stroke()}else if(r.alarmRanges==="fill"){f.globalAlpha=.2;for(let D of d){if(D.y2===null)return;let P,R;D.y1===-1/0?P=y.y+y.h:P=_.toDomCoords(0,D.y1)[1],D.y2===1/0?R=0:R=_.toDomCoords(0,D.y2)[1],f.fillStyle=D.color,f.fillRect(y.x,Math.min(P,R),y.w,Math.abs(R-P))}}f.restore()},drawHighlightPointCallback:(f,y,_,D,P,R,I)=>{if((r.label||r.parameter)===y){_.save(),_.setLineDash([5,5]),_.strokeStyle=this.highlightColor,_.lineWidth=1,this.timestampTrackerData$.next({timestamp:new Date(f.selPoints_[0].xval),canvasx:f.selPoints_[0].canvasx}),_.beginPath();let O=Math.floor(f.selPoints_[0].canvasx)+.5;if((this.crosshair==="vertical"||this.crosshair==="both")&&(_.moveTo(O,0),_.lineTo(O,f.height_)),this.crosshair==="horizontal"||this.crosshair==="both")for(let H of f.selPoints_){let z=Math.floor(H.canvasy)+.5;_.moveTo(0,z),_.lineTo(f.width_,z)}_.stroke(),_.closePath(),_.restore()}_.beginPath(),_.arc(D,P,I,0,2*Math.PI,!1),_.fill()},legendFormatter:f=>{for(let y of f.series)if(y.y===void 0){let _=this.dataSource.latestRealtimeValues.get(y.label);_&&(y.y=_[1],y.yHTML=String(_[1]))}return this.legendData$.next(f),""},plugins:[new Na]};this.xAxisHeight!==void 0&&(u.xAxisHeight=this.xAxisHeight),qe.Plugins.Grid=_a,qe.PLUGINS=[qe.Plugins.Legend,qe.Plugins.Axes,qe.Plugins.Annotations,qe.Plugins.ChartLabels,qe.Plugins.Grid,qe.Plugins.RangeSelector],this.dygraph=new qe(i,`X
`,u),this.dygraph.getPluginInstance_(_a).setAlarmZones(d)}getParameters(){return this.parameters}addParameter(i,e){this.dataSource.addParameter(i),this.parameters.push(i),this.parameterConfig.set(i.qualifiedName,e),this.updateDygraphSeries()}removeParameter(i){let e=i;this.dataSource.removeParameter(e),this.parameters=this.parameters.filter(a=>a.qualifiedName!==e),this.parameterConfig.delete(e),this.updateDygraphSeries()}modifyParameter(i){let e=this.dygraph.getPropertiesForSeries(i);this.dialog.open(wr,{data:bt(tt({},e),{strokeWidth:this.dygraph.getOption("strokeWidth",i)})}).afterClosed().subscribe(n=>{if(n){let r=this.parameterConfig.get(i);r.color=n.color,r.strokeWidth=n.thickness,this.updateDygraphSeries()}})}updateDygraphSeries(){let i={},e=this.parameters.map(n=>this.parameterConfig.get(n.qualifiedName));e.forEach(n=>{i[n.label||n.parameter]={color:n.color,strokeWidth:n.strokeWidth}});let a={labels:["Generation Time",...e.map(n=>n.label||n.parameter)],series:i};this.dataSource.reloadVisibleRange().then(()=>{this.dygraph.updateOptions(a,!0)})}applyTheme(){if(this.dygraph&&this.dygraph.updateOptions({axisLineColor:this.axisLineColor,gridLineColor:this.gridLineColor}),this.graphContainer){let i=this.graphContainer.nativeElement;i.style.backgroundColor=this.axisBackgroundColor}}getDateRange(){if(this.dygraph){let i=this.dygraph.xAxisRange();return[new Date(i[0]),new Date(i[1])]}}zoomIn(){this.zoom(.2)}zoomOut(){this.zoom(-.25)}reset(){let i=this.dygraph.xAxisRange(),e=new Date(i[0]),a=new Date(i[1]);this.dataSource.updateWindow(e,a,[null,null])}zoom(i,e=.5){this.dygraph.updateOptions({dateWindow:this.adjustAxis(this.dygraph.xAxisRange(),i,e)});let a=this.dygraph.xAxisRange(),n=new Date(a[0]),r=new Date(a[1]);this.dataSource.updateWindow(n,r,[null,null]),this.onManualRangeChange.emit()}updateWindowOnly(i,e){this.dataSource.updateWindowOnly(i,e),this.dygraph.updateOptions({dateWindow:[i,e]})}adjustAxis(i,e,a){let r=(i[1]-i[0])*e,c=[r*a,r*(1-a)];return[i[0]+c[0],i[1]-c[1]]}offsetToPercentage(i){let e=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[0],null)[0],a=i-e,n=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[1],null)[0]-e;return n===0?0:a/n}ngOnDestroy(){this.dygraph?.destroy()}static{this.\u0275fac=function(e){return new(e||t)(w(Fe),w(Wi))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-plot"]],contentQueries:function(e,a,n){if(e&1&&Oo(n,Mi,4),e&2){let r;he(r=fe())&&(a.seriesComponents=r)}},viewQuery:function(e,a){if(e&1&&_e(Y0,7),e&2){let n;he(n=fe())&&(a.graphContainer=n.first)}},inputs:{dataSource:"dataSource",fillGraph:"fillGraph",xGrid:"xGrid",xAxis:"xAxis",xAxisLineWidth:"xAxisLineWidth",xAxisHeight:"xAxisHeight",duration:"duration",height:"height",width:"width",removableSeries:"removableSeries",stop:"stop",crosshair:"crosshair"},outputs:{onVisibleRange:"onVisibleRange",onManualRangeChange:"onManualRangeChange"},standalone:!0,features:[F],decls:9,vars:16,consts:[["graphContainer",""],[1,"legend-wrapper"],[3,"close","select","data","backgroundColor","borderColor","closable"],[1,"timestamp-wrapper"],[3,"legendData","timestampData"],[1,"graph-container"]],template:function(e,a){if(e&1){let n=N();l(0,"div",1)(1,"app-parameter-legend",2),S(2,"async"),E("close",function(c){return k(n),A(a.removeParameter(c))})("select",function(c){return k(n),A(a.modifyParameter(c))}),o()(),l(3,"div",3),b(4,"app-timestamp-tracker",4),S(5,"async"),S(6,"async"),o(),b(7,"div",5,0)}e&2&&(p(),C("data",T(2,10,a.legendData$))("backgroundColor",a.plotAreaBackgroundColor)("borderColor",a.gridLineColor)("closable",a.removableSeries),p(3),C("legendData",T(5,12,a.legendData$))("timestampData",T(6,14,a.timestampTrackerData$)),p(3),St("height",a.height)("width",a.width))},dependencies:[ee,Pr,Tr],styles:[".legend-wrapper[_ngcontent-%COMP%]{position:relative;z-index:50}.timestamp-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:50;bottom:4px}.graph-container[_ngcontent-%COMP%]{overflow:hidden}  .annotation{background-color:#ffb6c1;color:red!important;opacity:.7;border-color:red!important}  .dygraph-axis-label{color:#aaa}  .dygraph-legend{position:absolute;font-size:14px;z-index:10;width:250px;background:#fff;line-height:normal;text-align:left;overflow:hidden}  .dygraph-legend-line{display:inline-block;position:relative;bottom:.5ex;padding-left:1em;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-legend-dash{display:inline-block;position:relative;bottom:.5ex;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-roller{position:absolute;z-index:10}  .dygraph-annotation{position:absolute;z-index:10;overflow:hidden}  .dygraph-default-annotation{border:1px solid black;background-color:#fff;text-align:center}  .dygraph-axis-label{z-index:10;line-height:normal;overflow:hidden;color:#000}  .dygraph-title{font-weight:700;z-index:10;text-align:center}  .dygraph-xlabel{text-align:center}  .dygraph-label-rotate-left{text-align:center;transform:rotate(90deg)}  .dygraph-label-rotate-right{text-align:center;transform:rotate(-90deg)}"],changeDetection:0})}};var G0=["palette"],U0=["thickness"];function z0(t,i){if(t&1&&(l(0,"mat-option",6),S(1,"memberPath"),s(2),S(3,"memberPath"),o()),t&2){let e=i.$implicit;C("value",T(1,2,e)),p(2),L(" ",T(3,4,e)," ")}}var Er=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new te(null,[Ee.required])}ngOnInit(){let i=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe(Ha(300),Ya(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:10,searchMembers:!0})),Ii(e=>e.parameters||[]),Ii(e=>e.filter(a=>{for(let n of i){let r=B.getMemberPath(a);if(n.qualifiedName===r)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(X),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(_e(G0,7),_e(U0,7)),e&2){let n;he(n=fe())&&(a.palette=n.first),he(n=fe())&&(a.thickness=n.first)}},standalone:!0,features:[F],decls:24,vars:6,consts:[["auto",""],["palette",""],["thickness",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[3,"color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"mat-dialog-content",3)(1,"label"),s(2," Search parameter for comparison "),b(3,"input",4),l(4,"mat-autocomplete",5,0),re(6,z0,4,6,"mat-option",6,ne),S(8,"async"),o()(),b(9,"br"),l(10,"label"),s(11,"Color"),o(),b(12,"app-color-palette",null,1)(14,"br"),l(15,"label"),s(16,"Thickness"),o(),b(17,"app-thickness",7,2),o(),l(19,"mat-dialog-actions",8)(20,"ya-button",9),s(21,"CANCEL"),o(),l(22,"ya-button",10),E("click",function(){return k(n),A(a.select())}),s(23,"ADD"),o()()}if(e&2){let n=le(5),r=le(13);p(3),C("formControl",a.parameter)("matAutocomplete",n),p(3),oe(T(8,4,a.filteredOptions)),p(11),C("color",r.selectedColor),p(5),C("disabled",!a.parameter.valid)}},dependencies:[ha,Y,ee,Ze,de,Gt,tn,Ja,an,Be,He,$e,ge,hn,fa],encapsulation:2,changeDetection:0})}};var kr=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=a;this.form=new rt({start:new te(null,Ee.required),stop:new te(null,Ee.required)});let n=e.start,r=e.stop;(!n||!r)&&(r=this.yamcs.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:B.toISOString(n),stop:B.toISOString(r)})}select(){let i=B.toDate(this.form.value.start),e=B.toDate(this.form.value.stop);this.dialogRef.close({start:i,stop:e})}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Qe),w(X))}}static{this.\u0275cmp=V({type:t,selectors:[["app-select-range-dialog"]],standalone:!0,features:[F],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Select Range"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),s(5," Start "),b(6,"ya-date-time-input",3),o(),l(7,"label"),s(8," Stop "),b(9,"ya-date-time-input",4),o()()(),l(10,"mat-dialog-actions",5)(11,"ya-button",6),s(12,"CANCEL"),o(),l(13,"ya-button",7),E("click",function(){return a.select()}),s(14,"OK"),o()()),e&2&&(p(3),C("formGroup",a.form),p(10),C("disabled",!a.form.valid))},dependencies:[Y,De,de,be,Se,Pe,Be,ht,He,$e,ge,vt],encapsulation:2})}};function W0(t,i){t&1&&(l(0,"span"),s(1,"Date Range"),o())}function j0(t,i){if(t&1&&(l(0,"span"),s(1),S(2,"datetime"),S(3,"datetime"),o()),t&2){let e=h(),a=h();p(),Ht(" ",T(2,2,a)," - ",T(3,4,e)," ")}}function q0(t,i){if(t&1&&g(0,j0,4,6,"span"),t&2){let e=h(2);x(e==="CUSTOM"?0:-1)}}function X0(t,i){if(t&1&&(g(0,q0,1,1),S(1,"async")),t&2){let e,a=h(3);x((e=T(1,1,a.customStop$))?0:-1,e)}}function Z0(t,i){if(t&1){let e=N();l(0,"div",2)(1,"ya-text-action",10),E("click",function(){k(e);let n=h(2);return A(n.compareParameter())}),s(2," Comparison "),o(),b(3,"span",9),l(4,"ya-text-action",11),E("click",function(){k(e);let n=h(2);return A(n.chooseRange())}),g(5,W0,2,0,"span")(6,X0,2,3),S(7,"async"),o(),l(8,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1M"))}),s(9," 1 minute "),o(),l(10,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT5M"))}),s(11," 5 minutes "),o(),l(12,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT15M"))}),s(13," 15 minutes "),o(),l(14,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT30M"))}),s(15," 30 minutes "),o(),l(16,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1H"))}),s(17," 1 hour "),o(),l(18,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT6H"))}),s(19," 6 hours "),o(),l(20,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT12H"))}),s(21," 12 hours "),o(),l(22,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1D"))}),s(23," 1 day "),o(),l(24,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2D"))}),s(25," 2 days "),o(),l(26,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1W"))}),s(27," 7 days "),o(),l(28,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2W"))}),s(29," 14 days "),o(),l(30,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1M"))}),s(31," 30 days "),o()()}if(t&2){let e,a=i,n=h(2);p(4),C("active",a==="CUSTOM"),p(),x(a!=="CUSTOM"?5:-1),p(),x((e=T(7,15,n.customStart$))?6:-1,e),p(2),C("active",a==="PT1M"),p(2),C("active",a==="PT5M"),p(2),C("active",a==="PT15M"),p(2),C("active",a==="PT30M"),p(2),C("active",a==="PT1H"),p(2),C("active",a==="PT6H"),p(2),C("active",a==="PT12H"),p(2),C("active",a==="P1D"),p(2),C("active",a==="P2D"),p(2),C("active",a==="P1W"),p(2),C("active",a==="P2W"),p(2),C("active",a==="P1M")}}function Q0(t,i){t&1&&(l(0,"span"),s(1,"the last minute"),o())}function K0(t,i){t&1&&(l(0,"span"),s(1,"the last 5 minutes"),o())}function J0(t,i){t&1&&(l(0,"span"),s(1,"the last 15 minutes"),o())}function eh(t,i){t&1&&(l(0,"span"),s(1,"the last 30 minutes"),o())}function th(t,i){t&1&&(l(0,"span"),s(1,"the last hour"),o())}function ih(t,i){t&1&&(l(0,"span"),s(1,"the last 6 hours"),o())}function ah(t,i){t&1&&(l(0,"span"),s(1,"the last 12 hours"),o())}function nh(t,i){t&1&&(l(0,"span"),s(1,"the last 24 hours"),o())}function rh(t,i){t&1&&(l(0,"span"),s(1,"the last 2 days"),o())}function oh(t,i){t&1&&(l(0,"span"),s(1,"the last week"),o())}function lh(t,i){t&1&&(l(0,"span"),s(1,"the last 2 weeks"),o())}function sh(t,i){t&1&&(l(0,"span"),s(1,"the last month"),o())}function ch(t,i){t&1&&(l(0,"span"),s(1,"the selected range"),o())}function ph(t,i){if(t&1&&(l(0,"span",14),s(1," There is no data for this chart in "),g(2,Q0,2,0,"span")(3,K0,2,0,"span")(4,J0,2,0,"span")(5,eh,2,0,"span")(6,th,2,0,"span")(7,ih,2,0,"span")(8,ah,2,0,"span")(9,nh,2,0,"span")(10,rh,2,0,"span")(11,oh,2,0,"span")(12,lh,2,0,"span")(13,sh,2,0,"span")(14,ch,2,0,"span"),o()),t&2){let e;p(2),x((e=i)==="PT1M"?2:e==="PT5M"?3:e==="PT15M"?4:e==="PT30M"?5:e==="PT1H"?6:e==="PT6H"?7:e==="PT12H"?8:e==="P1D"?9:e==="P2D"?10:e==="P1W"?11:e==="P2W"?12:e==="P1M"?13:14)}}function mh(t,i){if(t&1&&(l(0,"div",13),g(1,ph,15,1,"span",14),S(2,"async"),o()),t&2){let e,a=h(4);p(),x((e=T(2,1,a.range$))?1:-1,e)}}function dh(t,i){if(t&1&&g(0,mh,3,3,"div",13),t&2){let e=h();x(e.samples.length===0?0:-1)}}function uh(t,i){if(t&1&&(g(0,dh,1,1),S(1,"async")),t&2){let e=h(2);x(T(1,1,e.dataSource.loading$)?-1:0)}}function hh(t,i){if(t&1){let e=N();l(0,"div",1),g(1,Z0,32,17,"div",2),S(2,"async"),o(),l(3,"div",3)(4,"app-parameter-plot",4,0),E("onVisibleRange",function(n){k(e);let r=h();return A(r.onVisibleRange(n))})("onManualRangeChange",function(){k(e);let n=h();return A(n.onManualRangeChange())}),b(6,"app-parameter-series",5),o(),l(7,"div",6)(8,"div",7)(9,"button",8),E("click",function(){k(e);let n=le(5);return A(n.zoomIn())}),l(10,"mat-icon"),s(11,"add"),o()(),b(12,"span",9),l(13,"button",8),E("click",function(){k(e);let n=le(5);return A(n.zoomOut())}),l(14,"mat-icon"),s(15,"remove"),o()()()(),g(16,uh,2,3),S(17,"async"),o()}if(t&2){let e,a,n=h();p(),x((e=T(2,9,n.range$))?1:-1,e),p(3),C("xGrid",!0)("xAxisHeight",24)("dataSource",n.dataSource)("stop",n.missionTime)("removableSeries",!0),p(2),C("parameter",i.qualifiedName)("grid",!0),p(10),x((a=T(17,11,n.dataSource.data$))?16:-1,a)}}var Ar=class t{constructor(i,e,a,n,r,c){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.synchronizer=r;this.configService=c;this.qualifiedName=Rt.required({alias:"parameter"});this.range$=new $("PT15M");this.customStart$=new $(null);this.customStop$=new $(null)}ngOnInit(){this.missionTime=this.yamcs.getMissionTime(),this.initializeOptions();let i=this.qualifiedName();this.dataSource=new Ji(this.yamcs,this.synchronizer,this.configService),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i),this.parameter$.then(e=>{if(e.qualifiedName=i,this.dataSource.addParameter(e),this.range$.value==="CUSTOM"){let n=this.customStart$.value,r=this.customStop$.value;this.dataSource.updateWindow(n,r,[null,null])}else{let n=this.yamcs.getMissionTime(),r=B.subtractDuration(n,this.range$.value);this.dataSource.updateWindow(r,n,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{if(this.range$.value!=="CUSTOM"){let n=this.yamcs.getMissionTime(),r=B.subtractDuration(n,this.range$.value);this.plot?.updateWindowOnly(r,n)}}),this.backfillSubscription=this.yamcs.yamcsClient.createBackfillingSubscription({instance:this.yamcs.instance},n=>{n.finished&&this.dataSource.reloadVisibleRange()})})}initializeOptions(){let i=this.route.snapshot.queryParamMap;i.has("interval")&&(this.range$.next(i.get("interval")),i.get("interval")==="CUSTOM"&&(this.customStart$.next(new Date(i.get("customStart"))),this.customStop$.next(new Date(i.get("customStop"))))),this.updateURL()}onVisibleRange(i){this.customStart$.next(i[0]),this.customStop$.next(i[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(i){this.range$.next(i);let e=this.yamcs.getMissionTime(),a=B.subtractDuration(e,i);this.updateURL(),this.dataSource.updateWindow(a,e,[null,null])}chooseRange(){let i=this.plot.getDateRange();i&&this.dialog.open(kr,{width:"400px",data:{start:i[0],stop:i[1]}}).afterClosed().subscribe(a=>{a&&(this.range$.next("CUSTOM"),this.customStart$.next(a.start),this.customStop$.next(a.stop),this.updateURL(),this.dataSource.updateWindow(a.start,a.stop,[null,null]))})}compareParameter(){this.dialog.open(Er,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(e=>{e&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e.qualifiedName).then(a=>{let n=new Mi;n.parameter=e.qualifiedName,n.color=e.color,n.strokeWidth=e.thickness,a.qualifiedName=e.qualifiedName,this.plot.addParameter(a,n)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:this.range$.value==="CUSTOM"?this.customStart$.value:null,customStop:this.range$.value==="CUSTOM"?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.backfillSubscription?.cancel(),this.timeSubscription?.unsubscribe(),this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(w(Re),w(Te),w(X),w(Fe),w(yt),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&_e(Fa,5),e&2){let n;he(n=fe())&&(a.plot=n.first)}},inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[F],decls:2,vars:3,consts:[["plot",""],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],[1,"plot-top-actions"],[1,"plot-container"],["duration","",3,"onVisibleRange","onManualRangeChange","xGrid","xAxisHeight","dataSource","stop","removableSeries"],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"click","active"],[3,"click","active"],[1,"no-data-message"],[1,"mat-caption",2,"color","#777"]],template:function(e,a){if(e&1&&(g(0,hh,18,13),S(1,"async")),e&2){let n;x((n=T(1,1,a.parameter$))?0:-1,n)}},dependencies:[Fa,Mi,Y,ee,Go,wt,Qt,Le],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0})}};var Mr=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.downloadURL$=new $(null);this.form=new rt({start:new te(null),stop:new te(null),delimiter:new te(null,Ee.required),interval:new Ka(null)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:a.start?B.toISOString(a.start):"",stop:a.stop?B.toISOString(a.stop):"",delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(i.start=B.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=B.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(X),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!0,features:[F],decls:33,vars:6,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"hint"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Export parameter data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),s(5," Start "),l(6,"span",3),s(7,"(optional)"),o(),b(8,"ya-date-time-input",4),o(),b(9,"br"),l(10,"label"),s(11," Stop "),l(12,"span",3),s(13,"(optional)"),o(),b(14,"ya-date-time-input",5),o(),b(15,"br"),l(16,"label"),s(17," CSV column delimiter "),b(18,"br")(19,"ya-select",6),o(),b(20,"br"),l(21,"label"),s(22," Interval (ms) "),l(23,"span",3),s(24,"(optional)"),o(),b(25,"br")(26,"input",7),o()()(),l(27,"mat-dialog-actions",8)(28,"ya-button",9),s(29,"CANCEL"),o(),l(30,"ya-download-button",10),S(31,"async"),E("click",function(){return a.closeDialog()}),s(32," DOWNLOAD "),o()()),e&2&&(p(3),C("formGroup",a.form),p(16),C("options",a.delimiterOptions),p(11),C("link",T(31,4,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[Y,ee,De,Ze,de,be,Se,Pe,Be,ht,He,$e,ge,vt,mn,Dt],encapsulation:2,changeDetection:0})}};function fh(t,i){t&1&&(l(0,"th",15),s(1,"Severity"),o())}function _h(t,i){if(t&1&&b(0,"app-alarm-level",17),t&2){let e=h().$implicit;C("level",e.monitoringResult)}}function gh(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function vh(t,i){if(t&1&&(l(0,"td",16),g(1,_h,1,1,"app-alarm-level",17)(2,gh,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.monitoringResult?1:-1),p(),x(e.monitoringResult?-1:2)}}function yh(t,i){t&1&&(l(0,"th",15),s(1,"Generation time"),o())}function Ch(t,i){if(t&1&&(l(0,"td",16),s(1),S(2,"datetime"),o()),t&2){let e,a=i.$implicit;p(),q((e=T(2,1,a.generationTime))!==null&&e!==void 0?e:"-")}}function xh(t,i){t&1&&(l(0,"th",15),s(1,"Reception time"),o())}function bh(t,i){if(t&1&&(l(0,"td",16),s(1),S(2,"datetime"),o()),t&2){let e,a=i.$implicit;p(),q((e=T(2,1,a.acquisitionTime))!==null&&e!==void 0?e:"-")}}function Sh(t,i){t&1&&(l(0,"th",15),s(1,"Raw"),o())}function wh(t,i){if(t&1&&(l(0,"td",18),b(1,"ya-value",19),o()),t&2){let e=i.$implicit;p(),C("value",e.rawValue)}}function Th(t,i){t&1&&(l(0,"th",15),s(1,"Eng"),o())}function Dh(t,i){if(t&1&&(l(0,"td",18),b(1,"ya-value",19),o()),t&2){let e=i.$implicit;p(),C("value",e.engValue)}}function Ph(t,i){t&1&&(l(0,"th",15),s(1,"Range condition"),o())}function Eh(t,i){if(t&1&&(l(0,"td",16),s(1),o()),t&2){let e=i.$implicit;p(),q(e.rangeCondition||"-")}}function kh(t,i){t&1&&(l(0,"th",15),s(1,"Acquisition status"),o())}function Ah(t,i){if(t&1&&(l(0,"td",16),s(1),o()),t&2){let e=i.$implicit;p(),q(e.acquisitionStatus||"-")}}function Mh(t,i){t&1&&b(0,"th",20)}function Rh(t,i){t&1&&b(0,"td",16)}function Ih(t,i){t&1&&b(0,"tr",21)}function Lh(t,i){if(t&1){let e=N();l(0,"tr",22),S(1,"async"),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.selectedValue.emit(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);me("selected",T(1,2,a.selectedValue)===e)}}function Oh(t,i){if(t&1&&(l(0,"table",0),G(1,1),g(2,fh,2,0,"th",2)(3,vh,3,2,"td",3),U(),G(4,4),g(5,yh,2,0,"th",2)(6,Ch,3,3,"td",3),U(),G(7,5),g(8,xh,2,0,"th",2)(9,bh,3,3,"td",3),U(),G(10,6),g(11,Sh,2,0,"th",2)(12,wh,2,1,"td",7),U(),G(13,8),g(14,Th,2,0,"th",2)(15,Dh,2,1,"td",7),U(),G(16,9),g(17,Ph,2,0,"th",2)(18,Eh,2,1,"td",3),U(),G(19,10),g(20,kh,2,0,"th",2)(21,Ah,2,1,"td",3),U(),G(22,11),g(23,Mh,1,0,"th",12)(24,Rh,1,0,"td",3),U(),g(25,Ih,1,0,"tr",13)(26,Lh,2,4,"tr",14),o()),t&2){let e=h();C("dataSource",e.dataSource),p(25),C("matHeaderRowDef",e.displayedColumns),p(),C("matRowDefColumns",e.displayedColumns)}}var Rr=class t{constructor(){this.selectedValue=new at;this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},outputs:{selectedValue:"selectedValue"},standalone:!0,features:[F],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){e&1&&g(0,Oh,27,3,"table",0),e&2&&x(a.dataSource?0:-1)},dependencies:[ei,Y,ee,Ye,_t,gt,ot,ft,Tt,Ge,Ue,ze,We,Xi,Le],encapsulation:2,changeDetection:0})}};var Ir=class extends zt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.pvals$=new $([]);this.loading$=new $(!1)}connect(e){return this.pvals$}isEmpty(){return this.pvals$.value.length===0}loadParameterValues(e){return this.loading$.next(!0),this.loadPage(bt(tt({},e),{limit:this.pageSize+1})).then(a=>{this.pvals$.next(a)}).finally(()=>this.loading$.next(!1))}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}async loadMoreData(e){if(this.offscreenRecord)return this.loadPage(bt(tt({},e),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(a=>{let n=this.pvals$.getValue().concat(a);this.pvals$.next(n)})}disconnect(){this.pvals$.complete(),this.loading$.complete()}};var Lr=t=>({value:t});function Vh(t,i){if(t&1&&b(0,"app-alarm-level",15),t&2){let e=h();C("level",e.monitoringResult)}}function Nh(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Fh(t,i){t&1&&va(0)}function Bh(t,i){t&1&&va(0)}function $h(t,i){t&1&&va(0)}function Hh(t,i){t&1&&va(0)}function Yh(t,i){if(t&1&&(l(0,"ya-detail-toolbar"),s(1,"Value Detail"),o(),l(2,"div",12)(3,"div",13),s(4,"Severity"),o(),l(5,"div",14),g(6,Vh,1,1,"app-alarm-level",15)(7,Nh,2,0,"span"),o(),l(8,"div",13),s(9,"Generation time"),o(),l(10,"div",14),s(11),S(12,"datetime"),o(),l(13,"div",13),s(14,"Valid for"),o(),l(15,"div",14),s(16),S(17,"millisDuration"),o(),l(18,"div",13),s(19," Raw value "),g(20,Fh,1,0,"ng-container",16),o(),l(21,"div",14),g(22,Bh,1,0,"ng-container",16),o(),l(23,"div",13),s(24," Engineering value "),g(25,$h,1,0,"ng-container",16),o(),l(26,"div",14),g(27,Hh,1,0,"ng-container",16),o(),l(28,"div",13),s(29,"Range condition"),o(),l(30,"div",14),s(31),o(),l(32,"div",13),s(33,"Acquisition status"),o(),l(34,"div",14),s(35),o()()),t&2){let e=i;h();let a=le(28),n=le(30);p(6),x(e.monitoringResult?6:-1),p(),x(e.monitoringResult?-1:7),p(4),L(" ",T(12,14,e.generationTime)," "),p(5),L(" ",T(17,16,e.expireMillis)||"-"," "),p(4),C("ngTemplateOutlet",a)("ngTemplateOutletContext",Z(18,Lr,e.rawValue)),p(2),C("ngTemplateOutlet",n)("ngTemplateOutletContext",Z(20,Lr,e.rawValue)),p(3),C("ngTemplateOutlet",a)("ngTemplateOutletContext",Z(22,Lr,e.engValue)),p(2),C("ngTemplateOutlet",n)("ngTemplateOutletContext",Z(24,Lr,e.engValue)),p(4),L(" ",e.rangeCondition||"-"," "),p(4),L(" ",e.acquisitionStatus||"-"," ")}}function Gh(t,i){t&1&&(l(0,"ya-detail-toolbar"),s(1,"Select a value"),o())}function Uh(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",17)(1,"ya-date-time-input",18),l(2,"ya-button",19),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h();p(2),C("disabled",e.filterForm.invalid)}}function zh(t,i){if(t&1){let e=N();l(0,"ya-button",20),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function Wh(t,i){t&1&&b(0,"ya-dots")}function jh(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last hour"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),q(T(7,1,e.validStop))}}function qh(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 6 hours"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),q(T(7,1,e.validStop))}}function Xh(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 24 hours"),o(),s(4," ending at "),l(5,"b"),s(6),S(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),q(T(7,1,e.validStop))}}function Zh(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function Qh(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),S(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),S(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h();p(3),q(T(4,2,e.validStart)),p(4),q(T(8,4,e.validStop))}}function Kh(t,i){t&1&&(l(0,"ya-empty-message"),s(1," No records found matching current filter in the selected time range. "),o())}function Jh(t,i){if(t&1){let e=N();l(0,"mat-toolbar"),b(1,"span",8),l(2,"ya-button",19),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),s(3,"Load more"),o(),b(4,"span",8),o()}if(t&2){let e=h();p(2),C("disabled",!e.dataSource.hasMore())}}function ef(t,i){if(t&1){let e=N();l(0,"ya-more",21)(1,"button",22),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyHex(n.binaryValue))}),s(2,"Copy Hex"),o(),l(3,"button",22),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyBinary(n.binaryValue))}),s(4,"Copy Binary"),o()()}}function tf(t,i){if(t&1&&g(0,ef,5,0,"ya-more",21),t&2){let e,a=i.value;x((e=a==null?null:a.type)==="BINARY"?0:-1)}}function af(t,i){if(t&1&&b(0,"app-hex",23),t&2){let e=h().value;C("base64String",e.binaryValue)}}function nf(t,i){if(t&1&&b(0,"ya-value",24),t&2){let e=h().value;C("value",e)}}function rf(t,i){if(t&1&&g(0,af,1,1,"app-hex",23)(1,nf,1,1,"ya-value",24),t&2){let e,a=i.value;x((e=a==null?null:a.type)==="BINARY"?0:1)}}var ga="PT1H",Or=class t{constructor(i,e,a,n,r,c,d){this.route=i;this.router=e;this.yamcs=a;this.dialog=n;this.clipboard=r;this.messageService=c;this.configService=d;this.qualifiedName=Rt.required({alias:"parameter"});this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new rt({interval:new te(ga),customStart:new te(null),customStop:new te(null)});this.downloadURL$=new $(null)}ngOnInit(){let i=this.qualifiedName();this.dataSource=new Ir(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,ga),this.appliedInterval=ga,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(a)),this.filterForm.get("customStop").setValue(B.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=ga,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,ga)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(ga):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filterForm.value.customStart),this.validStop=B.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(i).catch(e=>this.messageService.showError(e))}loadMoreData(){let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.dataSource.loadMoreData(i).catch(e=>this.messageService.showError(e))}copyHex(i){let e=B.convertBase64ToHex(i);this.clipboard.copy(e)}copyBinary(i){let e=window.atob(i);this.clipboard.copy(e)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(Mr,{width:"400px",data:{parameter:this.qualifiedName(),start:this.validStart,stop:this.validStop}})}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(w(Te),w(Re),w(X),w(Fe),w(Ui),w(Ke),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[F],decls:31,vars:16,consts:[["table",""],["valueActionsTemplate",""],["valueTemplate",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[2,"flex","1 1 auto"],["appearance","primary","icon","download",1,"no-margin",3,"click"],[1,"table-status"],[3,"dataSource"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"level"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[3,"base64String"],[3,"value"]],template:function(e,a){if(e&1){let n=N();l(0,"ya-detail-pane"),g(1,Yh,36,26),S(2,"async"),g(3,Gh,2,0,"ya-detail-toolbar"),o(),l(4,"div",3)(5,"div",4)(6,"form",5)(7,"div",6),b(8,"ya-select",7),g(9,Uh,4,1)(10,zh,2,0,"ya-button")(11,Wh,1,0,"ya-dots"),S(12,"async"),b(13,"div",8),l(14,"ya-button",9),E("click",function(){return k(n),A(a.exportParameterData())}),s(15," Export CSV "),o()()(),l(16,"div",10),g(17,jh,9,3,"span")(18,qh,9,3,"span")(19,Xh,9,3,"span")(20,Zh,4,0,"span")(21,Qh,10,6,"span"),o(),b(22,"app-parameter-values-table",11,0),g(24,Kh,2,0,"ya-empty-message")(25,Jh,5,1,"mat-toolbar"),S(26,"async"),o()(),g(27,tf,1,1,"ng-template",null,1,gi)(29,rf,2,1,"ng-template",null,2,gi)}if(e&2){let n,r,c=le(23);p(),x((n=T(2,10,c.selectedValue))?1:3,n),p(5),C("formGroup",a.filterForm),p(2),C("options",a.intervalOptions),p(),x(a.filterForm.value.interval==="CUSTOM"?9:-1),p(),x(a.filterForm.value.interval!=="CUSTOM"?10:-1),p(),x(T(12,12,a.dataSource.loading$)?11:-1),p(6),x((r=a.appliedInterval)==="PT1H"?17:r==="PT6H"?18:r==="P1D"?19:r==="NO_LIMIT"?20:r==="CUSTOM"?21:-1),p(5),C("dataSource",a.dataSource),p(2),x(a.dataSource.isEmpty()?24:-1),p(),x(!T(26,14,a.dataSource.loading$)&&!a.dataSource.isEmpty()?25:-1)}},dependencies:[ei,Qi,Rr,Y,Fo,ee,De,de,be,Se,Pe,ut,Gi,ge,vt,ji,qi,qt,Xt,Vt,Dt,Xi,Le,rl],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}"],changeDetection:0})}};var of=["container"],Bt="http://www.w3.org/2000/svg",Vr=class t{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){let i=this.container.nativeElement,e=document.createElementNS(Bt,"rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100"),e.setAttribute("height","50"),e.setAttribute("shape-rendering","crispEdges"),e.style.fill="#00ff00",i.appendChild(e),this.watchLowRange=document.createElementNS(Bt,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",i.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(Bt,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",i.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(Bt,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",i.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(Bt,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",i.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(Bt,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",i.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(Bt,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",i.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(Bt,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",i.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(Bt,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",i.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(Bt,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",i.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(Bt,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",i.appendChild(this.severeHighRange),this.indicator=document.createElementNS(Bt,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",i.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let i,e,a=new Map;if(this.pval.alarmRange)for(let n of this.pval.alarmRange)a.set(n.level,n),n.minInclusive!==void 0&&(i===void 0||n.minInclusive<i)&&(i=n.minInclusive),n.minExclusive!==void 0&&(i===void 0||n.minExclusive<i)&&(i=n.minExclusive),n.maxInclusive!==void 0&&(e===void 0||n.maxInclusive>e)&&(e=n.maxInclusive),n.maxExclusive!==void 0&&(e===void 0||n.maxExclusive>e)&&(e=n.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",i!==void 0&&e!==void 0&&i!==e){let n=i-(e-i)/5,r=e+(e-i)/5,c=100/(r-n),d=a.get("WATCH");if(d){if(d.minInclusive){let _=(d.minInclusive-n)*c;this.watchLowRange.setAttribute("width",String(_))}else if(d.minExclusive){let _=(d.minExclusive-n)*c;this.watchLowRange.setAttribute("width",String(_))}if(d.maxInclusive){let _=(d.maxInclusive-n)*c;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}else if(d.maxExclusive){let _=(d.maxExclusive-n)*c;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}}let m=a.get("WARNING");if(m){if(m.minInclusive){let _=(m.minInclusive-n)*c;this.warningLowRange.setAttribute("width",String(_))}else if(m.minExclusive){let _=(m.minExclusive-n)*c;this.warningLowRange.setAttribute("width",String(_))}if(m.maxInclusive){let _=(m.maxInclusive-n)*c;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}else if(m.maxExclusive){let _=(m.maxExclusive-n)*c;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}}let u=a.get("DISTRESS");if(u){if(u.minInclusive){let _=(u.minInclusive-n)*c;this.distressLowRange.setAttribute("width",String(_))}else if(u.minExclusive){let _=(u.minExclusive-n)*c;this.distressLowRange.setAttribute("width",String(_))}if(u.maxInclusive){let _=(u.maxInclusive-n)*c;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}else if(u.maxExclusive){let _=(u.maxExclusive-n)*c;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}}let v=a.get("CRITICAL");if(v){if(v.minInclusive){let _=(v.minInclusive-n)*c;this.criticalLowRange.setAttribute("width",String(_))}else if(v.minExclusive){let _=(v.minExclusive-n)*c;this.criticalLowRange.setAttribute("width",String(_))}if(v.maxInclusive){let _=(v.maxInclusive-n)*c;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}else if(v.maxExclusive){let _=(v.maxExclusive-n)*c;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}}let f=a.get("SEVERE");if(f){if(f.minInclusive){let _=(f.minInclusive-n)*c;this.severeLowRange.setAttribute("width",String(_))}else if(f.minExclusive){let _=(f.minExclusive-n)*c;this.severeLowRange.setAttribute("width",String(_))}if(f.maxInclusive){let _=(f.maxInclusive-n)*c;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}else if(f.maxExclusive){let _=(f.maxExclusive-n)*c;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}}let y=this.getNumericValue(this.pval);if(y!==void 0){let D=(Math.min(Math.max(y,n),r)-n)*c;this.indicator.setAttribute("points",`${D},25 ${D-3.5},100 ${D+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(i){let e=i.engValue;switch(e.type){case"FLOAT":return e.floatValue;case"DOUBLE":return e.doubleValue;case"UINT32":return e.uint32Value;case"SINT32":return e.sint32Value;case"UINT64":return e.uint64Value;case"SINT64":return e.sint64Value}}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-severity-meter"]],viewQuery:function(e,a){if(e&1&&_e(of,7),e&2){let n;he(n=fe())&&(a.container=n.first)}},inputs:{pval:"pval"},standalone:!0,features:[Mt,F],decls:2,vars:0,consts:[["container",""],["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"]],template:function(e,a){e&1&&(Wa(),b(0,"svg",1,0))},encapsulation:2,changeDetection:0})}};var ql=(t,i)=>({c:t,system:i}),Fr=t=>({c:t}),lf=()=>[],sf=t=>["/mdb/parameters/",t];function cf(t,i){if(t&1&&(l(0,"a",5),s(1),o()),t&2){let e=i,a=h(2);C("queryParams",_i(2,ql,a.yamcs.context,e)),p(),L(" ",e," ")}}function pf(t,i){if(t&1&&(l(0,"dt"),s(1),o(),l(2,"dd"),s(3),o()),t&2){let e=i.$implicit;p(),q(e.namespace),p(2),q(e.name)}}function mf(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function df(t,i){t&1&&s(0," - ")}function uf(t,i){if(t&1&&(l(0,"dt"),s(1,"Signed"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),q(e.signed)}}function hf(t,i){if(t&1&&(l(0,"dt"),s(1,"Size in bits"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),q(e.sizeInBits)}}function ff(t,i){if(t&1&&g(0,uf,4,1)(1,hf,4,1),t&2){let e=i;x(e.signed!==void 0?0:-1),p(),x(e.sizeInBits!==void 0?1:-1)}}function _f(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),b(3,"app-markdown",6),o()),t&2){let e=h();p(3),C("text",e.longDescription)}}function gf(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),L(" ",e.shortDescription||"-"," ")}}function vf(t,i){if(t&1&&g(0,_f,4,1)(1,gf,4,1),t&2){let e=i;x(e.longDescription?0:-1),p(),x(e.longDescription?-1:1)}}function yf(t,i){t&1&&s(0," - ")}function Cf(t,i){if(t&1&&(l(0,"dl",0)(1,"dt"),s(2,"Entry"),o(),l(3,"dd"),s(4),S(5,"shortName"),o(),l(6,"dt"),s(7,"System"),o(),l(8,"dd"),g(9,cf,2,5,"a",5),S(10,"spaceSystemName"),o(),re(11,pf,4,2,null,null,ne),S(13,"async"),l(14,"dt"),s(15,"Type"),o(),l(16,"dd"),g(17,mf,2,1,"span",2),S(18,"async"),g(19,df,1,0),o(),g(20,ff,2,2),S(21,"async"),l(22,"dt"),s(23,"Source"),o(),l(24,"dd"),s(25),S(26,"titlecase"),o(),g(27,vf,2,2),S(28,"async"),g(29,yf,1,0),o()),t&2){let e,a,n,r,c,d=h();p(4),Ht("",T(5,7,d.parameter.qualifiedName),"",d.offset,""),p(5),x((e=T(10,9,d.parameter.qualifiedName))?9:-1,e),p(2),oe((a=T(13,11,d.entry$))==null?null:a.alias),p(6),x((n=(n=T(18,13,d.ptype$))==null?null:n.engType)?17:19,n),p(3),x((r=T(21,15,d.ptype$))?20:-1,r),p(5),q(T(26,17,d.parameter.dataSource)||"-"),p(2),x((c=T(28,19,d.entry$))?27:29,c)}}function xf(t,i){if(t&1&&(l(0,"dt"),s(1,"Host Parameter"),o(),l(2,"dd")(3,"a",7),s(4),S(5,"shortName"),o()()),t&2){let e=h();p(3),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Z(5,Fr,e.yamcs.context)),p(),L(" ",T(5,3,e.parameter.qualifiedName)," ")}}function bf(t,i){if(t&1&&(l(0,"dt"),s(1,"Parameter"),o(),l(2,"dd"),s(3),S(4,"shortName"),o()),t&2){let e=h();p(3),q(T(4,1,e.parameter.qualifiedName))}}function Sf(t,i){if(t&1&&(l(0,"a",5),s(1),o()),t&2){let e=i,a=h(2);C("queryParams",_i(2,ql,a.yamcs.context,e)),p(),L(" ",e," ")}}function wf(t,i){if(t&1&&(l(0,"dt"),s(1,"System"),o(),l(2,"dd"),g(3,Sf,2,5,"a",5),S(4,"spaceSystemName"),o()),t&2){let e,a=h();p(3),x((e=T(4,1,a.parameter.qualifiedName))?3:-1,e)}}function Tf(t,i){if(t&1&&(l(0,"dt"),s(1),o(),l(2,"dd"),s(3),o()),t&2){let e=i.$implicit;p(),q(e.namespace),p(2),q(e.name)}}function Df(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function Pf(t,i){t&1&&s(0," - ")}function Ef(t,i){if(t&1&&(l(0,"dt"),s(1,"Signed"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),q(e.parameter.type==null?null:e.parameter.type.signed)}}function kf(t,i){if(t&1&&(l(0,"dt"),s(1,"Source"),o(),l(2,"dd"),s(3),S(4,"titlecase"),o()),t&2){let e=h();p(3),q(T(4,1,e.parameter.dataSource)||"-")}}function Af(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),b(3,"app-markdown",6),o()),t&2){let e=h();p(3),C("text",e.parameter.longDescription)}}function Mf(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),L(" ",e.parameter.shortDescription||"-"," ")}}function Rf(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function If(t,i){t&1&&s(0," - ")}function Lf(t,i){t&1&&(s(0),S(1,"units")),t&2&&L(" ",T(1,1,i)," ")}function Of(t,i){if(t&1&&(l(0,"td")(1,"a",9),s(2),o()(),l(3,"td"),g(4,Rf,2,1,"span",2),S(5,"entryForOffset"),g(6,If,1,0),o(),l(7,"td"),s(8),S(9,"entryForOffset"),o(),l(10,"td")(11,"ya-expirable",10),s(12),S(13,"value"),g(14,Lf,2,3),S(15,"entryForOffset"),o()()),t&2){let e,a,n,r=i,c=h(),d=c.$implicit,m=c.$index,u=h(2),v=h();p(),C("routerLink","/telemetry/parameters"+v.parameter.qualifiedName+r)("queryParams",Z(19,Fr,v.yamcs.context)),p(),L(" ",d," "),p(2),x((e=(e=it(5,8,v.parameter,r))==null||e.type==null?null:e.type.engType)?4:6,e),p(4),q(((a=it(9,11,v.parameter,r))==null?null:a.shortDescription)||"-"),p(3),C("pval",v.pval),p(),L(" ",T(13,14,u.aggregateValue.value[m])," "),p(2),x((n=(n=it(15,16,v.parameter,r))==null||n.type==null?null:n.type.unitSet)?14:-1,n)}}function Vf(t,i){if(t&1&&(l(0,"tr"),g(1,Of,16,21),o()),t&2){let e,a=i.$implicit,n=h(3);p(),x((e=(n.offset||"")+"."+a)?1:-1,e)}}function Nf(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),s(3,"Member"),o(),l(4,"th"),s(5,"Type"),o(),l(6,"th"),s(7,"Description"),o(),l(8,"th"),s(9,"Value"),o()(),re(10,Vf,2,1,"tr",null,ne),o()),t&2){let e=h();p(10),oe(e.aggregateValue.name)}}function Ff(t,i){if(t&1&&(l(0,"tr")(1,"td")(2,"a",9),s(3),o()(),l(4,"td"),s(5),S(6,"value"),o()()),t&2){let e=i.$implicit,a=i.$index,n=h(3);p(2),C("routerLink","/telemetry/parameters"+n.parameter.qualifiedName+(n.offset||"")+"["+a+"]")("queryParams",Z(6,Fr,n.yamcs.context)),p(),L(" ",a," "),p(2),q(T(6,4,e))}}function Bf(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),s(3,"Index"),o(),l(4,"th"),s(5,"Value"),o()(),re(6,Ff,7,8,"tr",null,ne),o()),t&2){let e=h();p(6),oe(e.arrayValue||Li(0,lf))}}function $f(t,i){if(t&1&&(b(0,"app-alarm-level",15),s(1," \xA0 ")),t&2){let e=h(3);C("level",e.pval==null?null:e.pval.monitoringResult)}}function Hf(t,i){t&1&&(s(0),S(1,"units")),t&2&&L(" ",T(1,1,i)," ")}function Yf(t,i){if(t&1&&b(0,"app-severity-meter",10),t&2){let e=h(3);C("pval",e.pval)}}function Gf(t,i){if(t&1&&(l(0,"span",11)(1,"ya-expirable",12),g(2,$f,2,1),s(3),S(4,"value"),g(5,Hf,2,3),S(6,"parameterTypeForPath"),o()(),b(7,"br"),l(8,"div",13),g(9,Yf,1,1,"app-severity-meter",10),o(),l(10,"dl",14)(11,"dt"),s(12,"Generation time"),o(),l(13,"dd"),s(14),S(15,"datetime"),o(),l(16,"dt"),s(17,"Raw value"),o(),l(18,"dd"),s(19),S(20,"value"),o()()),t&2){let e,a,n=h(),r=h();p(),C("pval",r.pval),p(),x(r.pval!=null&&r.pval.monitoringResult?2:-1),p(),L(" ",T(4,7,n)," "),p(2),x((e=(e=T(6,9,r.parameter))==null?null:e.unitSet)?5:-1,e),p(4),x(r.pval!=null&&r.pval.monitoringResult?9:-1),p(5),q(T(15,11,r.pval==null?null:r.pval.generationTime)),p(5),q((a=T(20,13,r.pval==null?null:r.pval.rawValue))!==null&&a!==void 0?a:"-")}}function Uf(t,i){if(t&1&&g(0,Nf,12,0,"table",8)(1,Bf,8,1,"table",8)(2,Gf,21,15),t&2){let e;x((e=i.type)==="AGGREGATE"?0:e==="ARRAY"?1:2)}}function zf(t,i){t&1&&(l(0,"span",4),s(1,"---"),o())}function Wf(t,i){t&1&&s(0," , ")}function jf(t,i){if(t&1&&(g(0,Wf,1,0),l(1,"a",19),s(2),o(),s(3),S(4,"operator")),t&2){let e=i.$implicit,a=i.$index,n=h(4);x(a!==0?0:-1),p(),C("routerLink",Z(8,sf,e.parameter.qualifiedName))("queryParams",Z(10,Fr,n.yamcs.context)),p(),L(" ",e.parameter.name," "),p(),Ht(" ",T(4,6,e.operator)," ",e.value," ")}}function qf(t,i){if(t&1&&(l(0,"th"),re(1,jf,5,12,null,null,ne),o()),t&2){let e=i.$implicit;p(),oe(e.comparison)}}function Xf(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function Zf(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Qf(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function Kf(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Jf(t,i){if(t&1&&(l(0,"td"),g(1,Qf,2,3)(2,Kf,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit,r=h(3);p(),x((e=r.getEnumerationAlarmLevel(a,n))?1:2,e)}}function e_(t,i){if(t&1&&(l(0,"tr")(1,"td",4),s(2),o(),l(3,"td",4),s(4),o(),l(5,"td"),s(6),o(),l(7,"td"),g(8,Xf,2,3)(9,Zf,2,0,"span"),o(),re(10,Jf,3,1,"td",null,ne),o()),t&2){let e,a=i.$implicit,n=h(2),r=h();p(2),q(a.value),p(2),q(a.label),p(2),q(a.description||"-"),p(2),x((e=r.getDefaultAlarmLevel(n.type,a))?8:9,e),p(2),oe(n.type.contextAlarm)}}function t_(t,i){if(t&1&&(l(0,"div",3),b(1,"mat-divider"),o(),l(2,"h4"),s(3,"Enumeration"),o(),l(4,"table",8)(5,"tr")(6,"th",16),s(7,"Value"),o(),l(8,"th",17),s(9,"Label"),o(),l(10,"th",18),s(11,"Description"),o(),l(12,"th"),s(13,"Alarm level (default)"),o(),re(14,qf,3,0,"th",null,ne),o(),re(16,e_,12,4,"tr",null,ne),o()),t&2){let e=h();p(14),oe(e.type==null?null:e.type.contextAlarm),p(2),oe(e.type.enumValue)}}function i_(t,i){if(t&1&&g(0,t_,18,0),t&2){let e=i;x((e.type==null?null:e.type.engType)==="enumeration"?0:-1)}}var Nr=class t{constructor(i){this.yamcs=i;this.entry$=new $(null);this.ptype$=new $(null)}ngOnChanges(){if(this.parameter){if(this.offset){let i=B.getEntryForOffset(this.parameter,this.offset);this.entry$.next(i)}else this.entry$.next(this.parameter);this.ptype$.next(B.getParameterTypeForPath(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(i,e){if(i&&i.defaultAlarm){let a=i.defaultAlarm;if(a.enumerationAlarms){for(let n of a.enumerationAlarms)if(n.label===e.label)return n.level}}}getEnumerationAlarmLevel(i,e){let a=i.alarm;for(let n of a.enumerationAlarms)if(n.label===e.label)return n.level}static{this.\u0275fac=function(e){return new(e||t)(w(X))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},standalone:!0,features:[Mt,F],decls:24,vars:16,consts:[[1,"dl-horizontal","no-lead","no-trail"],[1,"dl-horizontal","no-trail"],[1,"mono"],[1,"section-divider"],[2,"white-space","nowrap"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],["yaDataTable",""],[3,"routerLink","queryParams"],[3,"pval"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[1,"meter-size-constrainer"],[1,"dl-horizontal"],[3,"level"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"]],template:function(e,a){if(e&1&&(g(0,Cf,30,21,"dl",0),l(1,"dl",1),g(2,xf,6,7)(3,bf,5,3)(4,wf,5,3),re(5,Tf,4,2,null,null,ne),l(7,"dt"),s(8,"Type"),o(),l(9,"dd"),g(10,Df,2,1,"span",2)(11,Pf,1,0),o(),g(12,Ef,4,1)(13,kf,5,3)(14,Af,4,1)(15,Mf,4,1),o(),l(16,"div",3),b(17,"mat-divider"),o(),l(18,"h4"),s(19,"Current value"),o(),g(20,Uf,3,1)(21,zf,2,0,"span",4)(22,i_,1,1),S(23,"async")),e&2){let n,r,c;x(a.offset?0:-1),p(),me("no-lead",!a.offset),p(),x(a.offset?2:-1),p(),x(a.offset?-1:3),p(),x(a.offset?-1:4),p(),oe(a.parameter.alias),p(5),x((n=a.parameter.type==null?null:a.parameter.type.engType)?10:11,n),p(2),x((a.parameter.type==null?null:a.parameter.type.signed)!==void 0?12:-1),p(),x(a.offset?-1:13),p(),x(a.parameter.longDescription?14:-1),p(),x(a.parameter.longDescription?-1:15),p(5),x((r=a.pval==null?null:a.pval.engValue)?20:-1,r),p(),x(a.pval!=null&&a.pval.engValue?-1:21),p(),x((c=T(23,14,a.entry$))?22:-1,c)}},dependencies:[ei,hl,Vr,Y,ee,Oi,Ie,mi,Wt,Zt,Le,al,ol,Zi,fn,sl,Jt,Nt],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0})}};function a_(t,i){if(t&1&&(b(0,"app-parameter-detail",1),S(1,"async"),S(2,"async")),t&2){let e=h();C("parameter",i)("offset",T(1,3,e.offset$))("pval",T(2,5,e.pval$))}}var Br=class t{constructor(i,e){this.yamcs=i;this.synchronizer=e;this.qualifiedName=Rt.required({alias:"parameter"});this.parameter$=new $(null);this.offset$=new $(null);this.parameterValue$=new $(null);this.dirty=!1;this.pval$=new $(null);this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{this.parameterValue$.next(a.values?a.values[0]:null),this.pval$.value==null?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription?.cancel(),this.syncSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(yt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[Mt,F],decls:3,vars:3,consts:[[1,"panel-content"],[3,"parameter","offset","pval"]],template:function(e,a){if(e&1&&(l(0,"div",0),g(1,a_,3,7,"app-parameter-detail",1),S(2,"async"),o()),e&2){let n;p(),x((n=T(2,1,a.parameter$))?1:-1,n)}},dependencies:[Nr,Y,ee],encapsulation:2,changeDetection:0})}};function n_(t,i){if(t&1&&(l(0,"option",8),s(1),o()),t&2){let e=i.$implicit;C("value",e.label),p(),L(" ",e.label," ")}}function r_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),s(3),o()(),s(4),b(5,"ya-errors",5),l(6,"select",6)(7,"option",7),s(8,"-- select an option --"),o(),re(9,n_,2,2,"option",8,ne),o()()),t&2){let e=h(),a=h();p(3),q(a.parameter.type==null?null:a.parameter.type.engType),p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(),C("formControlName",e),p(3),oe(a.parameter.type==null?null:a.parameter.type.enumValue)}}function o_(t,i){if(t&1&&(l(0,"label"),s(1),b(2,"ya-errors",5)(3,"br")(4,"input",9),s(5," true"),b(6,"br")(7,"input",10),s(8," false "),o()),t&2){let e=h(),a=h();p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(2),C("formControlName",e),p(3),C("formControlName",e)}}function l_(t,i){if(t&1&&(l(0,"label"),s(1),b(2,"ya-errors",5)(3,"ya-date-time-input",6),o()),t&2){let e=h(),a=h();p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(),C("formControlName",e)}}function s_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),S(3,"async"),s(4),o()(),s(5),b(6,"ya-errors",5,0)(8,"ya-binary-input",6),o()),t&2){let e=le(7),a=h(),n=h();p(2),me("error",T(3,6,e.invalid$)),p(2),L(" ",n.parameter.type==null?null:n.parameter.type.engType," "),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function c_(t,i){if(t&1&&b(0,"app-parameter-form",12)(1,"br"),t&2){let e=i.$implicit,a=h(3);C("parameter",e)("formGroup",a.formGroup)("parent",a.parent?a.parent+"."+a.parameter.name:a.parameter.name)}}function p_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),s(3),o()(),s(4),l(5,"div",11),re(6,c_,2,3,null,null,ne),o()()),t&2){let e=h(2);p(3),q(e.parameter.type==null?null:e.parameter.type.engType),p(),L(" ",e.parameter.name," "),p(2),oe(e.parameter.type==null?null:e.parameter.type.member)}}function m_(t,i){if(t&1&&(l(0,"div",4),s(1),S(2,"units"),o()),t&2){let e=h(3);p(),L(" ",T(2,1,e.parameter.type==null?null:e.parameter.type.unitSet)," ")}}function d_(t,i){t&1&&(l(0,"div",4),s(1,"unsigned"),o())}function u_(t,i){if(t&1&&(l(0,"div",2)(1,"div",3),S(2,"async"),g(3,m_,3,3,"div",4)(4,d_,2,0,"div",4),l(5,"div",4),s(6),o()(),s(7),b(8,"ya-errors",5,0)(10,"input",13),o()),t&2){let e=le(9),a=h(),n=h();p(),me("error",T(2,8,e.invalid$)),p(2),x(n.parameter.type!=null&&n.parameter.type.unitSet?3:-1),p(),x((n.parameter.type==null?null:n.parameter.type.signed)===!1?4:-1),p(2),q(n.parameter.type==null?null:n.parameter.type.engType),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function h_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function f_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function __(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function g_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function v_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function y_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function C_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function x_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function b_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function S_(t,i){if(t&1&&(l(0,"div",4),s(1),S(2,"units"),o()),t&2){let e=h(3);p(),L(" ",T(2,1,e.parameter.type==null?null:e.parameter.type.unitSet)," ")}}function w_(t,i){if(t&1&&(l(0,"label")(1,"div",3),S(2,"async"),g(3,S_,3,3,"div",4),l(4,"div",4),s(5),o()(),s(6),b(7,"ya-errors",5,0)(9,"input",13),o()),t&2){let e=le(8),a=h(),n=h();p(),me("error",T(2,7,e.invalid$)),p(2),x(n.parameter.type!=null&&n.parameter.type.unitSet?3:-1),p(2),q(n.parameter.type==null?null:n.parameter.type.engType),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function T_(t,i){if(t&1&&(G(0,1),g(1,r_,11,4,"label")(2,o_,9,4,"label")(3,l_,4,3,"label")(4,s_,9,8,"label")(5,p_,8,2,"label")(6,u_,11,10,"div",2)(7,h_,1,0)(8,f_,1,0)(9,__,1,0)(10,g_,1,0)(11,v_,1,0)(12,y_,1,0)(13,C_,1,0)(14,x_,1,0)(15,b_,1,0)(16,w_,10,9,"label"),U()),t&2){let e,a=h();C("formGroup",a.formGroup),p(),x((e=a.parameter.type==null?null:a.parameter.type.engType)==="enumeration"?1:e==="boolean"?2:e==="time"?3:e==="binary"?4:e==="aggregate"?5:e==="integer"?6:e==="float[]"?7:e==="double[]"?8:e==="integer[]"?9:e==="enumeration[]"?10:e==="string[]"?11:e==="boolean[]"?12:e==="time[]"?13:e==="binary[]"?14:e==="aggregate[]"?15:16)}}var $r=class t{constructor(){this.controlName$=new $(null)}ngOnInit(){this.parent?this.controlName$.next(this.parent+"."+this.parameter.name):this.controlName$.next(this.parameter.name)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},standalone:!0,features:[F],decls:2,vars:3,consts:[["err",""],[3,"formGroup"],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[1,"members"],[3,"parameter","formGroup","parent"],["type","text",3,"formControlName"]],template:function(e,a){if(e&1&&(g(0,T_,17,2,"ng-container",1),S(1,"async")),e&2){let n;x((n=T(1,1,a.controlName$))?0:-1,n)}},dependencies:[t,Y,ee,Ni,Fi,Ze,Vi,Ho,de,be,Se,Pe,Xo,vt,Qo,Jt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0})}};var Hr=class t{constructor(i,e){this.dialogRef=i;this.data=e;this.form=new rt({});this.parameter=e.parameter;let a=this.getValidatorsForType(this.parameter.type);this.parameter.type.engType==="aggregate"?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new te(null,a))}addMemberControls(i,e){for(let a of e)if(a.type.engType==="aggregate")this.addMemberControls(i+a.name+".",a.type.member||[]);else{let n=i+a.name,r=this.getValidatorsForType(a.type);this.form.addControl(n,new te("",r))}}getValidatorsForType(i){let e=[Ee.required];return i.engType==="integer"?(e.push(sn.requireInteger),i.signed===!1&&e.push(sn.requireUnsigned)):i.engType==="float"&&e.push(sn.requireFloat),e}setValue(){let i=this.toValue("",this.parameter);this.dialogRef.close(i)}toValue(i,e){let a=this.form.value[i+e.name];switch(e.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:a==="true"};case"float":return{type:"FLOAT",floatValue:a};case"double":return{type:"DOUBLE",doubleValue:a};case"enumeration":return{type:"STRING",stringValue:a};case"integer":return{type:"SINT32",sint32Value:a};case"string":return{type:"STRING",stringValue:a};case"time":return{type:"TIMESTAMP",stringValue:B.toISOString(a)};case"binary":return{type:"BINARY",binaryValue:B.convertHexToBase64(a)};case"aggregate":let n=[],r=[];for(let c of e.type.member||[])n.push(c.name),r.push(this.toValue(i+e.name+".",c));return{type:"AGGREGATE",aggregateValue:{name:n,value:r}};default:throw new Error(`Unexpected type: ${e.type.engType}`)}}static{this.\u0275fac=function(e){return new(e||t)(w(Ne),w(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-set-parameter-dialog"]],standalone:!0,features:[F],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Set parameter value"),o(),l(2,"mat-dialog-content")(3,"form",1),b(4,"app-parameter-form",2),o()(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),s(7,"CANCEL"),o(),l(8,"ya-button",5),E("click",function(){return a.setValue()}),s(9,"SET"),o()()),e&2&&(p(3),C("formGroup",a.form),p(),C("parameter",a.parameter)("formGroup",a.form),p(4),C("disabled",!a.form.valid))},dependencies:[$r,Y,De,be,Se,Be,ht,He,$e,ge],encapsulation:2})}};var Ba=t=>({c:t}),D_=(t,i)=>({c:t,system:i}),P_=t=>["/mdb/parameters",t];function E_(t,i){if(t&1&&(l(0,"a",15),s(1),o()),t&2){let e=h().$implicit,a=h(2);C("queryParams",_i(2,D_,a.yamcs.context,e.path)),p(),L(" ",e.name," ")}}function k_(t,i){if(t&1&&(g(0,E_,2,5,"a",15),s(1," / ")),t&2){let e=i.$index;x(e!==0?0:-1)}}function A_(t,i){if(t&1){let e=N();l(0,"ya-page-button",16),E("click",function(){k(e);let n=h(2);return A(n.setParameter())}),s(1,"Set value"),o()}}function M_(t,i){if(t&1&&(l(0,"ya-page-button",8),s(1," View in MDB "),o()),t&2){let e=h(),a=h();C("routerLink",Z(2,P_,e.qualifiedName))("queryParams",Z(4,Ba,a.yamcs.context))}}function R_(t,i){if(t&1&&(l(0,"a",11,3),s(2," Chart "),o()),t&2){let e=le(1),a=h(2);C("active",e.isActive)("queryParams",Z(2,Ba,a.yamcs.context))}}function I_(t,i){if(t&1&&(l(0,"a",12,4),s(2," Alarm History "),o()),t&2){let e=le(1),a=h(2);C("active",e.isActive)("queryParams",Z(2,Ba,a.yamcs.context))}}function L_(t,i){if(t&1&&(l(0,"a",13,5),s(2," Historical Data "),o()),t&2){let e=le(1),a=h(2);C("active",e.isActive)("queryParams",Z(2,Ba,a.yamcs.context))}}function O_(t,i){if(t&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),re(2,k_,2,1,null,null,ne),S(4,"parents"),l(5,"span"),s(6),S(7,"shortName"),S(8,"async"),o(),b(9,"ya-title-copy",6),S(10,"async"),s(11," \xA0\xA0\xA0 "),g(12,A_,2,0,"ya-page-button",7),S(13,"async"),g(14,M_,2,6,"ya-page-button",8),o(),l(15,"nav",9,0)(17,"a",10,1),s(19," Summary "),o(),g(20,R_,3,4,"a",11)(21,I_,3,4,"a",12)(22,L_,3,4,"a",13),o(),l(23,"div",14)(24,"mat-tab-nav-panel",null,2),b(26,"router-outlet"),o()()()),t&2){let e=i,a=le(16),n=le(18),r=le(25),c=h();p(2),oe(T(4,14,e.qualifiedName)),p(4),Ht("",T(7,16,e.qualifiedName),"",T(8,18,c.offset$),""),p(3),C("text",e.qualifiedName+(T(10,20,c.offset$)||"")),p(3),x(c.isWritable()&&c.maySetParameter()&&!T(13,22,c.offset$)?12:-1),p(2),x(c.mayReadMissionDatabase()?14:-1),p(),C("mat-stretch-tabs",!1)("tabPanel",r),p(2),C("active",n.isActive)("queryParams",Z(24,Ba,c.yamcs.context)),p(3),x(c.config.tmArchive?20:-1),p(),x(c.mayReadAlarms()?21:-1),p(),x(c.config.tmArchive?22:-1),p(),me("noscroll",a.selectedIndex===1)}}var Yr=class t{constructor(i,e,a,n,r,c,d){this.yamcs=i;this.authService=e;this.messageService=a;this.dialog=n;this.title=r;this.formatter=c;this.qualifiedName=Rt.required({alias:"parameter"});this.parameter$=new $(null);this.offset$=new $(null);this.parameterValue$=new $(null);this.config=d.getConfig()}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.updateTitle()}).catch(e=>{this.messageService.showError(e)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{this.parameterValue$.next(e.values?e.values[0]:null),this.updateTitle()})}updateTitle(){let i=this.parameter$.getValue(),e=this.offset$.getValue();if(i){let a=i.name;e&&(a+=e);let n=this.parameterValue$.getValue();n?.engValue&&(a+=": "+this.formatter.formatValue(n.engValue),i.type&&i.type.unitSet&&(a+=" "+B.getUnits(i.type.unitSet)),n.rangeCondition&&n.rangeCondition==="LOW"?a+=" \u2193":n.rangeCondition&&n.rangeCondition==="HIGH"&&(a+=" \u2191")),this.title.setTitle(a)}}isWritable(){let i=this.parameter$.value;return i?i.dataSource==="LOCAL"||i.dataSource==="EXTERNAL1"||i.dataSource==="EXTERNAL2"||i.dataSource==="EXTERNAL3":!1}maySetParameter(){let i=this.parameter$.value;return i?this.authService.getUser().hasObjectPrivilege("WriteParameter",i.qualifiedName):!1}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){let i=this.parameter$.value;this.dialog.open(Hr,{width:"600px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(a=>{a&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,i.qualifiedName,a).catch(n=>this.messageService.showError(n))})}ngOnDestroy(){this.parameterValueSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(w(X),w(Ct),w(Ke),w(Fe),w(nt),w(Wi),w(Ce))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[Mt,F],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["rlc","routerLinkActive"],["rld","routerLinkActive"],[3,"text"],["icon","edit"],["icon","auto_stories",3,"routerLink","queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","-/summary","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/chart","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/alarms","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],["icon","edit",3,"click"]],template:function(e,a){if(e&1&&(g(0,O_,27,26,"app-instance-page"),S(1,"async")),e&2){let n;x((n=T(1,1,a.parameter$))?0:-1,n)}},dependencies:[et,Je,Y,ee,oi,Ie,Qa,rn,ln,on,lt,Jo,ll,fn],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0})}};var V_=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{packet:new zr(a,{})}}},N_=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{parameter:new zr(a,{})}}},RP=[{path:"",canActivate:[Zr,Xr],canActivateChild:[Qr],runGuardsAndResolvers:"always",component:ml,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:zn,children:[{path:"**",component:Yn}]},{path:"displays/files",component:Un,providers:[Ca],children:[{path:"**",component:Nn,canDeactivate:[gl],data:{showRangeSelector:!0}}]},{path:"packets",children:[{path:"",pathMatch:"full",component:Xn},{matcher:V_,children:[{path:"-/log/:gentime/:seqno",component:Zn}]}]},{path:"parameters",children:[{path:"",pathMatch:"full",component:ir,title:"Parameters"},{matcher:N_,component:Yr,children:[{path:"",pathMatch:"full",redirectTo:"-/summary"},{path:"-/summary",component:Br},{path:"-/chart",component:Ar},{path:"-/data",component:Or},{path:"-/alarms",component:pr}]}]},{path:"parameter-lists",pathMatch:"full",component:er},{path:"parameter-lists/create",pathMatch:"full",component:Qn},{path:"parameter-lists/:list",component:or,children:[{path:"",pathMatch:"full",redirectTo:"realtime"},{path:"realtime",component:nr},{path:"data",component:Jn}]},{path:"parameter-lists/:list/edit",pathMatch:"full",component:Kn},{path:"ext",canActivate:[Zr,Xr],canActivateChild:[Qr],runGuardsAndResolvers:"always",children:[{matcher:pl,component:cl}]}]}];export{RP as ROUTES};
