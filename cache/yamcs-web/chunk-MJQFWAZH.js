import{b as it,d as nt,e as ot,f as lt}from"./chunk-WVE4Y3TR.js";import{Ca as o,E as x,Ea as p,Ia as v,La as E,Le as D,Oa as S,Of as Z,Pa as T,Pf as tt,Qa as $,Rf as et,X as s,Y as d,aa as l,ca as f,cb as N,e as h,ee as y,fe as A,ga as b,ge as j,he as B,ie as O,je as W,ka as i,ke as Y,la as n,le as G,lg as g,ma as r,mb as F,me as Q,na as C,ne as U,oa as u,oe as V,pe as q,qe as L,re as z,rg as R,sa as c,se as J,sg as at,tb as H,te as K,tg as mt,ue as X,ug as st,wa as P,xa as M,ya as I}from"./chunk-SAZ6MTOG.js";var ft=(t,a)=>({c:t,name:a});function _t(t,a){t&1&&(i(0,"th",17),o(1,"Packet"),n())}function Ct(t,a){if(t&1&&(i(0,"a",19),o(1),n()),t&2){let e=c().$implicit,m=c(2);f("queryParams",E(2,ft,m.yamcs.context,e.packetName)),s(),p(" ",e.packetName," ")}}function ut(t,a){if(t&1&&o(0),t&2){let e=c().$implicit;p(" ",e.packetName," ")}}function St(t,a){if(t&1&&(i(0,"td",18),l(1,Ct,2,5,"a",19)(2,ut,1,1),n()),t&2){let e=c(2);s(),b(e.config.tmArchive?1:2)}}function Tt(t,a){t&1&&r(0,"td",20)}function ht(t,a){t&1&&(i(0,"th",21),o(1,"Received"),n())}function bt(t,a){if(t&1&&(i(0,"td",22),o(1),S(2,"deltaWith"),n()),t&2){let e=a.$implicit;s(),p(" ",$(2,1,e.lastReceived,e.lastPacketTime)||"-"," ")}}function xt(t,a){t&1&&r(0,"td",20)}function vt(t,a){t&1&&(i(0,"th",17),o(1,"Packet time"),n())}function yt(t,a){if(t&1&&(i(0,"td",18),o(1),S(2,"datetime"),n()),t&2){let e=a.$implicit;s(),p(" ",T(2,1,e.lastPacketTime)||"-"," ")}}function Dt(t,a){t&1&&r(0,"td",20)}function gt(t,a){t&1&&(i(0,"th",17),o(1,"Packet rate"),n())}function Rt(t,a){if(t&1&&(i(0,"td",22),o(1),n()),t&2){let e=a.$implicit;s(),p(" ",e.packetRate," p/s ")}}function kt(t,a){if(t&1&&(i(0,"td",23),o(1),S(2,"async"),n()),t&2){let e=c(2);s(),p(" ",T(2,1,e.totalPacketRate$)," p/s ")}}function wt(t,a){t&1&&(i(0,"th",17),o(1,"Data rate"),n())}function Pt(t,a){if(t&1&&(i(0,"td",22),o(1),S(2,"dataRate"),n()),t&2){let e=a.$implicit;s(),p(" ",T(2,1,e.dataRate)," ")}}function Mt(t,a){if(t&1&&(i(0,"td",23),o(1),S(2,"async"),S(3,"dataRate"),n()),t&2){let e=c(2);s(),p(" ",T(3,3,T(2,1,e.totalDataRate$))," ")}}function It(t,a){t&1&&r(0,"th",24)}function Et(t,a){t&1&&r(0,"td",18)}function $t(t,a){t&1&&r(0,"td",20)}function Nt(t,a){t&1&&r(0,"tr",25)}function Ft(t,a){t&1&&r(0,"tr",26)}function Ht(t,a){t&1&&r(0,"tr",27)}function At(t,a){if(t&1&&(i(0,"table",0),C(1,1),l(2,_t,2,0,"th",2)(3,St,3,1,"td",3)(4,Tt,1,0,"td",4),u(),C(5,5),l(6,ht,2,0,"th",6)(7,bt,3,4,"td",7)(8,xt,1,0,"td",4),u(),C(9,8),l(10,vt,2,0,"th",2)(11,yt,3,3,"td",3)(12,Dt,1,0,"td",4),u(),C(13,9),l(14,gt,2,0,"th",2)(15,Rt,2,1,"td",7)(16,kt,3,3,"td",10),u(),C(17,11),l(18,wt,2,0,"th",2)(19,Pt,3,3,"td",7)(20,Mt,4,5,"td",10),u(),C(21,12),l(22,It,1,0,"th",13)(23,Et,1,0,"td",3)(24,$t,1,0,"td",4),u(),l(25,Nt,1,0,"tr",14)(26,Ft,1,0,"tr",15)(27,Ht,1,0,"tr",16),n()),t&2){let e=c();f("dataSource",e.dataSource),s(25),f("matHeaderRowDef",e.displayedColumns),s(),f("matRowDefColumns",e.displayedColumns),s(),f("matFooterRowDef",e.displayedColumns)}}var k=class t{constructor(a,e){this.yamcs=a;this.statsByName={};this.dataSource=new X;this.totalPacketRate$=new h(0);this.totalDataRate$=new h(0);this.displayedColumns=["packetName","lastPacketTime","lastReceived","packetRate","dataRate","actions"];this.config=e.getConfig()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.tmstats$&&!this.tmstatsSubscription&&this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(a=>{for(let e of a.packets||[])this.statsByName[e]={packetName:e,packetRate:0,dataRate:0};this.updateData(),this.tmstatsSubscription=this.tmstats$.subscribe(e=>{for(let m of e||[])this.statsByName[m.packetName]=m;this.updateData()})})}updateData(){let a=Object.values(this.statsByName),e=0,m=0;for(let _ of a)e+=Number(_.packetRate),m+=Number(_.dataRate);this.totalPacketRate$.next(e),this.totalDataRate$.next(m),this.dataSource.data=a}ngOnDestroy(){this.tmstatsSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(d(g),d(D))}}static{this.\u0275cmp=x({type:t,selectors:[["app-tmstats-table"]],viewQuery:function(e,m){if(e&1&&P(y,5),e&2){let _;M(_=I())&&(m.sort=_.first)}},inputs:{tmstats$:"tmstats$"},standalone:!0,features:[v],decls:1,vars:1,consts:[["mat-table","","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","lastReceived"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","lastPacketTime"],["matColumnDef","packetRate"],["mat-footer-cell","","style","text-align: right",4,"matFooterCellDef"],["matColumnDef","dataRate"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["routerLink","/telemetry/packets",3,"queryParams"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell","",2,"text-align","right"],["mat-footer-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(e,m){e&1&&l(0,At,28,4,"table",0),e&2&&b(m.dataSource?0:-1)},dependencies:[R,N,H,y,A,j,O,V,Y,B,L,W,q,G,U,Q,z,K,J,Z,tt,et],encapsulation:2,changeDetection:0})}};function jt(t,a){if(t&1&&r(0,"app-tmstats-table",1),t&2){let e=c();f("tmstats$",e.tmstats$)}}var w=class t{constructor(a,e,m,_){this.yamcs=a;this.authService=e;this.tmstats$=new h([]);this.config=_.getConfig(),this.user=e.getUser(),m.setTitle(this.yamcs.instance),this.yamcs.processor&&(this.tmstatsSubscription=a.yamcsClient.createTMStatisticsSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},rt=>this.tmstats$.next(rt.tmstats||[])))}showPackets(){return this.user.hasAnyObjectPrivilegeOfType("ReadPacket")}ngOnDestroy(){this.tmstatsSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(d(g),d(at),d(F),d(D))}}static{this.\u0275cmp=x({type:t,selectors:[["ng-component"]],standalone:!0,features:[v],decls:5,vars:1,consts:[[1,"panel-content"],[3,"tmstats$"]],template:function(e,m){e&1&&(i(0,"app-instance-page")(1,"app-instance-toolbar"),o(2,"Home"),n(),i(3,"div",0),l(4,jt,1,1,"app-tmstats-table",1),n()()),e&2&&(s(4),b(m.showPackets()?4:-1))},dependencies:[nt,it,R,k],encapsulation:2,changeDetection:0})}};var Te=[{path:"",canActivate:[mt,ot],canActivateChild:[st],runGuardsAndResolvers:"always",component:lt,children:[{path:"",pathMatch:"full",component:w}]}];export{Te as ROUTES};
